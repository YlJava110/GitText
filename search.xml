<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title><![CDATA[äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»]]></title>
      <url>/2021/04/27/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B%E4%B9%8BHaar%E7%89%B9%E5%BE%81%E4%BB%8B%E7%BB%8D/</url>
      <content type="html"><![CDATA[<h2 id="Haarç‰¹å¾"><a href="#Haarç‰¹å¾" class="headerlink" title="Haarç‰¹å¾"></a>Haarç‰¹å¾</h2><p>å›¾åƒç‰¹å¾æå–çš„ä¸‰ç§æ–¹å¼ï¼šHOGç‰¹å¾ï¼ŒLBPç‰¹å¾ï¼ŒHaarç‰¹å¾ã€‚Haarç‰¹å¾ï¼šä¹Ÿå«Haar-likeç‰¹å¾ã€å“ˆå°”ç‰¹å¾ï¼Œæ˜¯å›¾åƒç‰¹å¾æå–çš„ä¸€ç§æ–¹æ³•ã€‚<br>Haarç‰¹å¾åˆ†ä¸ºä¸‰ç±»ï¼šè¾¹ç¼˜ç‰¹å¾ã€çº¿æ€§ç‰¹å¾ã€ç‰¹å®šæ–¹å‘ç‰¹å¾ï¼ˆä¸­å¿ƒç‰¹å¾å’Œå¯¹è§’çº¿ç‰¹å¾ï¼‰ï¼Œç»„åˆæˆç‰¹å¾æ¨¡æ¿ã€‚<font color="#FF0000">ç‰¹å¾æ¨¡æ¿å†…æœ‰ç™½è‰²å’Œé»‘è‰²ä¸¤ç§çŸ©å½¢ï¼Œå¹¶å®šä¹‰è¯¥æ¨¡æ¿çš„ç‰¹å¾å€¼ä¸ºç™½è‰²çŸ©å½¢åƒç´ å’Œå‡å»é»‘è‰²çŸ©å½¢åƒç´ å’Œã€‚</font>Haarç‰¹å¾å€¼åæ˜ äº†å›¾åƒçš„ç°åº¦å˜åŒ–æƒ…å†µã€‚ä¾‹å¦‚ï¼šè„¸éƒ¨çš„ä¸€äº›ç‰¹å¾èƒ½ç”±çŸ©å½¢ç‰¹å¾ç®€å•çš„æè¿°ï¼Œå¦‚ï¼šçœ¼ç›è¦æ¯”è„¸é¢Šé¢œè‰²è¦æ·±ï¼Œé¼»æ¢ä¸¤ä¾§æ¯”é¼»æ¢é¢œè‰²è¦æ·±ï¼Œå˜´å·´æ¯”å‘¨å›´é¢œè‰²è¦æ·±ç­‰ã€‚ä½†çŸ©å½¢ç‰¹å¾åªå¯¹ä¸€äº›ç®€å•çš„å›¾å½¢ç»“æ„ï¼Œå¦‚è¾¹ç¼˜ã€çº¿æ®µè¾ƒæ•æ„Ÿï¼Œæ‰€ä»¥åªèƒ½æè¿°ç‰¹å®šèµ°å‘ï¼ˆæ°´å¹³ã€å‚ç›´ã€å¯¹è§’ï¼‰çš„ç»“æ„ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-model.drawio.png" alt="Haarç‰¹å¾" title class>
                <p>Haarç‰¹å¾</p>
            </figure>

<p>å¸¸ç”¨çš„çŸ©å½¢ç‰¹å¾æœ‰ä¸‰ç§ï¼šä¸¤çŸ©å½¢ç‰¹å¾ã€ä¸‰çŸ©å½¢ç‰¹å¾ã€å››çŸ©å½¢ç‰¹å¾ï¼šå¦‚è¾¹ç¼˜ç‰¹å¾æ˜¯ä¸¤çŸ©å½¢ç‰¹å¾ï¼Œçº¿æ€§ç‰¹å¾æ˜¯ä¸‰çŸ©å½¢ç‰¹å¾ï¼Œç‰¹å®šæ–¹å‘ç‰¹å¾æ˜¯å››çŸ©å½¢ç‰¹å¾ã€‚å¦‚æœç‰¹å¾æ¨¡ç‰ˆçš„é»‘ç™½çŸ©å½¢æŒ‰å®½é«˜æ¯”æ¥åˆ†æ®µçš„è¯ï¼Œé‚£å…·ä½“çš„æ¯”ä¾‹å¦‚ä¸‹è¡¨ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-scalemodel.drawio.png" alt="s,tæ¯”ä¾‹" title class>
                <p>s,tæ¯”ä¾‹</p>
            </figure>

<h2 id="Haarç‰¹å¾ä¸ªæ•°è®¡ç®—"><a href="#Haarç‰¹å¾ä¸ªæ•°è®¡ç®—" class="headerlink" title="Haarç‰¹å¾ä¸ªæ•°è®¡ç®—"></a>Haarç‰¹å¾ä¸ªæ•°è®¡ç®—</h2><p>é€šè¿‡æ”¹å˜ç‰¹å¾æ¨¡æ¿çš„å¤§å°å’Œä½ç½®ï¼Œå¯åœ¨å›¾åƒå­çª—å£ä¸­ç©·ä¸¾å‡ºå¤§é‡çš„ç‰¹å¾ã€‚ä¸Šå›¾çš„ç‰¹å¾æ¨¡æ¿ç§°ä¸ºâ€œç‰¹å¾åŸå‹â€ï¼›<font color="#FF0000">ç‰¹å¾åŸå‹åœ¨å›¾åƒå­çª—å£ä¸­æ‰©å±•ï¼ˆå¹³ç§»ä¼¸ç¼©ï¼‰å¾—åˆ°çš„ç‰¹å¾ç§°ä¸ºâ€œçŸ©å½¢ç‰¹å¾â€ï¼›çŸ©å½¢ç‰¹å¾çš„å€¼ç§°ä¸ºâ€œç‰¹å¾å€¼â€ã€‚</font><br>å¯¹äº mÃ—m å­çª—å£ï¼Œæˆ‘ä»¬åªéœ€è¦ç¡®å®šäº†çŸ©å½¢å·¦ä¸Šé¡¶ç‚¹A(x1,y1)å’Œå³ä¸‹é¡¶ç‚¹B(x2,y2) ï¼Œå³å¯ä»¥ç¡®å®šä¸€ä¸ªçŸ©å½¢ï¼›å¦‚æœè¿™ä¸ªçŸ©å½¢è¿˜å¿…é¡»æ»¡è¶³ä¸‹é¢ä¸¤ä¸ªæ¡ä»¶ï¼ˆç§°ä¸º(s, t)æ¡ä»¶ï¼Œæ»¡è¶³(s, t)æ¡ä»¶çš„çŸ©å½¢ç§°ä¸ºæ¡ä»¶çŸ©å½¢ï¼‰ï¼š</p>
<p>1) x æ–¹å‘è¾¹é•¿å¿…é¡»èƒ½è¢«è‡ªç„¶æ•°s æ•´é™¤ï¼ˆèƒ½å‡ç­‰åˆ†æˆs æ®µï¼‰ï¼›<br>2) y æ–¹å‘è¾¹é•¿å¿…é¡»èƒ½è¢«è‡ªç„¶æ•°t æ•´é™¤ï¼ˆèƒ½å‡ç­‰åˆ†æˆt æ®µï¼‰ï¼›<br>åˆ™ ï¼Œ <font color="#FF0000">è¿™ä¸ªçŸ©å½¢çš„æœ€å°å°ºå¯¸ä¸ºsÃ—t æˆ–tÃ—sï¼Œ</font> æœ€å¤§å°ºå¯¸ä¸º[m/s]Â·sÃ—[m/t]Â·t æˆ–[m/t]Â·tÃ—[m/s]Â·sï¼›å…¶ä¸­[ ]ä¸ºå–æ•´è¿ç®—ç¬¦ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-image.drawio.png" alt="ç‰¹å¾è®¡ç®—-å…¬å¼" title class>
                <p>ç‰¹å¾è®¡ç®—-å…¬å¼</p>
            </figure>
<p>è¿™ç§è®¡ç®—æ–¹å¼å¯èƒ½ä¸å¤ªç›´è§‚ï¼Œé‚£ç”¨ä¸‹é¢çš„åˆ—è¡¨æ–¹å¼çœ‹ä¸€ä¸‹å°±å¾ˆæ¸…æ¥šäº†ï¼Œæˆ‘ä»¬çŸ¥é“ç‰¹å¾åŸå‹åœ¨å›¾åƒçª—å£ä¸­æ ¹æ®å¹³ç§»ä¼¸ç¼©å¾—åˆ°çŸ©å½¢ç‰¹å¾ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-transm.drawio.png" alt="ç‰¹å¾è®¡ç®—-å¹³ç§»ç¼©æ”¾" title class>
                <p>ç‰¹å¾è®¡ç®—-å¹³ç§»ç¼©æ”¾</p>
            </figure>
<p>ç»¼ä¸Šï¼Œå¯ä»¥è®¡ç®—å‡º24x24çš„ç‰¹å¾æ€»æ•°ä¸º 43200+27600+43200+27600+20736=162336ã€‚æ‰€ä»¥äº”ç§å¯èƒ½çš„ç±»å‹å°±äº§ç”Ÿäº†16ä¸‡ä»¥ä¸Šçš„ç‰¹å¾æ•°é‡ï¼ŒåŒæ—¶ä¹Ÿå°±æ˜¯16ä¸‡ä»¥ä¸Šçš„ç‰¹å¾å€¼ï¼Œè¿™ä¸ªæ˜¯ä¸€ä¸ªéå¸¸å¤§æ•°å­—äº†ã€‚ä¸Šå›¾é€šè¿‡ä»£ç è¿›è¡Œè®¡ç®—å°±æ˜¯å¦‚ä¸‹ï¼š</p>
<p>è®¡ç®—æŸä¸€ç§ç‰¹å¾çš„ç‰¹å¾æ•°é‡ï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">totalCount(24,24,2,2);</span><br></pre></td></tr></table></figure>

<p>ç‰¹å¾æ•°é‡çš„è®¡ç®—å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"> private int totalCount(int width,int height,int scaleWidth,int scaleHeight)&#123;</span><br><span class="line">    int total =0;</span><br><span class="line">    for(int i : new Range(scaleWidth, width+1, scaleWidth))&#123;</span><br><span class="line">        for(int j : new Range(scaleHeight, height+1, scaleHeight))&#123;</span><br><span class="line">            total += (width -i +1) * (height - j+1);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    Log.e(&quot;---count&quot;,total+&quot;&quot;);</span><br><span class="line">    return total;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å®ç°ç±»ä¼¼pythonçš„rangeå‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">public class Range implements Iterable&lt;Integer&gt; &#123;</span><br><span class="line">    private final int start;</span><br><span class="line">    private final int end;</span><br><span class="line">    private final int step;</span><br><span class="line"></span><br><span class="line">    public Range(int end) &#123;</span><br><span class="line">        this(0, end, 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Range(int start, int end) &#123;</span><br><span class="line">        this(start, end, 1);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public Range(int start, int end, int step) &#123;</span><br><span class="line">        this.start = start;</span><br><span class="line">        this.end = end;</span><br><span class="line">        this.step = step;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public Iterator&lt;Integer&gt; iterator() &#123;</span><br><span class="line">        return new Itr();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private class Itr implements Iterator&lt;Integer&gt; &#123;</span><br><span class="line">        int current = start;</span><br><span class="line">        @Override</span><br><span class="line">        public boolean hasNext() &#123;</span><br><span class="line">            return step &gt; 0 ? current &lt; end : current &gt; end;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public Integer next() &#123;</span><br><span class="line">            int t = current;</span><br><span class="line">            current += step;</span><br><span class="line">            return t;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @Override</span><br><span class="line">        public void remove() &#123;</span><br><span class="line">            Iterator.super.remove();</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        @RequiresApi(api = Build.VERSION_CODES.N)</span><br><span class="line">        @Override</span><br><span class="line">        public void forEachRemaining(@NonNull Consumer&lt;? super Integer&gt; action) &#123;</span><br><span class="line">            Iterator.super.forEachRemaining(action);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="ç§¯åˆ†å›¾"><a href="#ç§¯åˆ†å›¾" class="headerlink" title="ç§¯åˆ†å›¾"></a>ç§¯åˆ†å›¾</h2><p>ç§¯åˆ†å›¾å°±æ˜¯åªéå†ä¸€æ¬¡å›¾åƒå°±å¯ä»¥æ±‚å‡ºå›¾åƒä¸­æ‰€æœ‰åŒºåŸŸåƒç´ å’Œçš„å¿«é€Ÿç®—æ³•ï¼Œå¤§å¤§çš„æé«˜äº†å›¾åƒç‰¹å¾å€¼è®¡ç®—çš„æ•ˆç‡ã€‚<br>ç§¯åˆ†å›¾ä¸»è¦çš„æ€æƒ³æ˜¯å°†å›¾åƒä»èµ·ç‚¹å¼€å§‹åˆ°å„ä¸ªç‚¹æ‰€å½¢æˆçš„çŸ©å½¢åŒºåŸŸåƒç´ ä¹‹å’Œä½œä¸ºä¸€ä¸ªæ•°ç»„çš„å…ƒç´ ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå½“è¦è®¡ç®—æŸä¸ªåŒºåŸŸçš„åƒç´ å’Œæ—¶å¯ä»¥ç›´æ¥ç´¢å¼•æ•°ç»„çš„å…ƒç´ ï¼Œä¸ç”¨é‡æ–°è®¡ç®—è¿™ä¸ªåŒºåŸŸçš„åƒç´ å’Œï¼Œä»è€ŒåŠ å¿«äº†è®¡ç®—ï¼ˆè¿™æœ‰ä¸ªç›¸åº”çš„ç§°å‘¼ï¼Œå«åšåŠ¨æ€è§„åˆ’ç®—æ³•ï¼‰ã€‚ç§¯åˆ†å›¾èƒ½å¤Ÿåœ¨å¤šç§å°ºåº¦ä¸‹ï¼Œä½¿ç”¨ç›¸åŒçš„æ—¶é—´ï¼ˆå¸¸æ•°æ—¶é—´ï¼‰æ¥è®¡ç®—ä¸åŒçš„ç‰¹å¾ï¼Œå› æ­¤å¤§å¤§æé«˜äº†æ£€æµ‹é€Ÿåº¦ã€‚</p>
<p>ç§¯åˆ†å›¾æ˜¯ä¸€ç§èƒ½å¤Ÿæè¿°å…¨å±€ä¿¡æ¯çš„çŸ©é˜µè¡¨ç¤ºæ–¹æ³•ã€‚ç§¯åˆ†å›¾çš„æ„é€ æ–¹å¼æ˜¯ä½ç½®ï¼ˆğ‘–,ğ‘—ï¼‰å¤„çš„å€¼ğ‘–ğ‘–(ğ‘–,ğ‘—)æ˜¯åŸå›¾åƒ(ğ‘–,ğ‘—)å·¦ä¸Šè§’æ–¹å‘æ‰€æœ‰åƒç´ ğ‘“(ğ‘˜,ğ‘™)çš„å’Œï¼š<br>ğ‘–ğ‘–(ğ‘–,ğ‘—)=âˆ‘ğ‘˜â‰¤ğ‘–,ğ‘™â‰¤ğ‘—ğ‘“(ğ‘˜,ğ‘™)</p>
<p>ç§¯åˆ†å›¾æ„å»ºç®—æ³•ï¼š</p>
<p>1ã€ç”¨ğ‘ (ğ‘–,ğ‘—)è¡¨ç¤ºè¡Œæ–¹å‘çš„ç´¯åŠ å’Œï¼Œåˆå§‹åŒ–ğ‘ (ğ‘–,âˆ’1)=0ï¼›</p>
<p>2ã€ä½¿ç”¨ğ‘–ğ‘–(ğ‘–,ğ‘—)è¡¨ç¤ºä¸€ä¸ªç§¯åˆ†å›¾åƒï¼Œåˆå§‹åŒ–ğ‘–ğ‘–(âˆ’1,ğ‘–)=0ï¼›</p>
<p>3ã€é€è¡Œæ‰«æå›¾åƒï¼Œé€’å½’è®¡ç®—æ¯ä¸ªåƒç´ (ğ‘–,ğ‘—)è¡Œæ–¹å‘çš„ç´¯åŠ å’Œğ‘ (ğ‘–,ğ‘—)å’Œç§¯åˆ†å›¾åƒğ‘–ğ‘–(ğ‘–,ğ‘—)çš„å€¼ï¼š</p>
<p>ğ‘ (ğ‘–,ğ‘—)=ğ‘ (ğ‘–,ğ‘—âˆ’1)+ğ‘“(ğ‘–,ğ‘—)</p>
<p>ğ‘–ğ‘–(ğ‘–,ğ‘—)=ğ‘–ğ‘–(ğ‘–âˆ’1,ğ‘—)+ğ‘ (ğ‘–,ğ‘—)</p>
<p>4ã€æ‰«æå›¾åƒä¸€éï¼Œå½“åˆ°è¾¾å›¾åƒå³ä¸‹è§’åƒç´ æ—¶ï¼Œç§¯åˆ†å›¾åƒğ‘–ğ‘–å°±æ„å»ºå¥½äº†ã€‚</p>
<p>ç§¯åˆ†å›¾æ„é€ å¥½ä¹‹åï¼Œå›¾åƒä¸­ä»»ä½•çŸ©é˜µåŒºåŸŸåƒç´ ç´¯åŠ å’Œéƒ½å¯ä»¥é€šè¿‡ç®€å•è¿ç®—å¾—åˆ°å¦‚å›¾æ‰€ç¤ºï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-jifen.drawio.png" alt="ç§¯åˆ†å›¾" title class>
                <p>ç§¯åˆ†å›¾</p>
            </figure>

<p>åœ¨å›¾Mä¸­ï¼Œè®¾Dçš„å››ä¸ªé¡¶ç‚¹åˆ†åˆ«ä¸ºa,b,c,d,åˆ™Dçš„åƒç´ å¯ä»¥è¡¨ç¤ºä¸ºï¼š<br>ğ·ğ‘ ğ‘¢ğ‘š=ğ‘–ğ‘–(a)+ğ‘–ğ‘–(d)âˆ’(ğ‘–ğ‘–(b)+ğ‘–ğ‘–(c))<br>çœ‹èµ·æ¥è¿˜æ˜¯å¾ˆæŠ½è±¡ï¼šé‚£æˆ‘ä»¬çœ‹å›¾Nï¼Œæˆ‘ä»¬åˆ†åˆ«å‡è®¾ABCDå››ä¸ªçŸ©å½¢çš„åƒç´ ä¸º1ï¼Œ2ï¼Œ3ï¼Œ4.<br>æ‰€ä»¥<br>aç‚¹åƒç´ å€¼ï¼š1<br>bç‚¹åƒç´ å€¼ï¼š1+2=3<br>cç‚¹åƒç´ å€¼ï¼š1+3=4<br>dç‚¹åƒç´ å€¼ï¼š1+2+3+4=10<br>éªŒè¯ä¸‹ä¸Šé¢å…¬å¼ï¼š1+10-ï¼ˆ3+4ï¼‰=4ï¼Œæ‰€ä»¥çŸ©å½¢D=4æ˜¯æ­£ç¡®çš„ã€‚è¿˜æ˜¯ä¸ç›´è§‚ï¼Œé‚£æˆ‘ä»¬ç”¨å›¾è¡¨éªŒè¯ä¸‹ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-jifensample.drawio.png" alt="ç§¯åˆ†å›¾å›¾ä¾‹" title class>
                <p>ç§¯åˆ†å›¾å›¾ä¾‹</p>
            </figure>

<p>å¯ä»¥çœ‹åˆ°ï¼Œ(ğ‘–ğ‘–(b)+ğ‘–ğ‘–(c))åï¼Œæœ‰ä¸€éƒ¨åˆ†é‡åˆçš„åŒºåŸŸï¼Œå³Aï¼Œæ‰€ä»¥éœ€å‡æ‰ï¼Œæœ€åè¿˜éœ€è¦å°†å½“å‰åæ ‡dçš„åƒç´ å€¼DåŒ…å«è¿›æ¥ã€‚<br>(ğ‘–ğ‘–(b)+ğ‘–ğ‘–(c))-A+D = ğ‘–ğ‘–(d) ==&gt; D= ğ‘–ğ‘–(d) + A - (ğ‘–ğ‘–(b)+ğ‘–ğ‘–(c)) ç”±äºA=ğ‘–ğ‘–(a)æ‰€ä»¥å¯ä»¥æ¨å‡º<br>ğ·ğ‘ ğ‘¢ğ‘š=ğ‘–ğ‘–(a)+ğ‘–ğ‘–(d)âˆ’(ğ‘–ğ‘–(b)+ğ‘–ğ‘–(c))</p>
<p>æ‰€ä»¥æ— è®ºçŸ©å½¢çš„å°ºå¯¸å¤§å°ï¼Œåªéœ€æŸ¥æ‰¾ç§¯åˆ†å›¾åƒ4æ¬¡å°±å¯ä»¥æ±‚å¾—ä»»æ„çŸ©å½¢å†…åƒç´ å€¼çš„å’Œã€‚</p>
<h2 id="è®¡ç®—ç‰¹å¾å€¼"><a href="#è®¡ç®—ç‰¹å¾å€¼" class="headerlink" title="è®¡ç®—ç‰¹å¾å€¼"></a>è®¡ç®—ç‰¹å¾å€¼</h2><p>ä¸Šé¢å·²ç»çŸ¥é“ï¼Œä¸€ä¸ªåŒºåŸŸçš„åƒç´ å€¼çš„å’Œï¼Œå¯ä»¥ç”±è¯¥åŒºåŸŸçš„ç«¯ç‚¹çš„ç§¯åˆ†å›¾æ¥è®¡ç®—ã€‚ç”±å‰é¢ç‰¹å¾æ¨¡æ¿çš„ç‰¹å¾å€¼çš„å®šä¹‰å¯ä»¥æ¨å‡ºï¼ŒçŸ©å½¢ç‰¹å¾çš„ç‰¹å¾å€¼å¯ä»¥ç”±ç‰¹å¾ç«¯ç‚¹çš„ç§¯åˆ†å›¾è®¡ç®—å‡ºæ¥ã€‚ä»¥AçŸ©å½¢ç‰¹å¾ä¸ºä¾‹ï¼Œå¦‚ä¸‹å›¾ï¼Œä½¿ç”¨ç§¯åˆ†å›¾è®¡ç®—å…¶ç‰¹å¾å€¼ï¼š</p>
<p> <img src="http://nunu03.github.io/2021/04/27/%E4%BA%BA%E8%84%B8%E6%A3%80%E6%B5%8B%E4%B9%8BHaar%E7%89%B9%E5%BE%81%E4%BB%8B%E7%BB%8D/haar-featurevalue.drawio.png" alt="ç‰¹å¾å€¼-1"></p>
<p>è¯¥çŸ©å½¢ç‰¹å¾çš„ç‰¹å¾å€¼ï¼Œç”±å®šä¹‰ï¼Œä¸ºåŒºåŸŸAçš„åƒç´ å€¼å‡å»åŒºåŸŸBçš„åƒç´ å€¼ã€‚</p>
<p>åŒºåŸŸAçš„åƒç´ å€¼ï¼š<br>ğ‘–ğ‘–(5)+ğ‘–ğ‘–(1)âˆ’ğ‘–ğ‘–(2)âˆ’ğ‘–ğ‘–(4)<br>åŒºåŸŸBçš„åƒç´ å€¼ï¼š<br>ğ‘–ğ‘–(6)+ğ‘–ğ‘–(2)âˆ’ğ‘–ğ‘–(5)âˆ’ğ‘–ğ‘–(3)<br>æ‰€ä»¥ï¼šè¯¥çŸ©å½¢ç‰¹å¾çš„ç‰¹å¾å€¼<br>ğ‘–ğ‘–(5)+ğ‘–ğ‘–(1)âˆ’ğ‘–ğ‘–(2)âˆ’ğ‘–ğ‘–(4)âˆ’[ğ‘–ğ‘–(6)+ğ‘–ğ‘–(2)âˆ’ğ‘–ğ‘–(5)âˆ’ğ‘–ğ‘–(3)]<br>=[ğ‘–ğ‘–(5)âˆ’ğ‘–ğ‘–(4)]+[ğ‘–ğ‘–(3)âˆ’ğ‘–ğ‘–(2)]âˆ’[ğ‘–ğ‘–(2)âˆ’ğ‘–ğ‘–(1)]âˆ’[ğ‘–ğ‘–(6)âˆ’ğ‘–ğ‘–(5)]<br>æ‰€ä»¥ï¼ŒçŸ©å½¢ç‰¹å¾çš„ç‰¹å¾å€¼ï¼Œåªä¸ç‰¹å¾çŸ©å½¢çš„ç«¯ç‚¹çš„ç§¯åˆ†å›¾æœ‰å…³ï¼Œè€Œä¸å›¾åƒçš„åæ ‡æ— å…³ã€‚é€šè¿‡è®¡ç®—ç‰¹å¾çŸ©å½¢çš„ç«¯ç‚¹çš„ç§¯åˆ†å›¾ï¼Œå†è¿›è¡Œç®€å•çš„åŠ å‡è¿ç®—ï¼Œå°±å¯ä»¥å¾—åˆ°ç‰¹å¾å€¼ï¼Œæ­£å› ä¸ºå¦‚æ­¤ï¼Œç‰¹å¾çš„è®¡ç®—é€Ÿåº¦å¤§å¤§æé«˜ï¼Œä¹Ÿæé«˜äº†ç›®æ ‡çš„æ£€æµ‹é€Ÿåº¦ã€‚</p>
<p>ç„¶åçœ‹ä¸€ä¸ªå¤æ‚ä¸€ç‚¹çš„ç§¯åˆ†å›¾ç¤ºä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/haar-x3.drawio.png" alt="ç‰¹å¾å€¼-2" title class>
                <p>ç‰¹å¾å€¼-2</p>
            </figure>

<h2 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/xml.jpg" alt="haar-xml" title class>
                <p>haar-xml</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/xml-node.jpg" alt="haar-stages" title class>
                <p>haar-stages</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2021/04/27/äººè„¸æ£€æµ‹ä¹‹Haarç‰¹å¾ä»‹ç»/xml-value.jpg" alt="haar-node" title class>
                <p>haar-node</p>
            </figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.cnblogs.com/zyly/p/9410563.html#_label0" target="_blank" rel="noopener">äººè„¸æ£€æµ‹ä¹‹Haaråˆ†ç±»å™¨</a><br><a href="https://www.cnblogs.com/codingmengmeng/p/6567124.html" target="_blank" rel="noopener">ç§¯åˆ†å›¾åŠå…¶åº”ç”¨</a><br><a href="https://zhuanlan.zhihu.com/p/38056144" target="_blank" rel="noopener">äººè„¸Haarç‰¹å¾å¿«é€Ÿæ£€æµ‹åŠå…¶ç‰¹å¾è®¡ç®—</a><br><a href="https://blog.csdn.net/liulina603/article/details/8617281" target="_blank" rel="noopener">Haarç‰¹å¾ä¸ç§¯åˆ†å›¾</a></p>
]]></content>
      
        <categories>
            
            <category> äººè„¸æ£€æµ‹ </category>
            
            <category> Haar </category>
            
        </categories>
        
        
        <tags>
            
            <tag> äººè„¸æ£€æµ‹ </tag>
            
            <tag> Haar </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[OpenCVå­¦ä¹ ]]></title>
      <url>/2021/03/24/OpenCV%E5%AD%A6%E4%B9%A0/</url>
      <content type="html"><![CDATA[<h2 id="C-11-shared-ptr"><a href="#C-11-shared-ptr" class="headerlink" title="C++11 shared_ptr"></a>C++11 shared_ptr</h2><p>OpenCVæä¾›äº†ç±»ä¼¼äºC ++ 11ä¸­çš„std :: shared_ptrçš„Ptræ¨¡æ¿ç±»ï¼Œç”¨æ¥å®ç°è‡ªåŠ¨å†…å­˜ç®¡ç†ã€‚</p>
]]></content>
      
        <categories>
            
            <category> OpenCV </category>
            
        </categories>
        
        
        <tags>
            
            <tag> OpenCV </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[æ—¥å¸¸é—®é¢˜è§£å†³è®°å½•]]></title>
      <url>/2021/02/25/%E6%97%A5%E5%B8%B8%E9%97%AE%E9%A2%98%E8%A7%A3%E5%86%B3%E8%AE%B0%E5%BD%95/</url>
      <content type="html"><![CDATA[<h2 id="1-Android-Studio-ä¸èƒ½è°ƒè¯•"><a href="#1-Android-Studio-ä¸èƒ½è°ƒè¯•" class="headerlink" title="1.Android Studio ä¸èƒ½è°ƒè¯•"></a>1.Android Studio ä¸èƒ½è°ƒè¯•</h2><p>æç¤ºå¼‚å¸¸ï¼šAttention! No symbol directories found - please check your native debug configuration</p>
<p>è§£å†³æ–¹æ¡ˆï¼šåœ¨Android studioï¼Œ fileâ€“&gt;setteringâ€”&gt;pluginsâ€”-android NDK supportæ’ä»¶çš„é€‰é¡¹å»æ‰ã€‚é‡æ–°ç¼–è¯‘åå†debugå°±å¯ä»¥äº†ã€‚</p>
<p><a href="https://www.jianshu.com/p/3d8ddf8df1b6" target="_blank" rel="noopener">android studioæ— æ³•debugè§£å†³æ–¹æ³•</a></p>
<h2 id="2-Linuxä¸‹Gitå‘½ä»¤ä¸­æ–‡æ˜¾ç¤ºä¹±ç "><a href="#2-Linuxä¸‹Gitå‘½ä»¤ä¸­æ–‡æ˜¾ç¤ºä¹±ç " class="headerlink" title="2.Linuxä¸‹Gitå‘½ä»¤ä¸­æ–‡æ˜¾ç¤ºä¹±ç "></a>2.Linuxä¸‹Gitå‘½ä»¤ä¸­æ–‡æ˜¾ç¤ºä¹±ç </h2><p>æç¤ºå¼‚å¸¸ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   &quot;\347\211\210\346\234\254\347\256\241\347\220\206/.DS_Store&quot;</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br><span class="line"></span><br><span class="line">        &quot;\347\211\210\346\234\254\347\256\241\347\220\206/\350\264\250\351\207\217\344\277\235\350\257\201/\346\265\213\350\257\225\347\224\250\344\276\213\351\233\206/\346\224\257\344\273\230\347\233\270\345\205\263.numbers&quot;</span><br><span class="line"></span><br><span class="line">no changes added to commit (use &quot;git add&quot; and/or &quot;git commit -a&quot;)</span><br><span class="line"></span><br><span class="line">chenyulong01deMacBook-Pro:WbuDoc chenyulong01$ git config --global core.quotepath false</span><br><span class="line">chenyulong01deMacBook-Pro:WbuDoc chenyulong01$ git status</span><br><span class="line">On branch master</span><br><span class="line">Your branch is up-to-date with &apos;origin/master&apos;.</span><br><span class="line"></span><br><span class="line">Changes not staged for commit:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to update what will be committed)</span><br><span class="line">  (use &quot;git checkout -- &lt;file&gt;...&quot; to discard changes in working directory)</span><br><span class="line"></span><br><span class="line">        modified:   .DS_Store</span><br><span class="line">        modified:   ç‰ˆæœ¬ç®¡ç†/.DS_Store</span><br><span class="line"></span><br><span class="line">Untracked files:</span><br><span class="line">  (use &quot;git add &lt;file&gt;...&quot; to include in what will be committed)</span><br></pre></td></tr></table></figure>

<p>è§£å†³æ–¹æ¡ˆï¼š <strong>git config â€“global core.quotepath false</strong></p>
<h2 id="3-Gitå¸¸ç”¨å‘½ä»¤"><a href="#3-Gitå¸¸ç”¨å‘½ä»¤" class="headerlink" title="3.Gitå¸¸ç”¨å‘½ä»¤"></a>3.Gitå¸¸ç”¨å‘½ä»¤</h2><p>1.git reset HEAD^ æ’¤é”€æœ€åä¸€æ¬¡commit</p>
<p>2.git remote -v æŸ¥çœ‹è¿œç«¯ä»“åº“åœ°å€</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chenyulong01$ git remote -v</span><br><span class="line">origin  https://github.com/danengz/OpenCVDemo.git (fetch)</span><br><span class="line">origin  https://github.com/danengz/OpenCVDemo.git (push)</span><br></pre></td></tr></table></figure>

<h2 id="4-Android-Studio-Connect-to-127-0-0-1-8888-127-0-0-1-failed-Connection-refused-Connection-refused"><a href="#4-Android-Studio-Connect-to-127-0-0-1-8888-127-0-0-1-failed-Connection-refused-Connection-refused" class="headerlink" title="4.Android Studio - Connect to 127.0.0.1:8888 [/127.0.0.1] failed: Connection refused (Connection refused)"></a>4.Android Studio - Connect to 127.0.0.1:8888 [/127.0.0.1] failed: Connection refused (Connection refused)</h2><blockquote>
<p>Could not resolve com.anjuke.android.community:communitymodule:1014-1.0.0.<br>Could not get resource â€˜<a href="http://artifactory.58corp.com:8081/artifactory/android-public/com/anjuke/android/community/communitymodule/1014-1.0.0/communitymodule-1014-1.0.0.pom&#39;" target="_blank" rel="noopener">http://artifactory.58corp.com:8081/artifactory/android-public/com/anjuke/android/community/communitymodule/1014-1.0.0/communitymodule-1014-1.0.0.pom&#39;</a>.<br>Could not GET â€˜<a href="http://artifactory.58corp.com:8081/artifactory/android-public/com/anjuke/android/community/communitymodule/1014-1.0.0/communitymodule-1014-1.0.0.pom&#39;" target="_blank" rel="noopener">http://artifactory.58corp.com:8081/artifactory/android-public/com/anjuke/android/community/communitymodule/1014-1.0.0/communitymodule-1014-1.0.0.pom&#39;</a>.<br>Connect to 127.0.0.1:8888 [/127.0.0.1] failed: Connection refused (Connection refused)</p>
</blockquote>
<p>è§£å†³æ–¹æ¡ˆï¼šcmdï¼šlsof -iï¼Œæ‰¾åˆ°COMMAND java å¯¹åº”çš„ PIDï¼Œç„¶åkill 98087  </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">chenyulong01deMacBook-Pro:~ chenyulong01$ lsof -i</span><br><span class="line">COMMAND     PID         USER   FD   TYPE             DEVICE SIZE/OFF NODE NAME</span><br><span class="line">java      77690 chenyulong01  211u  IPv6 0x426c9f64949f384b      0t0  TCP *:65337 (LISTEN)</span><br><span class="line">chenyulong01deMacBook-Pro:~ chenyulong01$ </span><br><span class="line">chenyulong01deMacBook-Pro:~ chenyulong01$ kill 77690</span><br><span class="line">chenyulong01deMacBook-Pro:~ chenyulong01$</span><br></pre></td></tr></table></figure>

]]></content>
      
        <categories>
            
            <category> Log </category>
            
            <category> Fix </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Log </tag>
            
            <tag> Fix </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[nps å†…ç½‘ç©¿é€]]></title>
      <url>/2021/01/06/nps-%E5%86%85%E7%BD%91%E7%A9%BF%E9%80%8F/</url>
      <content type="html"><![CDATA[<h2 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h2><p><a href="https://github.com/ehang-io/nps/releases" target="_blank" rel="noopener">ä¸‹è½½npsï¼š</a></p>
<p>Macç³»ç»Ÿï¼šdarwin_amd64_server.tar.gz<br>ä¸‹è½½åè§£å‹ï¼Œåœ¨è§£å‹æ–‡ä»¶å¤¹ï¼Œæ‰§è¡Œï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br></pre></td><td class="code"><pre><span class="line">chenyulong01deMacBook-Pro:Downloads chenyulong01$ cd darwin_amd64_server</span><br><span class="line"></span><br><span class="line">chenyulong01deMacBook-Pro:darwin_amd64_server chenyulong01$ sudo ./nps install</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/conf/clients.json to /etc/nps/conf/clients.json</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/conf/hosts.json to /etc/nps/conf/hosts.json</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/conf/nps.conf to /etc/nps/conf/nps.conf</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/conf/server.key to /etc/nps/conf/server.key</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/conf/server.pem to /etc/nps/conf/server.pem</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/conf/tasks.json to /etc/nps/conf/tasks.json</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/client/add.html to /etc/nps/web/views/client/add.html</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/views/client/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/client/edit.html to /etc/nps/web/views/client/edit.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/client/list.html to /etc/nps/web/views/client/list.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/add.html to /etc/nps/web/views/index/add.html</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/views/index/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/edit.html to /etc/nps/web/views/index/edit.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/hadd.html to /etc/nps/web/views/index/hadd.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/hedit.html to /etc/nps/web/views/index/hedit.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/help.html to /etc/nps/web/views/index/help.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/hlist.html to /etc/nps/web/views/index/hlist.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/index.html to /etc/nps/web/views/index/index.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/index/list.html to /etc/nps/web/views/index/list.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/login/index.html to /etc/nps/web/views/login/index.html</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/views/login/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/login/register.html to /etc/nps/web/views/login/register.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/public/error.html to /etc/nps/web/views/public/error.html</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/views/public/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/views/public/layout.html to /etc/nps/web/views/public/layout.html</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/bootstrap-table.min.css to /etc/nps/web/static/css/bootstrap-table.min.css</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/static/css/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/bootstrap.min.css to /etc/nps/web/static/css/bootstrap.min.css</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/datatables.css to /etc/nps/web/static/css/datatables.css</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/fontawesome.min.css to /etc/nps/web/static/css/fontawesome.min.css</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/regular.min.css to /etc/nps/web/static/css/regular.min.css</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/solid.min.css to /etc/nps/web/static/css/solid.min.css</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/css/style.css to /etc/nps/web/static/css/style.css</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/img/flag/en-US.png to /etc/nps/web/static/img/flag/en-US.png</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/static/img/</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/static/img/flag/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/img/flag/zh-CN.png to /etc/nps/web/static/img/flag/zh-CN.png</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/bootstrap-table-locale-all.min.js to /etc/nps/web/static/js/bootstrap-table-locale-all.min.js</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/static/js/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/bootstrap-table.min.js to /etc/nps/web/static/js/bootstrap-table.min.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/bootstrap.min.js to /etc/nps/web/static/js/bootstrap.min.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/echarts.min.js to /etc/nps/web/static/js/echarts.min.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/fontawesome.min.js to /etc/nps/web/static/js/fontawesome.min.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/inspinia.js to /etc/nps/web/static/js/inspinia.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/jquery-3.4.1.min.js to /etc/nps/web/static/js/jquery-3.4.1.min.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/language.js to /etc/nps/web/static/js/language.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/js/popper.min.js to /etc/nps/web/static/js/popper.min.js</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/page/error.html to /etc/nps/web/static/page/error.html</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/static/page/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/page/languages.xml to /etc/nps/web/static/page/languages.xml</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/webfonts/fa-solid-900.eot to /etc/nps/web/static/webfonts/fa-solid-900.eot</span><br><span class="line">2021/01/06 14:21:18 mkdir:/etc/nps/web/static/webfonts/</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/webfonts/fa-solid-900.svg to /etc/nps/web/static/webfonts/fa-solid-900.svg</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/webfonts/fa-solid-900.ttf to /etc/nps/web/static/webfonts/fa-solid-900.ttf</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/webfonts/fa-solid-900.woff to /etc/nps/web/static/webfonts/fa-solid-900.woff</span><br><span class="line">2021/01/06 14:21:18 copy file ::/Users/chenyulong01/Downloads/darwin_amd64_server/web/static/webfonts/fa-solid-900.woff2 to /etc/nps/web/static/webfonts/fa-solid-900.woff2</span><br><span class="line">2021/01/06 14:21:18 install ok!</span><br><span class="line">2021/01/06 14:21:18 Static files and configuration files in the current directory will be useless</span><br><span class="line">2021/01/06 14:21:18 The new configuration file is located in /etc/nps you can edit them</span><br><span class="line">2021/01/06 14:21:18 You can start with:</span><br><span class="line">nps start|stop|restart|uninstall|update or nps-update update</span><br><span class="line">anywhere!</span><br></pre></td></tr></table></figure>

<p>å¯åŠ¨ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">chenyulong01deMacBook-Pro:~ chenyulong01$ cd /etc/nps/</span><br><span class="line">chenyulong01deMacBook-Pro:nps chenyulong01$ ls</span><br><span class="line">conf	web</span><br><span class="line">chenyulong01deMacBook-Pro:nps chenyulong01$ sudo nps start</span><br><span class="line">2021/01/06 14:27:47.789 [E] [nps.go:132]  Valid actions: [&quot;start&quot; &quot;stop&quot; &quot;restart&quot; &quot;install&quot; &quot;uninstall&quot;]</span><br><span class="line">Failed to start npså†…ç½‘ç©¿é€ä»£ç†æœåŠ¡å™¨: &quot;launchctl&quot; failed with stderr: /Library/LaunchDaemons/Nps.plist: service already loaded</span><br><span class="line"></span><br><span class="line">chenyulong01deMacBook-Pro:nps chenyulong01$ sudo nps stop</span><br><span class="line">chenyulong01deMacBook-Pro:nps chenyulong01$ sudo nps start</span><br></pre></td></tr></table></figure>

<h2 id="webç®¡ç†"><a href="#webç®¡ç†" class="headerlink" title="webç®¡ç†"></a>webç®¡ç†</h2><p>ç½‘å€ï¼š<a href="http://localhost:8080/login/index" target="_blank" rel="noopener">http://localhost:8080/login/index</a></p>
<p>è´¦å·ï¼šadmin</p>
<p>å¯†ç ï¼š123</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="http://www.nasge.com/archives/48.html" target="_blank" rel="noopener">å†…ç½‘ç©¿é€å·¥å…·æ¯”è¾ƒ(ngrok,frp,lanproxy,goproxy,nps)</a><br><a href="https://github.com/ehang-io/nps/blob/master/README_zh.md" target="_blank" rel="noopener">ehang-io-nps</a></p>
<p><a href="https://ehang-io.github.io/nps/#/example" target="_blank" rel="noopener">Api</a></p>
<p><a href="https://blog.csdn.net/weixin_39251927/article/details/104843100" target="_blank" rel="noopener">NPSå†…ç½‘ç©¿é€å·¥å…·</a></p>
]]></content>
      
        <categories>
            
            <category> ngrok </category>
            
            <category> nps </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ngrok </tag>
            
            <tag> nps </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Uriè·å–èµ„æºæ–‡ä»¶]]></title>
      <url>/2020/11/12/Uri%E8%8E%B7%E5%8F%96%E8%B5%84%E6%BA%90%E6%96%87%E4%BB%B6/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¼€å‘ä¸­é‡åˆ°å†ç”¨frescoæ˜¾ç¤ºå›¾ç‰‡æ˜¯ï¼ŒåŠ¨æ€è®¾ç½®placeholderä¼šæ˜¾ç¤ºé—®é¢˜ã€‚ä½†æ˜¯è®¾ç½®setImageUrlæ²¡æœ‰é—®é¢˜ã€‚é‚£å¦‚ä½•é€šè¿‡setImageUrlè®¾ç½®drawableä¸­çš„å›¾ç‰‡å‘¢ï¼Ÿé€šè¿‡Uriå³å¯ã€‚</p>
<h2 id="å®ç°"><a href="#å®ç°" class="headerlink" title="å®ç°"></a>å®ç°</h2><p>å…·ä½“çš„é›†ä¸­æ–¹å¼ï¼š</p>
<p>Uri uri = Uri.parse(â€œandroid.resource://â€œ + getPackageName() + â€œ/raw/iconâ€ );</p>
<p>Uri uri = Uri.parse(â€œandroid.resource://â€œ + getPackageName() + â€œ/raw/â€œ +R.raw.icon);</p>
<p>Uri uri = Uri.parse(â€œandroid.resource://â€œ + getPackageName() + â€œ/â€œ +R.raw.icon);</p>
<p>Uri uri = Uri.parse(â€œandroid.resource://â€œ + getPackageName() + â€œ/â€œ +R.drawable.icon);</p>
<p>Uri uri = Uri.parse(â€œandroid.resource://â€œ + getPackageName() + â€œ/xxxxxxx/iconâ€ );</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/guang_liang_/article/details/81939898" target="_blank" rel="noopener">Android Uriè·å–èµ„æºæ–‡ä»¶</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[GPUImageæ¸²æŸ“æµç¨‹è§£æ]]></title>
      <url>/2020/08/13/GPUImage%E6%B8%B2%E6%9F%93%E6%B5%81%E7%A8%8B%E8%A7%A3%E6%9E%90/</url>
      <content type="html"><![CDATA[<h2 id="æ¸²æŸ“"><a href="#æ¸²æŸ“" class="headerlink" title="æ¸²æŸ“"></a>æ¸²æŸ“</h2><h3 id="åˆ›å»ºè§†å›¾"><a href="#åˆ›å»ºè§†å›¾" class="headerlink" title="åˆ›å»ºè§†å›¾"></a>åˆ›å»ºè§†å›¾</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">//ç‰ˆæœ¬</span><br><span class="line">mGlSurfaceView.setEGLContextClientVersion(2);</span><br><span class="line">// è®¾ç½®æ¸²æŸ“å™¨(è¿™ä¸ªæ¸²æŸ“å™¨çš„ç±»éå¸¸é‡è¦)</span><br><span class="line">mGlSurfaceView.setRenderer(mRenderer);</span><br><span class="line">// è®¾ç½®æ¸²æŸ“æ¨¡å¼ä¸ºæ ¹æ®éœ€è¦æ¥æ¸²æŸ“ï¼ˆRENDERMODE_CONTINUOUSLYï¼‰</span><br><span class="line">mGlSurfaceView.setRenderMode(GLSurfaceView.RENDERMODE_WHEN_DIRTY);</span><br><span class="line">mGlSurfaceView.requestRender();</span><br></pre></td></tr></table></figure>

<h3 id="åæ ‡"><a href="#åæ ‡" class="headerlink" title="åæ ‡"></a>åæ ‡</h3><ul>
<li><p>é¡¶ç‚¹åæ ‡ï¼šåœ¨OpenGLä¸­ï¼Œé¡¶ç‚¹åæ ‡ä½¿ç”¨çš„æ˜¯ç¬›å¡å°”å³æ‰‹åæ ‡ç³»ï¼ˆä¸–ç•Œåæ ‡ç³»ï¼‰ã€‚åˆ†X Y Z 3ä¸ªè½´ï¼ŒXè½´æœå³ä¸ºæ­£ï¼ŒYè½´æœä¸Šä¸ºæ­£ï¼ŒZè½´å‚ç›´å±å¹•æœå¤–ä¸ºæ­£ã€‚X Y Z 3ä¸ªè½´çš„æœ€å¤§ä¸æœ€å°å€¼ä¸º 1 å’Œ -1ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/é¡¶ç‚¹åæ ‡.png" alt title class>
                <p></p>
            </figure>
</li>
<li><p>å±å¹•åæ ‡ï¼šå±å¹•åæ ‡ç³»ï¼Œå°±æ˜¯åº”ç”¨åœ¨è®¾å¤‡å±å¹•ä¸Šçš„åæ ‡ç³»ï¼Œä¹Ÿå°±æ˜¯å›¾å½¢æœ€ç»ˆæ˜¾ç¤ºçš„åœ°æ–¹ã€‚Xè½´æœå³ä¸ºæ­£ï¼ŒYè½´æœä¸‹ä¸ºæ­£ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/å±å¹•åæ ‡.png" alt title class>
                <p></p>
            </figure></li>
<li><p>çº¹ç†åæ ‡ï¼šåŸç‚¹åœ¨å·¦ä¸‹è§’ï¼ŒXè½´æœå³ä¸ºæ­£ï¼ŒYè½´æœä¸Šä¸ºæ­£ï¼ŒX Y è½´çš„æœ€å¤§ä¸æœ€å°å€¼ä¸º 0 å’Œ 1ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/çº¹ç†åæ ‡.png" alt title class>
                <p></p>
            </figure>

</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">//é¡¶ç‚¹åæ ‡</span><br><span class="line">static final float VERTICE[] = &#123;</span><br><span class="line">            -1.0f, -1.0f,</span><br><span class="line">            1.0f, -1.0f,</span><br><span class="line">            -1.0f, 1.0f,</span><br><span class="line">            1.0f, 1.0f,</span><br><span class="line">    &#125;;</span><br><span class="line">//çº¹ç†åæ ‡  å¯¹åº”é¡¶ç‚¹åæ ‡  ä¸ä¹‹æ˜ å°„</span><br><span class="line">static final float TEXTURE[] = &#123;</span><br><span class="line">        0.0f, 0.0f,</span><br><span class="line">        1.0f, 0.0f,</span><br><span class="line">        0.0f, 1.0f,</span><br><span class="line">        1.0f, 1.0f,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼šçº¹ç†åæ ‡ä¸é¡¶ç‚¹åæ ‡éå¿…éœ€ä¸€ä¸€å¯¹åº”ï¼Œçº¹ç†çš„åæ ‡ä¼šå¯¼è‡´å›¾ç‰‡çš„ç¼©æ”¾æ˜¾ç¤ºã€‚</strong>  </p>
<h3 id="é¡¶ç‚¹ç€è‰²å™¨-Vertex-Shader-ï¼Œç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment-Shaderï¼‰"><a href="#é¡¶ç‚¹ç€è‰²å™¨-Vertex-Shader-ï¼Œç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment-Shaderï¼‰" class="headerlink" title="é¡¶ç‚¹ç€è‰²å™¨(Vertex Shader)ï¼Œç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment Shaderï¼‰"></a>é¡¶ç‚¹ç€è‰²å™¨(Vertex Shader)ï¼Œç‰‡å…ƒç€è‰²å™¨ï¼ˆFragment Shaderï¼‰</h3><p>é¡¶ç‚¹ç€è‰²å™¨å¤„ç†ä¼ å…¥çš„é¡¶ç‚¹æ•°æ®ï¼ŒåŒ…æ‹¬é¡¶ç‚¹ä½ç½®ã€é¡¶ç‚¹é¢œè‰²ã€å…‰ç…§ç­‰ï¼Œæ¯ä¸ªé¡¶ç‚¹éƒ½ä¼šæ‰§è¡Œä¸€æ¬¡ã€‚</p>
<p>ç‰‡å…ƒç€è‰²å™¨ä¸»è¦ç›®çš„æ˜¯è®¡ç®—ä¸€ä¸ªåƒç´ çš„æœ€ç»ˆé¢œè‰²ã€‚ç‰‡å…ƒå¹¶ä¸æ˜¯çœŸæ­£æ„ä¹‰ä¸Šçš„åƒç´ ã€‚è€Œæ˜¯åŒ…å«äº†å¾ˆå¤šçŠ¶æ€çš„é›†åˆï¼Œè¿™äº›çŠ¶æ€ç”¨æ¥è®¡ç®—æœ€ç»ˆé¢œè‰²ã€‚è¿™äº›çŠ¶æ€åŒ…æ‹¬ä½†ä¸é™äºå®ƒçš„å±å¹•åæ ‡ï¼Œæ·±åº¦ä¿¡æ¯ï¼Œæ³•çº¿ï¼Œçº¹ç†åæ ‡ç­‰ã€‚</p>
<p>æ‰€ä»¥ï¼Œé¡¶ç‚¹ç€è‰²å™¨ç”¨äºç»˜åˆ¶é¡¶ç‚¹ï¼Œç‰‡å…ƒç€è‰²å™¨ç”¨äºç»™é¡¶ç‚¹è¿çº¿åæ‰€åŒ…å›´çš„åŒºåŸŸå¡«å……é¢œè‰²ï¼Œå¯ä»¥ç®€å•çš„ç†è§£æˆwindowsä¸­ç”»å›¾çš„å¡«å……å·¥å…·ã€‚æ‰€ä»¥ä¸‹è¾¹æ˜¯ç”Ÿæˆç®€å•ç€è‰²å™¨çš„ä¸¤ä¸ªæºç ï¼š <a href="https://www.jianshu.com/p/66b10062bd67" target="_blank" rel="noopener">GLSLåŸºç¡€è¯­æ³•ä»‹ç»</a></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">public static final String NO_FILTER_VERTEX_SHADER = &quot;&quot; +</span><br><span class="line">	//é¡¶ç‚¹åœ¨ç”»å¸ƒä¸­çš„ä½ç½®</span><br><span class="line">	&quot;attribute vec4 position;\n&quot; + </span><br><span class="line">	// çº¹ç†æ˜ å°„,çº¹ç†åæ ‡æ˜¯çº¹ç†æ˜ å°„çš„ä¸€éƒ¨åˆ†ã€‚è¿™æ„å‘³ç€ä½ æƒ³è¦å¯¹ä½ çš„çº¹ç†è¿›è¡ŒæŸç§æ»¤é•œæ“ä½œçš„æ—¶å€™ä¼šç”¨åˆ°å®ƒã€‚</span><br><span class="line">	&quot;attribute vec4 inputTextureCoordinate;\n&quot; +</span><br><span class="line">	&quot; \n&quot; +</span><br><span class="line">	//å˜é‡,è´Ÿè´£é¡¶ç‚¹ç€è‰²å™¨è´Ÿè´£å’Œç‰‡æ®µç€è‰²å™¨äº¤æµï¼Œä»¥åŠä¿¡æ¯çš„å…±äº«</span><br><span class="line">	&quot;varying vec2 textureCoordinate;\n&quot; +</span><br><span class="line">	&quot; \n&quot; +</span><br><span class="line">	&quot;void main()\n&quot; +</span><br><span class="line">	&quot;&#123;\n&quot; +</span><br><span class="line">	&quot;    gl_Position = position;\n&quot; +</span><br><span class="line">	//æˆ‘ä»¬å–å‡ºè¿™ä¸ªé¡¶ç‚¹ä¸­çº¹ç†åæ ‡çš„ X å’Œ Y çš„ä½ç½®ã€‚æˆ‘ä»¬åªå…³å¿ƒ inputTextureCoordinate ä¸­çš„å‰ä¸¤ä¸ªå‚æ•°ï¼ŒX å’Œ Yã€‚è¿™ä¸ªåæ ‡æœ€å¼€å§‹æ˜¯é€šè¿‡ 4 ä¸ªå±æ€§å­˜åœ¨é¡¶ç‚¹ç€è‰²å™¨é‡Œçš„ï¼Œä½†æˆ‘ä»¬åªéœ€è¦å…¶ä¸­çš„ä¸¤ä¸ªã€‚</span><br><span class="line">	&quot;    textureCoordinate = inputTextureCoordinate.xy;\n&quot; +</span><br><span class="line">	&quot;&#125;&quot;;</span><br><span class="line">	</span><br><span class="line">	/**</span><br><span class="line">     * è¿™ä¸ªç€è‰²å™¨å®é™…ä¸Šä¸ä¼šæ”¹å˜å›¾åƒä¸­çš„ä»»ä½•ä¸œè¥¿ã€‚å®ƒæ˜¯ä¸€ä¸ªç›´é€šç€è‰²å™¨ï¼Œæ„å‘³ç€æˆ‘ä»¬è¾“å…¥æ¯ä¸€ä¸ªåƒç´ ï¼Œç„¶åè¾“å‡ºå®Œå…¨ç›¸åŒçš„åƒç´ ã€‚</span><br><span class="line">     */</span><br><span class="line">public static final String NO_FILTER_FRAGMENT_SHADER = &quot;&quot; +</span><br><span class="line"></span><br><span class="line">   //å› ä¸ºç‰‡æ®µç€è‰²å™¨ä½œç”¨åœ¨æ¯ä¸€ä¸ªåƒç´ ä¸Šï¼Œæˆ‘ä»¬éœ€è¦ä¸€ä¸ªæ–¹æ³•æ¥ç¡®å®šæˆ‘ä»¬å½“å‰åœ¨åˆ†æå“ªä¸€ä¸ªåƒç´ /ç‰‡æ®µã€‚å®ƒéœ€è¦å­˜å‚¨åƒç´ çš„ X å’Œ Y åæ ‡ã€‚æˆ‘ä»¬æ¥æ”¶åˆ°çš„æ˜¯å½“å‰åœ¨é¡¶ç‚¹ç€è‰²å™¨è¢«è®¾ç½®å¥½çš„çº¹ç†åæ ‡ã€‚</span><br><span class="line">    &quot;varying highp vec2 textureCoordinate;\n&quot; +</span><br><span class="line">    &quot; \n&quot; +</span><br><span class="line">    //ä¸ºäº†å¤„ç†å›¾åƒï¼Œæˆ‘ä»¬ä»åº”ç”¨ä¸­æ¥æ”¶ä¸€ä¸ªå›¾ç‰‡çš„å¼•ç”¨ï¼Œæˆ‘ä»¬æŠŠå®ƒå½“åšä¸€ä¸ª 2D çš„çº¹ç†ã€‚è¿™ä¸ªæ•°æ®ç±»å‹è¢«å«åš sampler2D ï¼Œè¿™æ˜¯å› ä¸ºæˆ‘ä»¬è¦ä»è¿™ä¸ª 2D çº¹ç†ä¸­é‡‡æ ·å‡ºä¸€ä¸ªç‚¹æ¥è¿›è¡Œå¤„ç†ã€‚</span><br><span class="line">    &quot;uniform sampler2D inputImageTexture;\n&quot; +</span><br><span class="line">    &quot; \n&quot; +</span><br><span class="line">    &quot;void main()\n&quot; +</span><br><span class="line">    &quot;&#123;\n&quot; +</span><br><span class="line">    //è¿™æ˜¯ä¸€ä¸ª GLSL ç‰¹æœ‰çš„æ–¹æ³•ï¼štexture2Dï¼Œé¡¾åæ€ä¹‰ï¼Œåˆ›å»ºä¸€ä¸ª 2D çš„çº¹ç†ã€‚å®ƒé‡‡ç”¨æˆ‘ä»¬ä¹‹å‰å£°æ˜è¿‡çš„å±æ€§ä½œä¸ºå‚æ•°æ¥å†³å®šè¢«å¤„ç†çš„åƒç´ çš„é¢œè‰²ã€‚è¿™ä¸ªé¢œè‰²ç„¶åè¢«è®¾ç½®ç»™å¦å¤–ä¸€ä¸ªå†…å»ºå˜é‡ï¼Œgl_FragColorã€‚å› ä¸ºç‰‡æ®µç€è‰²å™¨çš„å”¯ä¸€ç›®çš„å°±æ˜¯ç¡®å®šä¸€ä¸ªåƒç´ çš„é¢œè‰²ï¼Œgl_FragColor æœ¬è´¨ä¸Šå°±æ˜¯æˆ‘ä»¬ç‰‡æ®µç€è‰²å™¨çš„è¿”å›è¯­å¥ã€‚</span><br><span class="line">    &quot;     gl_FragColor = texture2D(inputImageTexture, textureCoordinate);\n&quot; +</span><br><span class="line">        &quot;&#125;&quot;;</span><br></pre></td></tr></table></figure>

<p>æœ‰äº†æºç ï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ›å»ºç€è‰²å™¨ï¼š<br>æˆ‘ä»¬é¦–å…ˆè¦åšçš„æ˜¯åˆ›å»ºä¸€ä¸ªç€è‰²å™¨å¯¹è±¡ï¼Œæ³¨æ„è¿˜æ˜¯ç”¨IDæ¥å¼•ç”¨çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å‚¨å­˜è¿™ä¸ªé¡¶ç‚¹ç€è‰²å™¨çš„IDä¸ºunsigned intï¼Œç„¶åç”¨glCreateShaderåˆ›å»ºè¿™ä¸ªç€è‰²å™¨ï¼Œæˆ‘ä»¬æŠŠéœ€è¦åˆ›å»ºçš„ç€è‰²å™¨ç±»å‹ä»¥å‚æ•°å½¢å¼æä¾›ç»™glCreateShaderï¼Œç”±äºæˆ‘ä»¬æ­£åœ¨åˆ›å»ºä¸€ä¸ªé¡¶ç‚¹ç€è‰²å™¨ï¼Œä¼ é€’çš„å‚æ•°æ˜¯GLES20.GL_VERTEX_SHADER</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">int iShader = GLES20.glCreateShader(GLES20.GL_VERTEX_SHADER);</span><br></pre></td></tr></table></figure>

<p>ä¸‹ä¸€æ­¥æˆ‘ä»¬æŠŠè¿™ä¸ªç€è‰²å™¨æºç é™„åŠ åˆ°ç€è‰²å™¨å¯¹è±¡ä¸Šï¼Œç„¶åç¼–è¯‘å®ƒï¼šç¬¬ä¸€ä¸ªå‚æ•°æ˜¯è¦ç¼–è¯‘çš„ç€è‰²å™¨å¯¹è±¡,ç¬¬äºŒå‚æ•°æŒ‡å®šäº†ä¼ é€’çš„æºç å­—ç¬¦ä¸².</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">GLES20.glShaderSource(iShader, strSource);</span><br><span class="line">GLES20.glCompileShader(iShader);</span><br></pre></td></tr></table></figure>

<p>åŒæ—¶ï¼Œæˆ‘ä»¬è¦æ£€æµ‹åœ¨è°ƒç”¨glCompileShaderåç¼–è¯‘æ˜¯å¦æˆåŠŸäº†ï¼Œå¦‚æœæ²¡æˆåŠŸçš„è¯ï¼Œä¹Ÿå¸Œæœ›çŸ¥é“é”™è¯¯æ˜¯ä»€ä¹ˆï¼Œè¿™ä»¥ä¾¿ä¿®å¤å®ƒä»¬.å¦‚æœç»“æœé0ï¼Œå³ç¼–è¯‘æˆåŠŸã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">int[] compiled = new int[1]ï¼›</span><br><span class="line">GLES20.glGetShaderiv(iShader, GLES20.GL_COMPILE_STATUS, compiled, 0);</span><br><span class="line">        if (compiled[0] == 0) &#123;</span><br><span class="line">            Log.d(&quot;Load Shader Failed&quot;, &quot;Compilation\n&quot; + GLES20.glGetShaderInfoLog(iShader));</span><br><span class="line">            return 0;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>ç‰‡å…ƒç€è‰²å™¨çš„åˆ›å»ºå’Œé¡¶ç‚¹ä¸€æ ·ï¼ŒçŸ¥è¯†å‚æ•°ä¸åŒå’Œæºç ä¸åŒã€‚å‚æ•°ç±»å‹æ˜¯GLES20.GL_FRAGMENT_SHADER</p>
<h3 id="ç€è‰²å™¨ç¨‹åº"><a href="#ç€è‰²å™¨ç¨‹åº" class="headerlink" title="ç€è‰²å™¨ç¨‹åº"></a>ç€è‰²å™¨ç¨‹åº</h3><p>é€šè¿‡glCreateProgramå‡½æ•°åˆ›å»ºä¸€ä¸ªç¨‹åºï¼Œå¹¶è¿”å›æ–°åˆ›å»ºç¨‹åºå¯¹è±¡çš„IDå¼•ç”¨ï¼Œç„¶åæˆ‘ä»¬éœ€è¦æŠŠä¹‹å‰ç¼–è¯‘çš„ç€è‰²å™¨é™„åŠ åˆ°ç¨‹åºå¯¹è±¡ä¸Šï¼Œæœ€åç”¨glLinkProgramé“¾æ¥å®ƒä»¬ã€‚ç€è‰²å™¨å¯¹è±¡é“¾æ¥åˆ°ç¨‹åºå¯¹è±¡ä»¥åï¼Œåˆ é™¤ç€è‰²å™¨å¯¹è±¡ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">// åˆ›å»ºç¨‹åº,è¿”å›å¯¹è±¡çš„ID</span><br><span class="line">iProgId = GLES20.glCreateProgram();</span><br><span class="line">// å‘ç¨‹åºä¸­åŠ å…¥é¡¶ç‚¹ç€è‰²å™¨</span><br><span class="line">GLES20.glAttachShader(iProgId, iVShader);</span><br><span class="line">// å‘ç¨‹åºä¸­åŠ å…¥ç‰‡å…ƒç€è‰²å™¨</span><br><span class="line">GLES20.glAttachShader(iProgId, iFShader);</span><br><span class="line">// é“¾æ¥ç¨‹åº</span><br><span class="line">GLES20.glLinkProgram(iProgId);</span><br><span class="line">// è·å–programçš„é“¾æ¥æƒ…å†µ</span><br><span class="line">GLES20.glGetProgramiv(iProgId, GLES20.GL_LINK_STATUS, link, 0);</span><br><span class="line">if (link[0] &lt;= 0) &#123;</span><br><span class="line">    Log.d(&quot;Load Program&quot;, &quot;Linking Failed&quot;);</span><br><span class="line">    return 0;</span><br><span class="line">&#125;</span><br><span class="line">GLES20.glDeleteShader(iVShader);</span><br><span class="line">GLES20.glDeleteShader(iFShader);</span><br><span class="line">// è·å–ç€è‰²å™¨ä¸­çš„å±æ€§å¼•ç”¨id(ä¼ å…¥çš„å­—ç¬¦ä¸²å°±æ˜¯æˆ‘ä»¬ç€è‰²å™¨è„šæœ¬ä¸­çš„å±æ€§å)</span><br><span class="line">mGLAttribPosition = GLES20.glGetAttribLocation(mGLProgId, &quot;position&quot;);</span><br><span class="line">mGLUniformTexture = GLES20.glGetUniformLocation(mGLProgId, &quot;inputImageTexture&quot;);</span><br><span class="line">mGLAttribTextureCoordinate = GLES20.glGetAttribLocation(mGLProgId,</span><br><span class="line">                &quot;inputTextureCoordinate&quot;);</span><br><span class="line">//glClearColorä¸ºglClearæ¸…é™¤é¢œè‰²ç¼“å†²åŒºæ—¶æŒ‡å®šRGBAå€¼ï¼ˆä¹Ÿå°±æ˜¯æ‰€æœ‰çš„é¢œè‰²éƒ½ä¼šè¢«æ›¿æ¢æˆæŒ‡å®šçš„RGBAå€¼ï¼‰ã€‚æ¯ä¸ªå€¼çš„å–å€¼èŒƒå›´éƒ½æ˜¯0.0~1.0ï¼Œè¶…å‡ºèŒƒå›´çš„å°†è¢«æˆªæ–­ã€‚</span><br><span class="line">GLES20.glClearColor(0, 0, 0, 1);</span><br></pre></td></tr></table></figure>

<h3 id="çº¹ç†ID"><a href="#çº¹ç†ID" class="headerlink" title="çº¹ç†ID"></a>çº¹ç†ID</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">public static int loadTexture(final IntBuffer data, final Size size, final int usedTexId) &#123;</span><br><span class="line">        int textures[] = new int[1];</span><br><span class="line">        if (usedTexId == NO_TEXTURE) &#123;</span><br><span class="line">            GLES20.glGenTextures(1, textures, 0);</span><br><span class="line">            GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textures[0]);</span><br><span class="line">            GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,</span><br><span class="line">                    GLES20.GL_TEXTURE_MAG_FILTER, GLES20.GL_LINEAR);</span><br><span class="line">            GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,</span><br><span class="line">                    GLES20.GL_TEXTURE_MIN_FILTER, GLES20.GL_LINEAR);</span><br><span class="line">            GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,</span><br><span class="line">                    GLES20.GL_TEXTURE_WRAP_S, GLES20.GL_CLAMP_TO_EDGE);</span><br><span class="line">            GLES20.glTexParameterf(GLES20.GL_TEXTURE_2D,</span><br><span class="line">                    GLES20.GL_TEXTURE_WRAP_T, GLES20.GL_CLAMP_TO_EDGE);</span><br><span class="line">            GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGBA, size.width, size.height,</span><br><span class="line">                    0, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE, data);</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, usedTexId);</span><br><span class="line">            GLES20.glTexSubImage2D(GLES20.GL_TEXTURE_2D, 0, 0, 0, size.width,</span><br><span class="line">                    size.height, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE, data);</span><br><span class="line">            textures[0] = usedTexId;</span><br><span class="line">        &#125;</span><br><span class="line">        return textures[0];</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h3 id="ç»˜åˆ¶"><a href="#ç»˜åˆ¶" class="headerlink" title="ç»˜åˆ¶"></a>ç»˜åˆ¶</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">// ä½¿ç”¨æŸå¥—shaderç¨‹åº</span><br><span class="line">GLES20.glUseProgram(mGLProgId);</span><br><span class="line">// è®¾ç½®ç¼“å†²åŒºèµ·å§‹ä½ç½®</span><br><span class="line">cubeBuffer.position(0);</span><br><span class="line">// é¡¶ç‚¹ä½ç½®æ•°æ®ä¼ å…¥ç€è‰²å™¨,ä¸ºç”»ç¬”æŒ‡å®šé¡¶ç‚¹ä½ç½®æ•°æ®(mGLAttribPosition)</span><br><span class="line">GLES20.glVertexAttribPointer(mGLAttribPosition, 2, GLES20.GL_FLOAT, false, 0, cubeBuffer);</span><br><span class="line">// å…è®¸ä½¿ç”¨é¡¶ç‚¹åæ ‡æ•°ç»„</span><br><span class="line">GLES20.glEnableVertexAttribArray(mGLAttribPosition);</span><br><span class="line">textureBuffer.position(0);</span><br><span class="line">// çº¹ç†åæ ‡æ•°æ®ä¼ å…¥ç€è‰²å™¨,ä¸ºç”»ç¬”æŒ‡å®šçº¹ç†æ•°æ®</span><br><span class="line">GLES20.glVertexAttribPointer(mGLAttribTextureCoordinate, 2, GLES20.GL_FLOAT, false, 0,</span><br><span class="line">        textureBuffer);</span><br><span class="line">GLES20.glEnableVertexAttribArray(mGLAttribTextureCoordinate);</span><br><span class="line">if (textureId != OpenGlUtils.NO_TEXTURE) &#123;</span><br><span class="line">	//è®¾ç½®çº¹ç†å•å…ƒ(sampler2D)</span><br><span class="line">    GLES20.glActiveTexture(GLES20.GL_TEXTURE0);</span><br><span class="line">    GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, textureId);</span><br><span class="line">    //è®¾ç½®uniformé‡‡æ ·å™¨çš„ä½ç½®å€¼, ä¹Ÿå°±æ˜¯mGLUniformTextureçº¹ç†å•å…ƒã€‚</span><br><span class="line">    GLES20.glUniform1i(mGLUniformTexture, 0);</span><br><span class="line">&#125;</span><br><span class="line">onDrawArraysPre();</span><br><span class="line">//// ç»˜åˆ¶</span><br><span class="line">GLES20.glDrawArrays(GLES20.GL_TRIANGLE_STRIP, 0, 4);</span><br><span class="line">GLES20.glDisableVertexAttribArray(mGLAttribPosition);</span><br><span class="line">GLES20.glDisableVertexAttribArray(mGLAttribTextureCoordinate);</span><br></pre></td></tr></table></figure>

<h3 id="æ»¤é•œçº¹ç†"><a href="#æ»¤é•œçº¹ç†" class="headerlink" title="æ»¤é•œçº¹ç†"></a>æ»¤é•œçº¹ç†</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"> protected void onDrawArraysPre() &#123;</span><br><span class="line">    if (mToneCurveTexture[0] != OpenGlUtils.NO_TEXTURE) &#123;</span><br><span class="line">        GLES20.glActiveTexture(GLES20.GL_TEXTURE3);</span><br><span class="line">        GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mToneCurveTexture[0]);</span><br><span class="line">        GLES20.glUniform1i(mToneCurveTextureUniformLocation, 3);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é€šè¿‡ä¸Šè¿°ä»£ç å°±å¯ä»¥å®ç°çº¹ç†æ»¤é•œçš„æ•ˆæœäº†ã€‚ä½†æ˜¯è¿™ä¸ªæ»¤é•œçš„çº¹ç†æ˜¯å¦‚ä½•è·å–åˆ°çš„å‘¢ï¼Ÿ<br>ç®€å•ä»‹ç»ä¸¤ç§æ–¹å¼ï¼š</p>
<h4 id="ps-acv-æ–‡ä»¶"><a href="#ps-acv-æ–‡ä»¶" class="headerlink" title="ps acv æ–‡ä»¶"></a>ps acv æ–‡ä»¶</h4><p>acvæ–‡ä»¶æ˜¯psç”¨æ¥è®¾ç½®æ›²çº¿æ•ˆæœï¼Œä¸åŒæ›²çº¿å‚æ•°å¯ä»¥å‘ˆç°å‡ºä¸åŒçš„æ»¤é•œæ•ˆæœã€‚æˆ‘ä»¬å¯ä»¥å¯¹acvæ–‡ä»¶è¿›è¡Œè¯»å–ï¼Œå¯ä»¥å¾—åˆ°ï¼šCurvesæ›²çº¿ä¿¡æ¯æ•°ç»„ï¼Œæ¯ä¸ªcurverså¯ä»¥åˆ†åˆ«è·å–åˆ°R,G,B çš„PointFæ•°ç»„ä¿¡æ¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line">public void setFromCurveFileInputStream(InputStream input) &#123;</span><br><span class="line">    try &#123;</span><br><span class="line">        int version = readShort(input);</span><br><span class="line">        int totalCurves = readShort(input);</span><br><span class="line">        ArrayList&lt;PointF[]&gt; curves = new ArrayList&lt;PointF[]&gt;(totalCurves);</span><br><span class="line">        float pointRate = 1.0f / 255;</span><br><span class="line"></span><br><span class="line">        for (int i = 0; i &lt; totalCurves; i++) &#123;</span><br><span class="line">            // 2 bytes, Count of points in the curve (short integer from 2...19)</span><br><span class="line">            short pointCount = readShort(input);</span><br><span class="line">            PointF[] points = new PointF[pointCount];</span><br><span class="line">            // point count * 4</span><br><span class="line">            // Curve points. Each curve point is a pair of short integers where</span><br><span class="line">            // the first number is the output value (vertical coordinate on the</span><br><span class="line">            // Curves dialog graph) and the second is the input value. All coordinates have range 0 to 255.</span><br><span class="line">            for (int j = 0; j &lt; pointCount; j++) &#123;</span><br><span class="line">                short y = readShort(input);</span><br><span class="line">                short x = readShort(input);</span><br><span class="line"></span><br><span class="line">                points[j] = new PointF(x * pointRate, y * pointRate);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            curves.add(points);</span><br><span class="line">        &#125;</span><br><span class="line">        input.close();</span><br><span class="line"></span><br><span class="line">        mRgbCompositeControlPoints = curves.get(0);</span><br><span class="line">        mRedControlPoints = curves.get(1);</span><br><span class="line">        mGreenControlPoints = curves.get(2);</span><br><span class="line">        mBlueControlPoints = curves.get(3);</span><br><span class="line">    &#125; catch (IOException e) &#123;</span><br><span class="line">        e.printStackTrace();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæ ¹æ®RGBä¿¡æ¯ç”Ÿæˆçº¹ç†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"> // è®¾ç½®çº¹ç†å•å…ƒ</span><br><span class="line">GLES20.glActiveTexture(GLES20.GL_TEXTURE3);</span><br><span class="line">// ç»‘å®šçº¹ç†</span><br><span class="line">GLES20.glBindTexture(GLES20.GL_TEXTURE_2D, mToneCurveTexture[0]);</span><br><span class="line"></span><br><span class="line">if ((mRedCurve.size() &gt;= 256) &amp;&amp; (mGreenCurve.size() &gt;= 256) &amp;&amp; (mBlueCurve.size() &gt;= 256) &amp;&amp; (mRgbCompositeCurve.size() &gt;= 256)) &#123;</span><br><span class="line">    byte[] toneCurveByteArray = new byte[256 * 4];</span><br><span class="line">    for (int currentCurveIndex = 0; currentCurveIndex &lt; 256; currentCurveIndex++) &#123;</span><br><span class="line">        // BGRA for upload to texture</span><br><span class="line">        toneCurveByteArray[currentCurveIndex * 4 + 2] = (byte) ((int) Math.min(Math.max(currentCurveIndex + mBlueCurve.get(currentCurveIndex) + mRgbCompositeCurve.get(currentCurveIndex), 0), 255) &amp; 0xff);</span><br><span class="line">        toneCurveByteArray[currentCurveIndex * 4 + 1] = (byte) ((int) Math.min(Math.max(currentCurveIndex + mGreenCurve.get(currentCurveIndex) + mRgbCompositeCurve.get(currentCurveIndex), 0), 255) &amp; 0xff);</span><br><span class="line">        toneCurveByteArray[currentCurveIndex * 4] = (byte) ((int) Math.min(Math.max(currentCurveIndex + mRedCurve.get(currentCurveIndex) + mRgbCompositeCurve.get(currentCurveIndex), 0), 255) &amp; 0xff);</span><br><span class="line">        toneCurveByteArray[currentCurveIndex * 4 + 3] = (byte) (255 &amp; 0xff);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    GLES20.glTexImage2D(GLES20.GL_TEXTURE_2D, 0, GLES20.GL_RGBA, 256 /*width*/, 1 /*height*/, 0, GLES20.GL_RGBA, GLES20.GL_UNSIGNED_BYTE, ByteBuffer.wrap(toneCurveByteArray));</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="å›¾ç‰‡çº¹ç†"><a href="#å›¾ç‰‡çº¹ç†" class="headerlink" title="å›¾ç‰‡çº¹ç†"></a>å›¾ç‰‡çº¹ç†</h4><p>é€šè¿‡å›¾ç‰‡ç”Ÿæˆçº¹ç†ID,ä¹Ÿå°±æ˜¯æ»¤é•œå›¾ç‰‡ï¼šçœ‹ä¸€çœ‹èµ„æºæ–‡ä»¶ç›®å½•ä¿¡æ¯ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/çº¹ç†å›¾ç‰‡.png" alt title class>
                <p></p>
            </figure>

<p>ä¸‹é¢æ˜¯jsonå’Œç€è‰²å™¨æºç ï¼š</p>
<ul>
<li><p>json</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">    &quot;filterList&quot;: [&#123;</span><br><span class="line">        &quot;type&quot;: &quot;filter&quot;,</span><br><span class="line">        &quot;name&quot;: &quot;amaro&quot;,</span><br><span class="line">        &quot;vertexShader&quot;: &quot;&quot;,</span><br><span class="line">        &quot;fragmentShader&quot;: &quot;fragment.glsl&quot;,</span><br><span class="line">        &quot;uniformList&quot;:[&quot;blowoutTexture&quot;, &quot;overlayTexture&quot;, &quot;mapTexture&quot;],</span><br><span class="line">        &quot;uniformData&quot;: &#123;</span><br><span class="line">            &quot;blowoutTexture&quot;: &quot;blowout.png&quot;,</span><br><span class="line">            &quot;overlayTexture&quot;: &quot;overlay.png&quot;,</span><br><span class="line">            &quot;mapTexture&quot;: &quot;map.png&quot;</span><br><span class="line">        &#125;,</span><br><span class="line">        &quot;strength&quot;: 1.0,</span><br><span class="line">        &quot;texelOffset&quot;: 0,</span><br><span class="line">        &quot;audioPath&quot;: &quot;&quot;,</span><br><span class="line">        &quot;audioLooping&quot;: 1</span><br><span class="line">    &#125;]</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>fragment.glslå†…å®¹</p>
</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">precision mediump float;</span><br><span class="line"> </span><br><span class="line">varying mediump vec2 textureCoordinate;</span><br><span class="line"> </span><br><span class="line">uniform sampler2D inputTexture;</span><br><span class="line">uniform sampler2D blowoutTexture; //blowout;</span><br><span class="line">uniform sampler2D overlayTexture; //overlay;</span><br><span class="line">uniform sampler2D mapTexture; //map</span><br><span class="line"> </span><br><span class="line">uniform float strength;</span><br><span class="line"></span><br><span class="line">void main()</span><br><span class="line">&#123;</span><br><span class="line">    vec4 originColor = texture2D(inputTexture, textureCoordinate.xy);</span><br><span class="line">    vec4 texel = texture2D(inputTexture, textureCoordinate.xy);</span><br><span class="line">    vec3 bbTexel = texture2D(blowoutTexture, textureCoordinate.xy).rgb;</span><br><span class="line"></span><br><span class="line">    texel.r = texture2D(overlayTexture, vec2(bbTexel.r, texel.r)).r;</span><br><span class="line">    texel.g = texture2D(overlayTexture, vec2(bbTexel.g, texel.g)).g;</span><br><span class="line">    texel.b = texture2D(overlayTexture, vec2(bbTexel.b, texel.b)).b;</span><br><span class="line"></span><br><span class="line">    vec4 mapped;</span><br><span class="line">    mapped.r = texture2D(mapTexture, vec2(texel.r, 0.16666)).r;</span><br><span class="line">    mapped.g = texture2D(mapTexture, vec2(texel.g, 0.5)).g;</span><br><span class="line">    mapped.b = texture2D(mapTexture, vec2(texel.b, 0.83333)).b;</span><br><span class="line">    mapped.a = 1.0;</span><br><span class="line"></span><br><span class="line">    mapped.rgb = mix(originColor.rgb, mapped.rgb, strength);</span><br><span class="line"></span><br><span class="line">    gl_FragColor = mapped;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ•ˆæœå›¾"><a href="#æ•ˆæœå›¾" class="headerlink" title="æ•ˆæœå›¾"></a>æ•ˆæœå›¾</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/æ•ˆæœå›¾.jpg" alt title class>
                <p></p>
            </figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">static final float TEXTURE[] = &#123;</span><br><span class="line">            0.0f, 1.0f,</span><br><span class="line">            1.0f, 1.0f,</span><br><span class="line">            0.0f, 0.0f,</span><br><span class="line">            1.0f, 0.0f,</span><br><span class="line">    &#125;;</span><br></pre></td></tr></table></figure>

<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/æ­£ç¡®çº¹ç†.png" alt title class>
                <p></p>
            </figure>

<h3 id="æ¸²æŸ“æµç¨‹æ€»ç»“"><a href="#æ¸²æŸ“æµç¨‹æ€»ç»“" class="headerlink" title="æ¸²æŸ“æµç¨‹æ€»ç»“"></a>æ¸²æŸ“æµç¨‹æ€»ç»“</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/13/GPUImageæ¸²æŸ“æµç¨‹è§£æ/æ¸²æŸ“æµç¨‹.png" alt title class>
                <p></p>
            </figure>
<p>æŸ“æµç¨‹å¦‚ä¸‹ï¼šé¡¶ç‚¹æ•°æ®(Vertices) &gt; é¡¶ç‚¹ç€è‰²å™¨(Vertex Shader) &gt; å›¾å…ƒè£…é…(Assembly) &gt; å‡ ä½•ç€è‰²å™¨(Geometry Shader) &gt; å…‰æ …åŒ–(Rasterization) &gt; ç‰‡å…ƒç€è‰²å™¨(Fragment Shader) &gt; é€ç‰‡å…ƒå¤„ç†(Per-Fragment Operations) &gt; å¸§ç¼“å†²(FrameBuffer)ã€‚å†ç»è¿‡åŒç¼“å†²çš„äº¤æ¢(SwapBuffer)ï¼Œæ¸²æŸ“å†…å®¹å°±æ˜¾ç¤ºåˆ°äº†å±å¹•ä¸Šã€‚</p>
<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ ¹æ®æ¸²æŸ“æµç¨‹ï¼Œæˆ‘ä»¬çŸ¥é“ï¼Œç¾é¢œçš„æ“ä½œå³æ˜¯å¯¹ç€è‰²å™¨ç¼–ç çš„æºç è¿›è¡Œç¼–å†™ã€‚é‡‡ç”¨ä¸åŒçš„ç®—æ³•ï¼Œå®ç°ä¸åŒçš„ç¾é¢œåŠŸèƒ½ã€‚åŒæ—¶æ»¤é•œçš„çº¹ç†ï¼Œå¯ä»¥æ˜¯psçš„acvæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯å›¾ç‰‡ï¼Œç€è‰²å™¨æºç é’ˆå¯¹ä¸åŒçš„ èµ„æºåˆ†åˆ«è§£æå’Œä½¿ç”¨ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://juejin.im/post/6844903878740148231#heading-0" target="_blank" rel="noopener">OpenGL ES</a></p>
<p><a href="https://www.cnblogs.com/zhxmdefj/p/11192408.html" target="_blank" rel="noopener">OpenGLå…¥é—¨1.2ï¼šæ¸²æŸ“ç®¡çº¿ç®€ä»‹ï¼Œç”»ä¸‰è§’å½¢</a></p>
<p><a href="https://blog.csdn.net/dengchukun/category_9281212.html" target="_blank" rel="noopener">GLES2.0ä¸­æ–‡API</a></p>
<p><a href="https://www.jianshu.com/p/cb55d8f2b4d0" target="_blank" rel="noopener">OpenGLES ç»˜åˆ¶å›¾ç‰‡çº¹ç†</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> FaceUnity </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[ç¾é¢œç›¸å…³æ¦‚å¿µ]]></title>
      <url>/2020/08/05/%E7%BE%8E%E9%A2%9C%E7%9B%B8%E5%85%B3%E6%A6%82%E5%BF%B5/</url>
      <content type="html"><![CDATA[<h2 id="å›¾åƒæ·±åº¦-amp-åƒç´ æ·±åº¦"><a href="#å›¾åƒæ·±åº¦-amp-åƒç´ æ·±åº¦" class="headerlink" title="å›¾åƒæ·±åº¦&amp;åƒç´ æ·±åº¦"></a>å›¾åƒæ·±åº¦&amp;åƒç´ æ·±åº¦</h2><p>å›¾åƒæ·±åº¦æ˜¯æŒ‡å­˜å‚¨æ¯ä¸ªåƒç´ æ‰€ç”¨çš„ä½æ•°ï¼Œå®ƒä¹Ÿæ˜¯ç”¨æ¥åº¦é‡å›¾åƒçš„è‰²å½©åˆ†è¾¨ç‡çš„ã€‚å®ƒç¡®å®šäº†å½©è‰²å›¾åƒçš„æ¯ä¸ªåƒç´ å¯èƒ½æœ‰çš„è‰²å½©æ•°ï¼Œæˆ–è€…ç¡®å®šç°åº¦å›¾åƒçš„æ¯ä¸ªåƒç´ å¯èƒ½æœ‰çš„ç°åº¦çº§æ•°ã€‚å®ƒå†³å®šäº†è‰²å½©å›¾åƒä¸­å¯èƒ½å‡ºç°çš„æœ€å¤šçš„è‰²å½©æ•°ï¼Œæˆ–è€…ç°åº¦å›¾åƒä¸­çš„æœ€å¤§ç°åº¦ç­‰çº§ã€‚ </p>
<p>ä¸­æ–‡å        å›¾åƒæ·±åº¦<br>ç‰¹    ç‚¹    é‡åº¦å›¾åƒçš„è‰²å½©åˆ†è¾¨ç‡<br>å«    ä¹‰    æŒ‡å­˜å‚¨æ¯ä¸ªåƒç´ æ‰€ç”¨çš„ä½æ•°<br>ç±»    å‹    ç¡®å®šå½©è‰²å›¾åƒé¢œè‰²æ•°<br>1.åŸºæœ¬æ¦‚å¿µ<br>å›¾åƒæ·±åº¦æ˜¯å•ä¸ªåƒç´ ç‚¹çš„è‰²å½©è¯¦ç»†åº¦,å¦‚16ä½(65536è‰²),32ä½ç­‰ã€‚æ¯”å¦‚ä¸€å¹…å•è‰²å›¾åƒ,è‹¥æ¯ä¸ªåƒç´ æœ‰8ä½,åˆ™æœ€å¤§ç°åº¦æ•°ç›®ä¸º2çš„8æ¬¡æ–¹,å³256.ä¸€å¹…å½©è‰²å›¾åƒRGB3ä¸ªæ¸©è‰¯çš„åƒç´ ä½æ•°åˆ†åˆ«ä¸º4,4,2,åˆ™æœ€å¤§é¢œè‰²æ•°ç›®ä¸º2çš„4+4+2æ¬¡æ–¹,å³1024,å°±æ˜¯è¯´åƒç´ çš„æ·±åº¦ä¸º10ä½,æ¯ä¸ªåƒç´ å¯ä»¥æ˜¯1024ç§é¢œè‰²ä¸­çš„ä¸€ç§ï¼Œä¾‹å¦‚ï¼šä¸€å¹…ç”»çš„å°ºå¯¸æ˜¯1024*768ï¼Œæ·±åº¦ä¸º16ï¼Œåˆ™å®ƒçš„æ•°æ®é‡ä¸º1.5Mã€‚</p>
<h2 id="å·ç§¯"><a href="#å·ç§¯" class="headerlink" title="å·ç§¯"></a>å·ç§¯</h2><h3 id="çº¿æ€§æ»¤æ³¢ä¸å·ç§¯çš„åŸºæœ¬æ¦‚å¿µ"><a href="#çº¿æ€§æ»¤æ³¢ä¸å·ç§¯çš„åŸºæœ¬æ¦‚å¿µ" class="headerlink" title="çº¿æ€§æ»¤æ³¢ä¸å·ç§¯çš„åŸºæœ¬æ¦‚å¿µ"></a>çº¿æ€§æ»¤æ³¢ä¸å·ç§¯çš„åŸºæœ¬æ¦‚å¿µ</h3><p><a href="https://www.cnblogs.com/xiaojianliu/p/9075872.html" target="_blank" rel="noopener">æ•°å­—å›¾åƒå¤„ç†ä¸­æ»¤æ³¢å’Œå·ç§¯æ“ä½œè¯¦ç»†è¯´æ˜</a> </p>
<p>çº¿æ€§æ»¤æ³¢å¯ä»¥è¯´æ˜¯å›¾åƒå¤„ç†æœ€åŸºæœ¬çš„æ–¹æ³•ï¼Œå®ƒå¯ä»¥å…è®¸æˆ‘ä»¬å¯¹å›¾åƒè¿›è¡Œå¤„ç†ï¼Œäº§ç”Ÿå¾ˆå¤šä¸åŒçš„æ•ˆæœã€‚åšæ³•å¾ˆç®€å•ã€‚é¦–å…ˆï¼Œæˆ‘ä»¬æœ‰ä¸€ä¸ªäºŒç»´çš„æ»¤æ³¢å™¨çŸ©é˜µï¼ˆæœ‰ä¸ªé«˜å¤§ä¸Šçš„åå­—å«å·ç§¯æ ¸ï¼‰å’Œä¸€ä¸ªè¦å¤„ç†çš„äºŒç»´å›¾åƒã€‚ç„¶åï¼Œå¯¹äºå›¾åƒçš„æ¯ä¸€ä¸ªåƒç´ ç‚¹ï¼Œè®¡ç®—å®ƒçš„é‚»åŸŸåƒç´ å’Œæ»¤æ³¢å™¨çŸ©é˜µçš„å¯¹åº”å…ƒç´ çš„ä¹˜ç§¯ï¼Œç„¶ååŠ èµ·æ¥ï¼Œä½œä¸ºè¯¥åƒç´ ä½ç½®çš„å€¼ã€‚è¿™æ ·å°±å®Œæˆäº†æ»¤æ³¢è¿‡ç¨‹ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/05/ç¾é¢œç›¸å…³æ¦‚å¿µ/å·ç§¯.png" alt title class>
                <p></p>
            </figure>
<p>å¯¹å›¾åƒå’Œæ»¤æ³¢çŸ©é˜µè¿›è¡Œé€ä¸ªå…ƒç´ ç›¸ä¹˜å†æ±‚å’Œçš„æ“ä½œå°±ç›¸å½“äºå°†ä¸€ä¸ªäºŒç»´çš„å‡½æ•°ç§»åŠ¨åˆ°å¦ä¸€ä¸ªäºŒç»´å‡½æ•°çš„æ‰€æœ‰ä½ç½®ï¼Œè¿™ä¸ªæ“ä½œå°±å«å·ç§¯æˆ–è€…åç›¸å…³ã€‚å·ç§¯å’Œåç›¸å…³çš„å·®åˆ«æ˜¯ï¼Œå·ç§¯éœ€è¦å…ˆå¯¹æ»¤æ³¢çŸ©é˜µè¿›è¡Œ180çš„ç¿»è½¬ï¼Œä½†å¦‚æœçŸ©é˜µæ˜¯å¯¹ç§°çš„ï¼Œé‚£ä¹ˆä¸¤è€…å°±æ²¡æœ‰ä»€ä¹ˆå·®åˆ«äº†ã€‚</p>
<p> Correlation å’Œ Convolutionå¯ä»¥è¯´æ˜¯å›¾åƒå¤„ç†æœ€åŸºæœ¬çš„æ“ä½œï¼Œä½†å´éå¸¸æœ‰ç”¨ã€‚è¿™ä¸¤ä¸ªæ“ä½œæœ‰ä¸¤ä¸ªéå¸¸å…³é”®çš„ç‰¹ç‚¹ï¼šå®ƒä»¬æ˜¯çº¿æ€§çš„ï¼Œè€Œä¸”å…·æœ‰å¹³ç§»ä¸å˜æ€§shift-invariantã€‚å¹³ç§»ä¸å˜æ€§æŒ‡æˆ‘ä»¬åœ¨å›¾åƒçš„æ¯ä¸ªä½ç½®éƒ½æ‰§è¡Œç›¸åŒçš„æ“ä½œã€‚çº¿æ€§æŒ‡è¿™ä¸ªæ“ä½œæ˜¯çº¿æ€§çš„ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬ç”¨æ¯ä¸ªåƒç´ çš„é‚»åŸŸçš„çº¿æ€§ç»„åˆæ¥ä»£æ›¿è¿™ä¸ªåƒç´ ã€‚è¿™ä¸¤ä¸ªå±æ€§ä½¿å¾—è¿™ä¸ªæ“ä½œéå¸¸ç®€å•ï¼Œå› ä¸ºçº¿æ€§æ“ä½œæ˜¯æœ€ç®€å•çš„ï¼Œç„¶ååœ¨æ‰€æœ‰åœ°æ–¹éƒ½åšåŒæ ·çš„æ“ä½œå°±æ›´ç®€å•äº†ã€‚</p>
<ul>
<li><p>å®é™…ä¸Šï¼Œåœ¨ä¿¡å·å¤„ç†é¢†åŸŸï¼Œå·ç§¯æœ‰å¹¿æ³›çš„æ„ä¹‰ï¼Œè€Œä¸”æœ‰å…¶ä¸¥æ ¼çš„æ•°å­¦å®šä¹‰ï¼Œä½†åœ¨è¿™é‡Œä¸å…³æ³¨è¿™ä¸ªã€‚</p>
</li>
<li><p>2Då·ç§¯éœ€è¦4ä¸ªåµŒå¥—å¾ªç¯4-double loopï¼Œæ‰€ä»¥å®ƒå¹¶ä¸å¿«ï¼Œé™¤éæˆ‘ä»¬ä½¿ç”¨å¾ˆå°çš„å·ç§¯æ ¸ã€‚è¿™é‡Œä¸€èˆ¬ä½¿ç”¨3x3æˆ–è€…5x5ã€‚è€Œä¸”ï¼Œå¯¹äºæ»¤æ³¢å™¨ï¼Œä¹Ÿæœ‰ä¸€å®šçš„è§„åˆ™è¦æ±‚ï¼š</p>
<p>1ï¼‰æ»¤æ³¢å™¨çš„å¤§å°åº”è¯¥æ˜¯å¥‡æ•°ï¼Œè¿™æ ·å®ƒæ‰æœ‰ä¸€ä¸ªä¸­å¿ƒï¼Œä¾‹å¦‚3x3ï¼Œ5x5æˆ–è€…7x7ã€‚æœ‰ä¸­å¿ƒäº†ï¼Œä¹Ÿæœ‰äº†åŠå¾„çš„ç§°å‘¼ï¼Œä¾‹å¦‚5x5å¤§å°çš„æ ¸çš„åŠå¾„å°±æ˜¯2ã€‚</p>
<p>2ï¼‰æ»¤æ³¢å™¨çŸ©é˜µæ‰€æœ‰çš„å…ƒç´ ä¹‹å’Œåº”è¯¥è¦ç­‰äº1ï¼Œè¿™æ˜¯ä¸ºäº†ä¿è¯æ»¤æ³¢å‰åå›¾åƒçš„äº®åº¦ä¿æŒä¸å˜ã€‚å½“ç„¶äº†ï¼Œè¿™ä¸æ˜¯ç¡¬æ€§è¦æ±‚äº†ã€‚</p>
<p>3ï¼‰å¦‚æœæ»¤æ³¢å™¨çŸ©é˜µæ‰€æœ‰å…ƒç´ ä¹‹å’Œå¤§äº1ï¼Œé‚£ä¹ˆæ»¤æ³¢åçš„å›¾åƒå°±ä¼šæ¯”åŸå›¾åƒæ›´äº®ï¼Œåä¹‹ï¼Œå¦‚æœå°äº1ï¼Œé‚£ä¹ˆå¾—åˆ°çš„å›¾åƒå°±ä¼šå˜æš—ã€‚å¦‚æœå’Œä¸º0ï¼Œå›¾åƒä¸ä¼šå˜é»‘ï¼Œä½†ä¹Ÿä¼šéå¸¸æš—ã€‚</p>
<p>4ï¼‰å¯¹äºæ»¤æ³¢åçš„ç»“æ„ï¼Œå¯èƒ½ä¼šå‡ºç°è´Ÿæ•°æˆ–è€…å¤§äº255çš„æ•°å€¼ã€‚å¯¹è¿™ç§æƒ…å†µï¼Œæˆ‘ä»¬å°†ä»–ä»¬ç›´æ¥æˆªæ–­åˆ°0å’Œ255ä¹‹é—´å³å¯ã€‚å¯¹äºè´Ÿæ•°ï¼Œä¹Ÿå¯ä»¥å–ç»å¯¹å€¼ã€‚</p>
</li>
</ul>
<h3 id="è¾¹ç•Œè¡¥å……æ–¹æ³•"><a href="#è¾¹ç•Œè¡¥å……æ–¹æ³•" class="headerlink" title="è¾¹ç•Œè¡¥å……æ–¹æ³•"></a>è¾¹ç•Œè¡¥å……æ–¹æ³•</h3><p>ä¸Šé¢çš„å›¾ç‰‡è¯´æ˜äº†å›¾åƒçš„å·ç§¯æ“ä½œï¼Œä½†æ˜¯ä»–ä¹Ÿåæ˜ å‡ºä¸€ä¸ªé—®é¢˜ï¼Œå¦‚ä¸Šå›¾ï¼ŒåŸå§‹å›¾ç‰‡å°ºå¯¸ä¸º7<em>7ï¼Œå·ç§¯æ ¸çš„å¤§å°ä¸º3</em>3ï¼Œå½“å·ç§¯æ ¸æ²¿ç€å›¾ç‰‡æ»‘åŠ¨ååªèƒ½æ»‘åŠ¨å‡ºä¸€ä¸ª5*5çš„å›¾ç‰‡å‡ºæ¥ï¼Œè¿™å°±é€ æˆäº†å·ç§¯åçš„å›¾ç‰‡å’Œå·ç§¯å‰çš„å›¾ç‰‡å°ºå¯¸ä¸ä¸€è‡´ï¼Œè¿™æ˜¾ç„¶ä¸æ˜¯æˆ‘ä»¬æƒ³è¦çš„ç»“æœï¼Œæ‰€ä»¥ä¸ºäº†é¿å…è¿™ç§æƒ…å†µï¼Œéœ€è¦å…ˆå¯¹åŸå§‹å›¾ç‰‡åšè¾¹ç•Œå¡«å……å¤„ç†ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/05/ç¾é¢œç›¸å…³æ¦‚å¿µ/å¡«å…….png" alt title class>
                <p></p>
            </figure>
<h4 id="å¸¸ç”¨å·ç§¯æ ¸åŠå…¶æ„ä¹‰"><a href="#å¸¸ç”¨å·ç§¯æ ¸åŠå…¶æ„ä¹‰" class="headerlink" title="å¸¸ç”¨å·ç§¯æ ¸åŠå…¶æ„ä¹‰"></a>å¸¸ç”¨å·ç§¯æ ¸åŠå…¶æ„ä¹‰</h4><h5 id="ä¸€ä¸ªæ²¡æœ‰ä»»ä½•ä½œç”¨çš„å·ç§¯æ ¸"><a href="#ä¸€ä¸ªæ²¡æœ‰ä»»ä½•ä½œç”¨çš„å·ç§¯æ ¸" class="headerlink" title="ä¸€ä¸ªæ²¡æœ‰ä»»ä½•ä½œç”¨çš„å·ç§¯æ ¸"></a>ä¸€ä¸ªæ²¡æœ‰ä»»ä½•ä½œç”¨çš„å·ç§¯æ ¸</h5><p>å·ç§¯æ ¸ï¼š<br>è¿™é‡Œå†™å›¾ç‰‡æè¿°<br>å°†åŸåƒç´ ä¸­é—´åƒç´ å€¼ä¹˜1ï¼Œå…¶ä½™å…¨éƒ¨ä¹˜0ï¼Œæ˜¾ç„¶åƒç´ å€¼ä¸ä¼šå‘ç”Ÿä»»ä½•å˜åŒ–ã€‚</p>
<h5 id="å¹³æ»‘å‡å€¼æ»¤æ³¢"><a href="#å¹³æ»‘å‡å€¼æ»¤æ³¢" class="headerlink" title="å¹³æ»‘å‡å€¼æ»¤æ³¢"></a>å¹³æ»‘å‡å€¼æ»¤æ³¢</h5><p>å·ç§¯æ ¸ï¼š<br>è¿™é‡Œå†™å›¾ç‰‡æè¿°<br>è¯¥å·ç§¯æ ¸çš„ä½œç”¨åœ¨äºå–ä¹ä¸ªå€¼çš„å¹³å‡å€¼ä»£æ›¿ä¸­é—´åƒç´ å€¼ï¼Œæ‰€ä»¥èµ·åˆ°çš„å¹³æ»‘çš„æ•ˆæœï¼šã€‚</p>
<h5 id="é«˜æ–¯å¹³æ»‘"><a href="#é«˜æ–¯å¹³æ»‘" class="headerlink" title="é«˜æ–¯å¹³æ»‘"></a>é«˜æ–¯å¹³æ»‘</h5><p>å·ç§¯æ ¸ï¼š<br>è¿™é‡Œå†™å›¾ç‰‡æè¿°<br>é«˜æ–¯å¹³æ»‘æ°´å¹³å’Œå‚ç›´æ–¹å‘å‘ˆç°é«˜æ–¯åˆ†å¸ƒï¼Œæ›´çªå‡ºäº†ä¸­å¿ƒç‚¹åœ¨åƒç´ å¹³æ»‘åçš„æƒé‡ï¼Œç›¸æ¯”äºå‡å€¼æ»¤æ³¢è€Œè¨€ï¼Œæœ‰ç€æ›´å¥½çš„å¹³æ»‘æ•ˆæœã€‚ </p>
<h5 id="å›¾åƒé”åŒ–"><a href="#å›¾åƒé”åŒ–" class="headerlink" title="å›¾åƒé”åŒ–"></a>å›¾åƒé”åŒ–</h5><p>å·ç§¯æ ¸ï¼š </p>
<p>è¯¥å·ç§¯åˆ©ç”¨çš„å…¶å®æ˜¯å›¾åƒä¸­çš„è¾¹ç¼˜ä¿¡æ¯æœ‰ç€æ¯”å‘¨å›´åƒç´ æ›´é«˜çš„å¯¹æ¯”åº¦ï¼Œè€Œç»è¿‡å·ç§¯ä¹‹åè¿›ä¸€æ­¥å¢å¼ºäº†è¿™ç§å¯¹æ¯”åº¦ï¼Œä»è€Œä½¿å›¾åƒæ˜¾å¾—æ£±è§’åˆ†æ˜ã€ç”»é¢æ¸…æ™°ï¼Œèµ·åˆ°é”åŒ–å›¾åƒçš„æ•ˆæœã€‚ </p>
<h5 id="æ¢¯åº¦Prewitt"><a href="#æ¢¯åº¦Prewitt" class="headerlink" title="æ¢¯åº¦Prewitt"></a>æ¢¯åº¦Prewitt</h5><p>æ¢¯åº¦Prewittå·ç§¯æ ¸ä¸Sobleå·ç§¯æ ¸çš„é€‰å®šæ˜¯ç±»ä¼¼çš„ï¼Œéƒ½æ˜¯å¯¹æ°´å¹³è¾¹ç¼˜æˆ–å‚ç›´è¾¹ç¼˜æœ‰æ¯”è¾ƒå¥½çš„æ£€æµ‹æ•ˆæœã€‚</p>
<h5 id="Sobleè¾¹ç¼˜æ£€æµ‹ï¼š"><a href="#Sobleè¾¹ç¼˜æ£€æµ‹ï¼š" class="headerlink" title="Sobleè¾¹ç¼˜æ£€æµ‹ï¼š"></a>Sobleè¾¹ç¼˜æ£€æµ‹ï¼š</h5><p>Sobleä¸ä¸Šè¿°å·ç§¯æ ¸ä¸åŒä¹‹å¤„åœ¨äºï¼ŒSobleæ›´å¼ºè°ƒäº†å’Œè¾¹ç¼˜ç›¸é‚»çš„åƒç´ ç‚¹å¯¹è¾¹ç¼˜çš„å½±å“ã€‚ </p>
<h5 id="æ¢¯åº¦Laplacian"><a href="#æ¢¯åº¦Laplacian" class="headerlink" title="æ¢¯åº¦Laplacian"></a>æ¢¯åº¦Laplacian</h5><p>å·ç§¯æ ¸ï¼š<br>è¿™é‡Œå†™å›¾ç‰‡æè¿°</p>
<p>Laplacianä¹Ÿæ˜¯ä¸€ç§é”åŒ–æ–¹æ³•ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥åšè¾¹ç¼˜æ£€æµ‹ï¼Œè€Œä¸”è¾¹ç¼˜æ£€æµ‹çš„åº”ç”¨ä¸­å¹¶ä¸å±€é™äºæ°´å¹³æ–¹å‘æˆ–å‚ç›´æ–¹å‘ï¼Œè¿™æ˜¯Laplacianä¸sobleçš„åŒºåˆ«ã€‚</p>
<p>å›åˆ°ç›®å½•</p>
<h3 id="å·ç§¯çš„è®¡ç®—"><a href="#å·ç§¯çš„è®¡ç®—" class="headerlink" title="å·ç§¯çš„è®¡ç®—"></a>å·ç§¯çš„è®¡ç®—</h3><p>å¯¹å›¾åƒå¤„ç†è€Œè¨€ï¼Œå­˜åœ¨ä¸¤å¤§ç±»çš„æ–¹æ³•ï¼šç©ºåŸŸå¤„ç†å’Œé¢‘åŸŸå¤„ç†ï¼ç©ºåŸŸå¤„ç†æ˜¯æŒ‡ç›´æ¥å¯¹åŸå§‹çš„åƒç´ ç©ºé—´è¿›è¡Œè®¡ç®—ï¼Œé¢‘ç‡å¤„ç†æ˜¯æŒ‡å…ˆå¯¹å›¾åƒå˜æ¢åˆ°é¢‘åŸŸï¼Œå†åšæ»¤æ³¢ç­‰å¤„ç†ã€‚ </p>
<p>ç©ºåŸŸè®¡ç®—-ç›´æ¥2Då·ç§¯<br>ç›´æ¥2Då·ç§¯å°±æ˜¯ä¸€å¼€å§‹è¯´çš„é‚£æ ·ï¼Œå¯¹äºå›¾åƒçš„æ¯ä¸€ä¸ªåƒç´ ç‚¹ï¼Œè®¡ç®—å®ƒçš„é‚»åŸŸåƒç´ å’Œæ»¤æ³¢å™¨çŸ©é˜µçš„å¯¹åº”å…ƒç´ çš„ä¹˜ç§¯ï¼Œç„¶ååŠ èµ·æ¥ï¼Œä½œä¸ºè¯¥åƒç´ ä½ç½®çš„å€¼ã€‚</p>
<p>ç›´æ¥çš„å®ç°ä¹Ÿç§°ä¸ºæš´åŠ›å®ç°brute forceï¼Œå› ä¸ºå®ƒä¸¥æ ¼æŒ‰ç…§å®šä¹‰æ¥å®ç°ï¼Œæ²¡æœ‰ä»»ä½•ä¼˜åŒ–ã€‚å½“ç„¶äº†ï¼Œåœ¨å¹¶è¡Œå®ç°é‡Œé¢ï¼Œå®ƒä¹Ÿæ˜¯æ¯”è¾ƒçµæ´»çš„ã€‚å¦å¤–ï¼Œä¹Ÿå­˜åœ¨ä¸€ä¸ªä¼˜åŒ–ç‰ˆæœ¬ï¼Œå¦‚æœæˆ‘ä»¬çš„kernelæ˜¯separableå¯åˆ†çš„ã€‚</p>
<p>é¢‘åŸŸè®¡ç®—-å¿«é€Ÿå‚…é‡Œå¶å˜æ¢FFTå·ç§¯<br> è¿™ä¸ªå¿«é€Ÿå®ç°å¾—ç›Šäºå·ç§¯å®šç†ï¼šæ—¶åŸŸä¸Šçš„å·ç§¯ç­‰äºé¢‘åŸŸä¸Šçš„ä¹˜ç§¯ã€‚æ‰€ä»¥å°†æˆ‘ä»¬çš„å›¾åƒå’Œæ»¤æ³¢å™¨é€šè¿‡ç®—æ³•å˜æ¢åˆ°é¢‘åŸŸåï¼Œç›´æ¥å°†ä»–ä»¬ç›¸ä¹˜ï¼Œç„¶åå†å˜æ¢å›æ—¶åŸŸï¼ˆä¹Ÿå°±æ˜¯å›¾åƒçš„ç©ºåŸŸï¼‰å°±å¯ä»¥äº†ã€‚</p>
<p>oè¡¨ç¤ºçŸ©é˜µé€å…ƒç´ ç›¸ä¹˜ã€‚é‚£ç”¨ä»€ä¹ˆæ–¹æ³•å°†ç©ºåŸŸçš„å›¾åƒå’Œæ»¤æ³¢å™¨å˜æ¢åˆ°é¢‘åŸŸäº†ã€‚</p>
]]></content>
      
        <categories>
            
            <category> Video </category>
            
        </categories>
        
        
        <tags>
            
            <tag> FaceUnity </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android CMake]]></title>
      <url>/2020/08/05/Android-CMake/</url>
      <content type="html"><![CDATA[<h2 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h2><p>å‘æ‚¨çš„é¡¹ç›®æ·»åŠ  C å’Œ C++ ä»£ç ã€‚æä¾› CMake æˆ– ndk-build è„šæœ¬æ–‡ä»¶çš„è·¯å¾„ä»¥é…ç½® Gradleã€‚Gradle ä½¿ç”¨æ„å»ºè„šæœ¬å°†æºä»£ç å¯¼å…¥æ‚¨çš„ Android Studio é¡¹ç›®å¹¶å°†åŸç”Ÿåº“ï¼ˆSO æ–‡ä»¶ï¼‰æ‰“åŒ…åˆ° APK ä¸­ã€‚</p>
<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>CMakeæ˜¯ä¸€ä¸ªè·¨å¹³å°çš„å®‰è£…ï¼ˆç¼–è¯‘ï¼‰å·¥å…·ï¼Œå¯ä»¥ç”¨ç®€å•çš„è¯­å¥æ¥æè¿°æ‰€æœ‰å¹³æ‘Šçš„å®‰è£…ç¼–è¯‘è¿‡ç¨‹ã€‚å®ƒèƒ½å¤Ÿè¾“å‡ºå„ç§å„æ ·çš„makefileæˆ–è€…projectæ–‡ä»¶ï¼Œèƒ½æµ‹è¯•ç¼–è¯‘å™¨æ‰€æ”¯æŒçš„C++ç‰¹æ€§ï¼Œç±»ä¼¼UNIXä¸‹çš„automakeã€‚</p>
<h2 id="é…ç½®CMake-3-6-0-æˆ–-3-10-2"><a href="#é…ç½®CMake-3-6-0-æˆ–-3-10-2" class="headerlink" title="é…ç½®CMake 3.6.0 æˆ– 3.10.2"></a>é…ç½®CMake 3.6.0 æˆ– 3.10.2</h2><h3 id="CMake-3-6-0-æˆ–-3-10-2"><a href="#CMake-3-6-0-æˆ–-3-10-2" class="headerlink" title="CMake 3.6.0 æˆ– 3.10.2"></a>CMake 3.6.0 æˆ– 3.10.2</h3><p>SDK ç®¡ç†å™¨åŒ…å« CMake çš„ 3.6.0 æ´¾ç”Ÿç‰ˆæœ¬å’Œç‰ˆæœ¬ 3.10.2ã€‚æœªåœ¨ build.gradle ä¸­è®¾ç½®ç‰¹å®š CMake ç‰ˆæœ¬çš„é¡¹ç›®å‡ä½¿ç”¨ CMake 3.10.2 è¿›è¡Œæ„å»ºã€‚è¦ä½¿ç”¨ä¹‹å‰åŒ…å«çš„ç‰ˆæœ¬ï¼Œè¯·åœ¨æ¨¡å—çš„ build.gradle æ–‡ä»¶ä¸­æŒ‡å®š CMake ç‰ˆæœ¬ 3.6.0ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    externalNativeBuild &#123;</span><br><span class="line">        cmake &#123;</span><br><span class="line">            ...</span><br><span class="line">            version &quot;3.6.0&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ‚¨å¯ä»¥æŒ‡å®šæ­¤ CMake ç‰ˆæœ¬ä½œä¸ºæœ€ä½ç‰ˆæœ¬ï¼Œåªéœ€åœ¨ build.gradle æ¡ç›®çš„æœ«å°¾æ·»åŠ ä¸€ä¸ªâ€œ+â€å³å¯ï¼Œä¾‹å¦‚ 3.10.2+ã€‚ä¸è¿‡ï¼Œè¿™å¹¶éæœ€ä½³åšæ³•ã€‚</p>
<h3 id="ä½¿ç”¨è‡ªå®šä¹‰-CMake-ç‰ˆæœ¬"><a href="#ä½¿ç”¨è‡ªå®šä¹‰-CMake-ç‰ˆæœ¬" class="headerlink" title="ä½¿ç”¨è‡ªå®šä¹‰ CMake ç‰ˆæœ¬"></a>ä½¿ç”¨è‡ªå®šä¹‰ CMake ç‰ˆæœ¬</h3><p>å¦‚æœæ‚¨æƒ³ä½¿ç”¨ SDK ç®¡ç†å™¨ä¸­æœªåŒ…å«çš„ CMake ç‰ˆæœ¬ 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>
<p>1.ä»å®˜æ–¹ CMake ç½‘ç«™ä¸‹è½½å¹¶å®‰è£… <a href="https://cmake.org/download/" target="_blank" rel="noopener">CMake 3.7 æˆ–æ›´é«˜ç‰ˆæœ¬</a>ã€‚<br>2.æŒ‡å®šæ‚¨æƒ³è¦è®© Gradle åœ¨æ¨¡å—çš„ build.gradle æ–‡ä»¶ä¸­ä½¿ç”¨çš„ CMake ç‰ˆæœ¬ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    externalNativeBuild &#123;</span><br><span class="line">        cmake &#123;</span><br><span class="line">            ...</span><br><span class="line">            version &quot;cmake-version&quot;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>3.å°† CMake çš„å®‰è£…è·¯å¾„æ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ï¼Œæˆ–å°†å…¶æ·»åŠ åˆ°é¡¹ç›®çš„ local.properties æ–‡ä»¶ä¸­ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºã€‚å¦‚æœ Gradle æ‰¾ä¸åˆ°æ‚¨åœ¨ build.gradle æ–‡ä»¶ä¸­æŒ‡å®šçš„ CMake ç‰ˆæœ¬ï¼Œæ‚¨ä¾¿ä¼šé‡åˆ°æ„å»ºé”™è¯¯ã€‚<br>    # If you set this property, Gradle no longer uses PATH to find CMake.<br>    cmake.dir=â€path-to-cmakeâ€</p>
<p>4.å¦‚æœæ‚¨å°šæœªåœ¨å·¥ä½œç«™ä¸Šå®‰è£… Ninja æ„å»ºç³»ç»Ÿï¼Œè¯·è®¿é—® Ninja å®˜æ–¹ç½‘ç«™ï¼Œç„¶åä¸‹è½½å¹¶å®‰è£…é€‚ç”¨äºæ‚¨çš„æ“ä½œç³»ç»Ÿçš„æœ€æ–°ç‰ˆ Ninjaã€‚æ­¤å¤–ï¼Œè¯·åŠ¡å¿…å°† Ninja çš„å®‰è£…è·¯å¾„ä¹Ÿæ·»åŠ åˆ° PATH ç¯å¢ƒå˜é‡ã€‚</p>
<h2 id="åˆ›å»ºæ”¯æŒ-C-C-çš„æ–°é¡¹ç›®"><a href="#åˆ›å»ºæ”¯æŒ-C-C-çš„æ–°é¡¹ç›®" class="headerlink" title="åˆ›å»ºæ”¯æŒ C/C++ çš„æ–°é¡¹ç›®"></a>åˆ›å»ºæ”¯æŒ C/C++ çš„æ–°é¡¹ç›®</h2><p>åˆ›å»ºæ”¯æŒåŸç”Ÿä»£ç çš„æ–°é¡¹ç›®çš„æ­¥éª¤ä¸åˆ›å»ºä»»ä½•å…¶ä»– Android Studio é¡¹ç›®çš„æ­¥éª¤ç›¸ä¼¼ï¼Œä½†å‰è€…è¿˜éœ€è¦æ‰§è¡Œä¸€ä¸ªé¢å¤–çš„æ­¥éª¤ï¼š</p>
<p>1.åœ¨å‘å¯¼çš„ Choose your project éƒ¨åˆ†ä¸­ï¼Œé€‰æ‹© Native C++ é¡¹ç›®ç±»å‹ã€‚<br>2.ç‚¹å‡» Nextã€‚<br>3.å¡«å†™å‘å¯¼ä¸‹ä¸€éƒ¨åˆ†ä¸­çš„æ‰€æœ‰å…¶ä»–å­—æ®µã€‚<br>4.ç‚¹å‡» Nextã€‚<br>5.åœ¨å‘å¯¼çš„ Customize C++ Support éƒ¨åˆ†ä¸­ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ C++ Standard å­—æ®µæ¥è‡ªå®šä¹‰é¡¹ç›®ã€‚ä½¿ç”¨ä¸‹æ‹‰åˆ—è¡¨é€‰æ‹©æ‚¨æƒ³è¦ä½¿ç”¨å“ªç§ C++ æ ‡å‡†åŒ–ã€‚é€‰æ‹© Toolchain Default å¯ä½¿ç”¨é»˜è®¤çš„ CMake è®¾ç½®ã€‚<br>6.ç‚¹å‡» Finishã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/05/Android-CMake/cmakeç›®å½•ç»“æ„.png" alt title class>
                <p></p>
            </figure>
<h2 id="åŸæœ‰é¡¹ç›®æ”¯æŒ-C-C"><a href="#åŸæœ‰é¡¹ç›®æ”¯æŒ-C-C" class="headerlink" title="åŸæœ‰é¡¹ç›®æ”¯æŒ C/C++"></a>åŸæœ‰é¡¹ç›®æ”¯æŒ C/C++</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/05/Android-CMake/cmakeåŠ å…¥ç›®å½•ç»“æ„.png" alt title class>
                <p></p>
            </figure>
<h2 id="é…ç½®-CMake"><a href="#é…ç½®-CMake" class="headerlink" title="é…ç½® CMake"></a>é…ç½® CMake</h2><p>CMake æ„å»ºè„šæœ¬æ˜¯ä¸€ä¸ªçº¯æ–‡æœ¬æ–‡ä»¶ï¼Œæ‚¨å¿…é¡»å°†å…¶å‘½åä¸º CMakeLists.txtï¼Œå¹¶åœ¨å…¶ä¸­åŒ…å« CMake æ„å»ºæ‚¨çš„ C/C++ åº“æ—¶éœ€è¦ä½¿ç”¨çš„å‘½ä»¤ã€‚å¦‚æœæ‚¨çš„åŸç”Ÿæºä»£ç æ–‡ä»¶è¿˜æ²¡æœ‰ CMake æ„å»ºè„šæœ¬ï¼Œæ‚¨éœ€è¦è‡ªè¡Œåˆ›å»ºä¸€ä¸ªï¼Œå¹¶åœ¨å…¶ä¸­åŒ…å«é€‚å½“çš„ CMake å‘½ä»¤ã€‚</p>
<p>æœ¬éƒ¨åˆ†å°†ä»‹ç»æ‚¨åº”è¯¥åœ¨æ„å»ºè„šæœ¬ä¸­åŒ…å«å“ªäº›åŸºæœ¬å‘½ä»¤ï¼Œä»¥ä¾¿æŒ‡ç¤º CMake åœ¨åˆ›å»ºåŸç”Ÿåº“æ—¶ä½¿ç”¨å“ªäº›æºä»£ç æ–‡ä»¶ã€‚å¦‚éœ€äº†è§£è¯¦æƒ…ï¼Œè¯·å‚é˜…ä»‹ç» <a href="https://cmake.org/cmake/help/latest/manual/cmake-commands.7.html" target="_blank" rel="noopener">CMake å‘½ä»¤çš„å®˜æ–¹æ–‡æ¡£</a>ã€‚</p>
<p>åœ¨é…ç½®æ–°çš„ CMake æ„å»ºè„šæœ¬åï¼Œæ‚¨éœ€è¦<a href="https://developer.android.com/studio/projects/gradle-external-native-builds" target="_blank" rel="noopener">é…ç½® Gradle</a> ä»¥å°† CMake é¡¹ç›®ä½œä¸ºæ„å»ºä¾èµ–é¡¹åŒ…å«åœ¨å†…ï¼Œä»è€Œè®© Gradle æ„å»ºåŸç”Ÿåº“ï¼Œå¹¶å°†å…¶ä¸åº”ç”¨çš„ APK æ‰“åŒ…åœ¨ä¸€èµ·ã€‚</p>
<ul>
<li>æ³¨æ„ï¼šå¦‚æœé¡¹ç›®ä½¿ç”¨çš„æ˜¯ ndk-buildï¼Œæ‚¨ä¸éœ€è¦åˆ›å»º CMake æ„å»ºè„šæœ¬ã€‚æ‚¨åªéœ€é…ç½® Gradle ä»¥åŒ…å«ç°æœ‰çš„åŸç”Ÿåº“é¡¹ç›®å³å¯ï¼›ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦æä¾› Android.mk æ–‡ä»¶çš„è·¯å¾„ã€‚</li>
</ul>
<h3 id="åˆ›å»º-CMake-æ„å»ºè„šæœ¬"><a href="#åˆ›å»º-CMake-æ„å»ºè„šæœ¬" class="headerlink" title="åˆ›å»º CMake æ„å»ºè„šæœ¬"></a>åˆ›å»º CMake æ„å»ºè„šæœ¬</h3><p>è¦åˆ›å»ºä¸€ä¸ªå¯ä»¥ç”¨ä½œ CMake æ„å»ºè„šæœ¬çš„çº¯æ–‡æœ¬æ–‡ä»¶ï¼Œè¯·æŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>
<p>1.ä» IDE çš„å·¦ä¾§æ‰“å¼€ Project çª—æ ¼ï¼Œç„¶åä»ä¸‹æ‹‰èœå•ä¸­é€‰æ‹© Project è§†å›¾ã€‚<br>2.å³é”®ç‚¹å‡» your-module çš„æ ¹ç›®å½•ï¼Œç„¶åä¾æ¬¡é€‰æ‹© New &gt; Fileã€‚</p>
<ul>
<li>æ³¨æ„ï¼šæ‚¨å¯ä»¥åœ¨æ‰€éœ€çš„ä»»ä½•ä½ç½®åˆ›å»ºæ„å»ºè„šæœ¬ã€‚ä¸è¿‡ï¼Œåœ¨é…ç½®æ„å»ºè„šæœ¬æ—¶ï¼ŒåŸç”Ÿæºä»£ç æ–‡ä»¶å’Œåº“çš„è·¯å¾„å°†ä¸æ„å»ºè„šæœ¬çš„ä½ç½®ç›¸å…³ã€‚</li>
</ul>
<p>3.è¾“å…¥â€œCMakeLists.txtâ€ä½œä¸ºæ–‡ä»¶åï¼Œç„¶åç‚¹å‡» OKã€‚<br>ç°åœ¨ï¼Œæ‚¨å¯ä»¥é€šè¿‡æ·»åŠ  CMake å‘½ä»¤æ¥é…ç½®æ‚¨çš„æ„å»ºè„šæœ¬ã€‚è¦æŒ‡ç¤º CMake æ ¹æ®åŸç”Ÿæºä»£ç åˆ›å»ºåŸç”Ÿåº“ï¼Œè¯·å‘æ‚¨çš„æ„å»ºè„šæœ¬æ·»åŠ  cmake_minimum_required() å’Œ add_library() å‘½ä»¤ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"># Sets the minimum version of CMake required to build your native library.</span><br><span class="line"># This ensures that a certain set of CMake features is available to</span><br><span class="line"># your build.</span><br><span class="line"></span><br><span class="line">cmake_minimum_required(VERSION 3.4.1)</span><br><span class="line"></span><br><span class="line"># Specifies a library name, specifies whether the library is STATIC or</span><br><span class="line"># SHARED, and provides relative paths to the source code. You can</span><br><span class="line"># define multiple libraries by adding multiple add_library() commands,</span><br><span class="line"># and CMake builds them for you. When you build your app, Gradle</span><br><span class="line"># automatically packages shared libraries with your APK.</span><br><span class="line"></span><br><span class="line">add_library( # Specifies the name of the library.</span><br><span class="line">             native-lib</span><br><span class="line"></span><br><span class="line">             # Sets the library as a shared library.</span><br><span class="line">             SHARED</span><br><span class="line"></span><br><span class="line">             # Provides a relative path to your source file(s).</span><br><span class="line">             src/main/cpp/native-lib.cpp )</span><br></pre></td></tr></table></figure>

<ul>
<li>æç¤ºï¼šä¸æŒ‡ç¤º CMake æ ¹æ®æºä»£ç æ–‡ä»¶åˆ›å»ºåŸç”Ÿåº“çš„æ–¹å¼ä¸€æ ·ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ add_executable() å‘½ä»¤æŒ‡ç¤º CMake æ”¹ä¸ºæ ¹æ®è¿™äº›æºä»£ç æ–‡ä»¶æ¥åˆ›å»ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚ä¸è¿‡ï¼Œæ ¹æ®åŸç”Ÿæºä»£ç æ–‡ä»¶æ„å»ºå¯æ‰§è¡Œæ–‡ä»¶æ˜¯å¯é€‰æ“ä½œï¼Œæ„å»ºåŸç”Ÿåº“ä»¥å°†å…¶æ‰“åŒ…åˆ° APK ä¸­å³å¯æ»¡è¶³å¤§å¤šæ•°é¡¹ç›®çš„è¦æ±‚ã€‚</li>
</ul>
<p>åœ¨ä½¿ç”¨ add_library() å‘ CMake æ„å»ºè„šæœ¬æ·»åŠ æºä»£ç æ–‡ä»¶æˆ–åº“æ—¶ï¼ŒAndroid Studio è¿˜ä¼šåœ¨æ‚¨åŒæ­¥é¡¹ç›®ååœ¨ Project è§†å›¾ä¸­æ˜¾ç¤ºç›¸å…³çš„å¤´æ–‡ä»¶ã€‚ä¸è¿‡ï¼Œä¸ºäº†è®© CMake èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶æ‰¾åˆ°å¤´æ–‡ä»¶ï¼Œæ‚¨éœ€è¦å‘ CMake æ„å»ºè„šæœ¬æ·»åŠ  include_directories() å‘½ä»¤ï¼Œå¹¶æŒ‡å®šå¤´æ–‡ä»¶çš„è·¯å¾„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add_library(...)</span><br><span class="line"></span><br><span class="line"># Specifies a path to native header files.</span><br><span class="line">include_directories(src/main/cpp/include/)</span><br></pre></td></tr></table></figure>

<p>CMake ä½¿ç”¨ä»¥ä¸‹è§„èŒƒæ¥ä¸ºåº“æ–‡ä»¶å‘½åï¼š</p>
<p>liblibrary-name.so<br>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨åœ¨æ„å»ºè„šæœ¬ä¸­æŒ‡å®šâ€œnative-libâ€ä½œä¸ºå…±äº«åº“çš„åç§°ï¼ŒCMake å°±ä¼šåˆ›å»ºä¸€ä¸ªåä¸º libnative-lib.so çš„æ–‡ä»¶ã€‚ä¸è¿‡ï¼Œåœ¨ Java æˆ– Kotlin ä»£ç ä¸­åŠ è½½æ­¤åº“æ—¶ï¼Œè¯·ä½¿ç”¨æ‚¨åœ¨ CMake æ„å»ºè„šæœ¬ä¸­æŒ‡å®šçš„åç§°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">static &#123;</span><br><span class="line">    System.loadLibrary(&quot;native-lib&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„ï¼šå¦‚æœé‡å‘½åæˆ–ç§»é™¤äº† CMake æ„å»ºè„šæœ¬ä¸­çš„åº“ï¼Œæ‚¨éœ€è¦åœ¨ Gradle å®æ–½ç›¸å…³æ›´æ”¹æˆ–ä» APK ä¸­ç§»é™¤æ—§ç‰ˆåº“ä¹‹å‰æ¸…ç†æ‚¨çš„é¡¹ç›®ã€‚è¦æ¸…ç†é¡¹ç›®ï¼Œè¯·åœ¨èœå•æ ä¸­ä¾æ¬¡é€‰æ‹© Build &gt; Clean Projectã€‚</li>
</ul>
<p>Android Studio ä¼šè‡ªåŠ¨å‘ Project çª—æ ¼ä¸­çš„ cpp ç¾¤ç»„æ·»åŠ æºä»£ç æ–‡ä»¶å’Œå¤´æ–‡ä»¶ã€‚é€šè¿‡ä½¿ç”¨å¤šä¸ª add_library() å‘½ä»¤ï¼Œæ‚¨å¯ä»¥ä¸º CMake å®šä¹‰è¦æ ¹æ®å…¶ä»–æºä»£ç æ–‡ä»¶æ„å»ºçš„æ›´å¤šåº“ã€‚</p>
<h3 id="æ·»åŠ -NDK-API"><a href="#æ·»åŠ -NDK-API" class="headerlink" title="æ·»åŠ  NDK API"></a>æ·»åŠ  NDK API</h3><p>Android NDK æä¾›äº†ä¸€å¥—æ‚¨å¯èƒ½ä¼šè§‰å¾—éå¸¸å®ç”¨çš„åŸç”Ÿ API å’Œåº“ã€‚é€šè¿‡åœ¨é¡¹ç›®çš„ CMakeLists.txt è„šæœ¬æ–‡ä»¶ä¸­åŒ…å« NDK åº“ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨å…¶ä¸­ä»»ä½• APIã€‚</p>
<p>Android å¹³å°ä¸Šå·²å­˜åœ¨é¢„æ„å»ºçš„ NDK åº“ï¼Œå› æ­¤æ‚¨æ— éœ€æ„å»ºå®ƒä»¬æˆ–å°†å®ƒä»¬æ‰“åŒ…åˆ° APK ä¸­ã€‚ç”±äºè¿™äº› NDK åº“å·²ä½äº CMake æœç´¢è·¯å¾„ä¸­ï¼Œå› æ­¤æ‚¨ç”šè‡³æ— éœ€æŒ‡å®šæœ¬åœ°å®‰è£…çš„ NDK åº“çš„ä½ç½®ï¼Œæ‚¨åªéœ€ä¸º CMake æä¾›æ‚¨æƒ³è¦ä½¿ç”¨çš„åº“çš„åç§°ï¼Œå¹¶å°†å…¶ä¸æ‚¨è‡ªå·±çš„åŸç”Ÿåº“ç›¸å…³è”å³å¯ã€‚</p>
<p>å‘ CMake æ„å»ºè„šæœ¬æ·»åŠ  find_library() å‘½ä»¤ä»¥æ‰¾åˆ° NDK åº“å¹¶å°†å…¶è·¯å¾„å­˜å‚¨ä¸ºä¸€ä¸ªå˜é‡ã€‚æ‚¨å¯ä»¥ä½¿ç”¨æ­¤å˜é‡åœ¨æ„å»ºè„šæœ¬çš„å…¶ä»–éƒ¨åˆ†å¼•ç”¨ NDK åº“ã€‚ä»¥ä¸‹ç¤ºä¾‹å¯ä»¥æ‰¾åˆ° Android ä¸“æœ‰çš„æ—¥å¿—æ”¯æŒåº“ï¼Œå¹¶ä¼šå°†å…¶è·¯å¾„å­˜å‚¨åœ¨ log-lib ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">find_library( # Defines the name of the path variable that stores the</span><br><span class="line">              # location of the NDK library.</span><br><span class="line">              log-lib</span><br><span class="line"></span><br><span class="line">              # Specifies the name of the NDK library that</span><br><span class="line">              # CMake needs to locate.</span><br><span class="line">              log )</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è®©æ‚¨çš„åŸç”Ÿåº“èƒ½å¤Ÿè°ƒç”¨ log åº“ä¸­çš„å‡½æ•°ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ CMake æ„å»ºè„šæœ¬ä¸­çš„ target_link_libraries() å‘½ä»¤æ¥å…³è”è¿™äº›åº“ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">find_library(...)</span><br><span class="line"></span><br><span class="line"># Links your native library against one or more other native libraries.</span><br><span class="line">target_link_libraries( # Specifies the target library.</span><br><span class="line">                       native-lib</span><br><span class="line"></span><br><span class="line">                       # Links the log library to the target library.</span><br><span class="line">                       $&#123;log-lib&#125; )</span><br></pre></td></tr></table></figure>

<p>NDK è¿˜ä»¥æºä»£ç çš„å½¢å¼åŒ…å«ä¸€äº›åº“ï¼Œæ‚¨å°†éœ€è¦æ„å»ºè¿™äº›ä»£ç å¹¶å°†å…¶å…³è”åˆ°æ‚¨çš„åŸç”Ÿåº“ã€‚æ‚¨å¯ä»¥ä½¿ç”¨ CMake æ„å»ºè„šæœ¬ä¸­çš„ add_library() å‘½ä»¤å°†æºä»£ç ç¼–è¯‘åˆ°åŸç”Ÿåº“ä¸­ã€‚å¦‚éœ€æä¾›æœ¬åœ° NDK åº“çš„è·¯å¾„ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ Android Studio è‡ªåŠ¨ä¸ºæ‚¨å®šä¹‰çš„ ANDROID_NDK è·¯å¾„å˜é‡ã€‚</p>
<p>ä»¥ä¸‹å‘½ä»¤å‘Šè¯‰ CMake è¦æ„å»º android_native_app_glue.cï¼ˆè´Ÿè´£ç®¡ç† NativeActivity ç”Ÿå‘½å‘¨æœŸäº‹ä»¶å’Œè§¦æ‘¸è¾“å…¥ï¼‰ï¼Œå¹¶å°†å…¶é“¾æ¥åˆ°é™æ€åº“ native-lib ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">add_library( app-glue</span><br><span class="line">             STATIC</span><br><span class="line">             $&#123;ANDROID_NDK&#125;/sources/android/native_app_glue/android_native_app_glue.c )</span><br><span class="line"></span><br><span class="line"># You need to link static libraries against your shared native library.</span><br><span class="line">target_link_libraries( native-lib app-glue $&#123;log-lib&#125; )</span><br></pre></td></tr></table></figure>

<h3 id="æ·»åŠ å…¶ä»–é¢„æ„å»ºåº“"><a href="#æ·»åŠ å…¶ä»–é¢„æ„å»ºåº“" class="headerlink" title="æ·»åŠ å…¶ä»–é¢„æ„å»ºåº“"></a>æ·»åŠ å…¶ä»–é¢„æ„å»ºåº“</h3><p>æ·»åŠ é¢„æ„å»ºåº“çš„æ­¥éª¤ä¸ä¸º CMake æŒ‡å®šå…¶ä»–è¦æ„å»ºçš„åŸç”Ÿåº“çš„æ­¥éª¤ç›¸ä¼¼ã€‚ä¸è¿‡ï¼Œç”±äºåº“å·²æ„å»ºï¼Œå› æ­¤æ‚¨éœ€è¦ä½¿ç”¨ IMPORTED æ ‡è®°å‘Šè¯‰ CMake æ‚¨åªæƒ³è¦å°†æ­¤åº“å¯¼å…¥åˆ°æ‚¨çš„é¡¹ç›®ä¸­ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">add_library( imported-lib</span><br><span class="line">             SHARED</span><br><span class="line">             IMPORTED )</span><br></pre></td></tr></table></figure>

<p>ç„¶åï¼Œæ‚¨éœ€è¦ä½¿ç”¨ set_target_properties() å‘½ä»¤æŒ‡å®šåº“çš„è·¯å¾„ï¼Œå…·ä½“æ­¥éª¤å¦‚ä¸‹æ‰€ç¤ºã€‚</p>
<p>æŸäº›åº“ä¼šé’ˆå¯¹ç‰¹å®šçš„ CPU æ¶æ„æˆ–åº”ç”¨äºŒè¿›åˆ¶æ¥å£ (ABI) æä¾›å•ç‹¬çš„è½¯ä»¶åŒ…ï¼Œå¹¶å°†å…¶æ•´ç†åˆ°å•ç‹¬çš„ç›®å½•ä¸­ã€‚æ­¤æ–¹æ³•æ—¢æœ‰åŠ©äºåº“å……åˆ†åˆ©ç”¨ç‰¹å®šçš„ CPU æ¶æ„ï¼Œåˆèƒ½è®©æ‚¨åªä½¿ç”¨æ‰€éœ€çš„åº“ç‰ˆæœ¬ã€‚è¦å‘ CMake æ„å»ºè„šæœ¬æ·»åŠ åº“çš„å¤šä¸ª ABI ç‰ˆæœ¬ï¼Œè€Œä¸å¿…ä¸ºåº“çš„æ¯ä¸ªç‰ˆæœ¬ç¼–å†™å¤šä¸ªå‘½ä»¤ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ ANDROID_ABI è·¯å¾„å˜é‡ã€‚æ­¤å˜é‡ä½¿ç”¨çš„æ˜¯ NDK æ”¯æŒçš„ä¸€ç»„é»˜è®¤ ABIï¼Œæˆ–è€…æ‚¨æ‰‹åŠ¨é…ç½® Gradle ä»¥ä½¿ç”¨çš„ä¸€ç»„ç»è¿‡è¿‡æ»¤çš„ ABIã€‚ä¾‹å¦‚ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">add_library(...)</span><br><span class="line">set_target_properties( # Specifies the target library.</span><br><span class="line">                       imported-lib</span><br><span class="line"></span><br><span class="line">                       # Specifies the parameter you want to define.</span><br><span class="line">                       PROPERTIES IMPORTED_LOCATION</span><br><span class="line"></span><br><span class="line">                       # Provides the path to the library you want to import.</span><br><span class="line">                       imported-lib/src/$&#123;ANDROID_ABI&#125;/libimported-lib.so )</span><br></pre></td></tr></table></figure>

<p>ä¸ºäº†è®© CMake èƒ½å¤Ÿåœ¨ç¼–è¯‘æ—¶å®šä½æ‚¨çš„å¤´æ–‡ä»¶ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ include_directories() å‘½ä»¤å¹¶åŒ…å«ç›¸åº”å¤´æ–‡ä»¶çš„è·¯å¾„ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">include_directories( imported-lib/include/ )</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„ï¼šå¦‚æœæ‚¨æƒ³è¦æ‰“åŒ…ä¸å±äºæ„å»ºæ—¶ä¾èµ–é¡¹çš„é¢„æ„å»ºåº“ï¼ˆä¾‹å¦‚åœ¨æ·»åŠ å±äº imported-lib ä¾èµ–é¡¹çš„é¢„æ„å»ºåº“æ—¶ï¼‰ï¼Œåˆ™æ— éœ€æŒ‰ä»¥ä¸‹è¯´æ˜æ“ä½œæ¥å…³è”åº“ã€‚</li>
</ul>
<p>å¦‚éœ€å°†é¢„æ„å»ºåº“å…³è”åˆ°æ‚¨è‡ªå·±çš„åŸç”Ÿåº“ï¼Œè¯·å°†å…¶æ·»åŠ åˆ° CMake æ„å»ºè„šæœ¬çš„ target_link_libraries() å‘½ä»¤ä¸­ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">target_link_libraries( native-lib imported-lib app-glue $&#123;log-lib&#125; )</span><br></pre></td></tr></table></figure>

<p>å¦‚éœ€å°†é¢„æ„å»ºåº“æ‰“åŒ…åˆ° APK ä¸­ï¼Œæ‚¨éœ€è¦ä½¿ç”¨ sourceSets å—æ‰‹åŠ¨é…ç½® Gradle ä»¥åŒ…å« .so æ–‡ä»¶çš„è·¯å¾„ã€‚æ„å»º APK åï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ APK åˆ†æå™¨éªŒè¯ Gradle ä¼šå°†å“ªäº›åº“æ‰“åŒ…åˆ°æ‚¨çš„ APK ä¸­ã€‚</p>
<h3 id="åŒ…å«å…¶ä»–-CMake-é¡¹ç›®"><a href="#åŒ…å«å…¶ä»–-CMake-é¡¹ç›®" class="headerlink" title="åŒ…å«å…¶ä»– CMake é¡¹ç›®"></a>åŒ…å«å…¶ä»– CMake é¡¹ç›®</h3><p>å¦‚æœæƒ³è¦æ„å»ºå¤šä¸ª CMake é¡¹ç›®å¹¶åœ¨ Android é¡¹ç›®ä¸­åŒ…å«å®ƒä»¬çš„è¾“å‡ºï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ä¸€ä¸ª CMakeLists.txt æ–‡ä»¶ï¼ˆå³æ‚¨å…³è”åˆ° Gradle çš„é‚£ä¸ªæ–‡ä»¶ï¼‰ä½œä¸ºé¡¶çº§ CMake æ„å»ºè„šæœ¬ï¼Œå¹¶æ·»åŠ å…¶ä»– CMake é¡¹ç›®ä½œä¸ºæ­¤æ„å»ºè„šæœ¬çš„ä¾èµ–é¡¹ã€‚ä»¥ä¸‹é¡¶çº§ CMake æ„å»ºè„šæœ¬ä¼šä½¿ç”¨ add_subdirectory() å‘½ä»¤å°†å¦ä¸€ä¸ª CMakeLists.txt æ–‡ä»¶æŒ‡å®šä¸ºæ„å»ºä¾èµ–é¡¹ï¼Œç„¶åå…³è”å…¶è¾“å‡ºï¼Œå°±åƒå¤„ç†ä»»ä½•å…¶ä»–é¢„æ„å»ºåº“ä¸€æ ·ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"># Sets lib_src_DIR to the path of the target CMake project.</span><br><span class="line">set( lib_src_DIR ../gmath )</span><br><span class="line"></span><br><span class="line"># Sets lib_build_DIR to the path of the desired output directory.</span><br><span class="line">set( lib_build_DIR ../gmath/outputs )</span><br><span class="line">file(MAKE_DIRECTORY $&#123;lib_build_DIR&#125;)</span><br><span class="line"></span><br><span class="line"># Adds the CMakeLists.txt file located in the specified directory</span><br><span class="line"># as a build dependency.</span><br><span class="line">add_subdirectory( # Specifies the directory of the CMakeLists.txt file.</span><br><span class="line">                  $&#123;lib_src_DIR&#125;</span><br><span class="line"></span><br><span class="line">                  # Specifies the directory for the build outputs.</span><br><span class="line">                  $&#123;lib_build_DIR&#125; )</span><br><span class="line"></span><br><span class="line"># Adds the output of the additional CMake build as a prebuilt static</span><br><span class="line"># library and names it lib_gmath.</span><br><span class="line">add_library( lib_gmath STATIC IMPORTED )</span><br><span class="line">set_target_properties( lib_gmath PROPERTIES IMPORTED_LOCATION</span><br><span class="line">                       $&#123;lib_build_DIR&#125;/$&#123;ANDROID_ABI&#125;/lib_gmath.a )</span><br><span class="line">include_directories( $&#123;lib_src_DIR&#125;/include )</span><br><span class="line"></span><br><span class="line"># Links the top-level CMake build output against lib_gmath.</span><br><span class="line">target_link_libraries( native-lib ... lib_gmath )</span><br></pre></td></tr></table></figure>

<h2 id="å…³è”Gradle"><a href="#å…³è”Gradle" class="headerlink" title="å…³è”Gradle"></a>å…³è”Gradle</h2><h3 id="æ‰‹åŠ¨é…ç½®-Gradle"><a href="#æ‰‹åŠ¨é…ç½®-Gradle" class="headerlink" title="æ‰‹åŠ¨é…ç½® Gradle"></a>æ‰‹åŠ¨é…ç½® Gradle</h3><p>è¦æ‰‹åŠ¨é…ç½® Gradle ä»¥å…³è”åˆ°æ‚¨çš„åŸç”Ÿåº“ï¼Œæ‚¨éœ€è¦å°† externalNativeBuild å—æ·»åŠ åˆ°æ¨¡å—çº§ build.gradle æ–‡ä»¶ä¸­ï¼Œå¹¶ä½¿ç”¨ cmake æˆ– ndkBuild å—å¯¹å…¶è¿›è¡Œé…ç½®ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">  ...</span><br><span class="line">  defaultConfig &#123;...&#125;</span><br><span class="line">  buildTypes &#123;...&#125;</span><br><span class="line"></span><br><span class="line">  // Encapsulates your external native build configurations.</span><br><span class="line">  externalNativeBuild &#123;</span><br><span class="line"></span><br><span class="line">    // Encapsulates your CMake build configurations.</span><br><span class="line">    cmake &#123;</span><br><span class="line"></span><br><span class="line">      // Provides a relative path to your CMake build script.</span><br><span class="line">      path &quot;CMakeLists.txt&quot;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<ul>
<li>æ³¨æ„ï¼šå¦‚æœæ‚¨è¦å°† Gradle å…³è”åˆ°ç°æœ‰çš„ ndk-build é¡¹ç›®ï¼Œè¯·ä½¿ç”¨ ndkBuild å—ï¼ˆè€Œä¸æ˜¯ cmake å—ï¼‰ï¼Œå¹¶æä¾›æŒ‡å‘ Android.mk æ–‡ä»¶çš„ç›¸å¯¹è·¯å¾„ã€‚å¦‚æœ Application.mk æ–‡ä»¶ä¸æ‚¨çš„ Android.mk æ–‡ä»¶ä½äºåŒä¸€ç›®å½•ä¸‹ï¼ŒGradle ä¹Ÿä¼šåŒ…å«æ­¤æ–‡ä»¶ã€‚</li>
</ul>
<h3 id="æŒ‡å®šå¯é€‰é…ç½®"><a href="#æŒ‡å®šå¯é€‰é…ç½®" class="headerlink" title="æŒ‡å®šå¯é€‰é…ç½®"></a>æŒ‡å®šå¯é€‰é…ç½®</h3><p>æ‚¨å¯ä»¥åœ¨æ¨¡å—çº§ build.gradle æ–‡ä»¶çš„ defaultConfig å—ä¸­é…ç½®å¦ä¸€ä¸ª externalNativeBuild å—ï¼Œä¸º CMake æˆ– ndk-build æŒ‡å®šå¯é€‰å‚æ•°å’Œæ ‡è®°ã€‚ä¸ defaultConfig å—ä¸­çš„å…¶ä»–å±æ€§ç±»ä¼¼ï¼Œæ‚¨ä¹Ÿå¯ä»¥åœ¨æ„å»ºé…ç½®ä¸­ä¸ºæ¯ç§äº§å“ç‰¹æ€§é‡å†™è¿™äº›å±æ€§ã€‚</p>
<p>ä¾‹å¦‚ï¼Œå¦‚æœæ‚¨çš„ CMake æˆ– ndk-build é¡¹ç›®å®šä¹‰å¤šä¸ªåŸç”Ÿåº“å’Œå¯æ‰§è¡Œæ–‡ä»¶ï¼Œæ‚¨å¯ä»¥ä½¿ç”¨ targets å±æ€§ä¸ºæŒ‡å®šäº§å“ç‰¹æ€§æ„å»ºå’Œæ‰“åŒ…å…¶ä¸­çš„éƒ¨åˆ†å·¥ä»¶ã€‚ä»¥ä¸‹ä»£ç ç¤ºä¾‹è¯´æ˜äº†æ‚¨å¯ä»¥é…ç½®çš„éƒ¨åˆ†å±æ€§ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line">android &#123;</span><br><span class="line">  ...</span><br><span class="line">  defaultConfig &#123;</span><br><span class="line">    ...</span><br><span class="line">    // This block is different from the one you use to link Gradle</span><br><span class="line">    // to your CMake or ndk-build script.</span><br><span class="line">    externalNativeBuild &#123;</span><br><span class="line"></span><br><span class="line">      // For ndk-build, instead use the ndkBuild block.</span><br><span class="line">      cmake &#123;</span><br><span class="line"></span><br><span class="line">        // Passes optional arguments to CMake.</span><br><span class="line">        arguments &quot;-DANDROID_ARM_NEON=TRUE&quot;, &quot;-DANDROID_TOOLCHAIN=clang&quot;</span><br><span class="line"></span><br><span class="line">        // Sets a flag to enable format macro constants for the C compiler.</span><br><span class="line">        cFlags &quot;-D__STDC_FORMAT_MACROS&quot;</span><br><span class="line"></span><br><span class="line">        // Sets optional flags for the C++ compiler.</span><br><span class="line">        cppFlags &quot;-fexceptions&quot;, &quot;-frtti&quot;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  buildTypes &#123;...&#125;</span><br><span class="line"></span><br><span class="line">  productFlavors &#123;</span><br><span class="line">    ...</span><br><span class="line">    demo &#123;</span><br><span class="line">      ...</span><br><span class="line">      externalNativeBuild &#123;</span><br><span class="line">        cmake &#123;</span><br><span class="line">          ...</span><br><span class="line">          // Specifies which native libraries or executables to build and package</span><br><span class="line">          // for this product flavor. The following tells Gradle to build only the</span><br><span class="line">          // &quot;native-lib-demo&quot; and &quot;my-executible-demo&quot; outputs from the linked</span><br><span class="line">          // CMake project. If you don&apos;t configure this property, Gradle builds all</span><br><span class="line">          // executables and shared object libraries that you define in your CMake</span><br><span class="line">          // (or ndk-build) project. However, by default, Gradle packages only the</span><br><span class="line">          // shared libraries in your APK.</span><br><span class="line">          targets &quot;native-lib-demo&quot;,</span><br><span class="line">                  // You need to specify this executable and its sources in your CMakeLists.txt</span><br><span class="line">                  // using the add_executable() command. However, building executables from your</span><br><span class="line">                  // native sources is optional, and building native libraries to package into</span><br><span class="line">                  // your APK satisfies most project requirements.</span><br><span class="line">                  &quot;my-executible-demo&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    paid &#123;</span><br><span class="line">      ...</span><br><span class="line">      externalNativeBuild &#123;</span><br><span class="line">        cmake &#123;</span><br><span class="line">          ...</span><br><span class="line">          targets &quot;native-lib-paid&quot;,</span><br><span class="line">                  &quot;my-executible-paid&quot;</span><br><span class="line">        &#125;</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  // Use this block to link Gradle to your CMake or ndk-build script.</span><br><span class="line">  externalNativeBuild &#123;</span><br><span class="line">    cmake &#123;...&#125;</span><br><span class="line">    // or ndkBuild &#123;...&#125;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚éœ€è¯¦ç»†äº†è§£å¦‚ä½•é…ç½®äº§å“å˜ç§å’Œæ„å»ºå˜ä½“ï¼Œè¯·å‚é˜…é…ç½®æ„å»ºå˜ä½“ã€‚å¦‚éœ€äº†è§£æ‚¨å¯ä»¥ä½¿ç”¨ arguments å±æ€§ä¸º CMake é…ç½®çš„å˜é‡åˆ—è¡¨ï¼Œè¯·å‚é˜…ä½¿ç”¨ CMake å˜é‡ã€‚</p>
<h3 id="æ·»åŠ é¢„æ„å»ºçš„åŸç”Ÿåº“"><a href="#æ·»åŠ é¢„æ„å»ºçš„åŸç”Ÿåº“" class="headerlink" title="æ·»åŠ é¢„æ„å»ºçš„åŸç”Ÿåº“"></a>æ·»åŠ é¢„æ„å»ºçš„åŸç”Ÿåº“</h3><p>å¦‚æœæ‚¨å¸Œæœ› Gradle å°†é¢„æ„å»ºçš„åŸç”Ÿåº“æ‰“åŒ…åˆ°æ‚¨çš„ APK ä¸­ï¼Œè¯·ä¿®æ”¹é»˜è®¤çš„æºä»£ç é›†é…ç½®ï¼Œä»¥æ·»åŠ é¢„æ„å»º .so æ–‡ä»¶æ‰€åœ¨çš„ç›®å½•ï¼Œå¦‚ä¸‹æ‰€ç¤ºã€‚è¯·æ³¨æ„ï¼Œè‹¥è¦æ·»åŠ å…³è”åˆ° Gradle çš„ CMake æ„å»ºè„šæœ¬çš„å·¥ä»¶ï¼Œåˆ™æ— éœ€æ‰§è¡Œæ­¤æ“ä½œã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">    ...</span><br><span class="line">    sourceSets &#123;</span><br><span class="line">        main &#123;</span><br><span class="line">            jniLibs.srcDirs &apos;imported-lib/src/&apos;, &apos;more-imported-libs/src/&apos;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æŒ‡å®š-ABI"><a href="#æŒ‡å®š-ABI" class="headerlink" title="æŒ‡å®š ABI"></a>æŒ‡å®š ABI</h3><p>é»˜è®¤æƒ…å†µä¸‹ï¼ŒGradle ä¼šé’ˆå¯¹ NDK æ”¯æŒçš„åº”ç”¨äºŒè¿›åˆ¶æ¥å£ (ABI) å°†æ‚¨çš„åŸç”Ÿåº“æ„å»ºåˆ°å•ç‹¬çš„ .so æ–‡ä»¶ä¸­ï¼Œå¹¶å°†è¿™äº›æ–‡ä»¶å…¨éƒ¨æ‰“åŒ…åˆ°æ‚¨çš„ APK ä¸­ã€‚å¦‚æœæ‚¨å¸Œæœ› Gradle ä»…æ„å»ºå’Œæ‰“åŒ…åŸç”Ÿåº“çš„éƒ¨åˆ† ABI é…ç½®ï¼Œåˆ™å¯ä»¥åœ¨æ¨¡å—çº§ build.gradle æ–‡ä»¶ä¸­ä½¿ç”¨ ndk.abiFilters æ ‡è®°æŒ‡å®šè¿™äº›é…ç½®ï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">android &#123;</span><br><span class="line">  ...</span><br><span class="line">  defaultConfig &#123;</span><br><span class="line">    ...</span><br><span class="line">    externalNativeBuild &#123;</span><br><span class="line">      cmake &#123;...&#125;</span><br><span class="line">      // or ndkBuild &#123;...&#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    // Similar to other properties in the defaultConfig block,</span><br><span class="line">    // you can configure the ndk block for each product flavor</span><br><span class="line">    // in your build configuration.</span><br><span class="line">    ndk &#123;</span><br><span class="line">      // Specifies the ABI configurations of your native</span><br><span class="line">      // libraries Gradle should build and package with your APK.</span><br><span class="line">      abiFilters &apos;x86&apos;, &apos;x86_64&apos;, &apos;armeabi&apos;, &apos;armeabi-v7a&apos;,</span><br><span class="line">                   &apos;arm64-v8a&apos;</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">  buildTypes &#123;...&#125;</span><br><span class="line">  externalNativeBuild &#123;...&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œæ‚¨åªéœ€è¦åœ¨ ndk å—ä¸­æŒ‡å®š abiFiltersï¼ˆå¦‚ä¸Šæ‰€ç¤ºï¼‰ï¼Œå› ä¸ºå®ƒä¼šæŒ‡ç¤º Gradle æ„å»ºå’Œæ‰“åŒ…åŸç”Ÿåº“çš„è¿™äº›ç‰ˆæœ¬ã€‚ä½†æ˜¯ï¼Œå¦‚æœæ‚¨æƒ³æ§åˆ¶ Gradle åº”å½“æ„å»ºçš„é…ç½®ï¼Œè€Œä¸ä¾èµ–äºæ‚¨å¸Œæœ›å…¶æ‰“åŒ…åˆ° APK ä¸­çš„é…ç½®ï¼Œè¯·åœ¨ defaultConfig.externalNativeBuild.cmake å—ï¼ˆæˆ– defaultConfig.externalNativeBuild.ndkBuild å—ï¼‰ä¸­é…ç½®å¦ä¸€ä¸ª abiFilters æ ‡è®°ã€‚Gradle ä¼šæ„å»ºè¿™äº› ABI é…ç½®ï¼Œä½†åªä¼šæ‰“åŒ…æ‚¨åœ¨ defaultConfig.ndk å—ä¸­æŒ‡å®šçš„é…ç½®ã€‚</p>
<p>ä¸ºäº†è¿›ä¸€æ­¥é™ä½ APK çš„å¤§å°ï¼Œè¯·è€ƒè™‘åŸºäº ABI é…ç½®å¤šä¸ª APKï¼Œè€Œä¸æ˜¯åˆ›å»ºä¸€ä¸ªåŒ…å«åŸç”Ÿåº“æ‰€æœ‰ç‰ˆæœ¬çš„å¤§å‹ APKã€‚Gradle ä¼šä¸ºæ‚¨æƒ³è¦æ”¯æŒçš„æ¯ä¸ª ABI åˆ›å»ºå•ç‹¬çš„ APKï¼Œå¹¶ä¸”ä»…æ‰“åŒ…æ¯ä¸ª ABI éœ€è¦çš„æ–‡ä»¶ã€‚å¦‚æœæ‚¨ä¸ºæ¯ä¸ª ABI é…ç½®å¤šä¸ª APKï¼Œè€Œä¸åƒä¸Šé¢çš„ä»£ç ç¤ºä¾‹ä¸­æ‰€ç¤ºçš„é‚£æ ·æŒ‡å®š abiFilters æ ‡è®°ï¼Œåˆ™ Gradle ä¼šä¸ºæ‚¨çš„åŸç”Ÿåº“æ„å»ºæ‰€æœ‰å—æ”¯æŒçš„ ABI ç‰ˆæœ¬ï¼Œä½†æ˜¯ä»…æ‰“åŒ…æ‚¨åœ¨å¤š APK é…ç½®ä¸­æŒ‡å®šçš„ç‰ˆæœ¬ã€‚ä¸ºé¿å…æ„å»ºä¸æƒ³è¦çš„åŸç”Ÿåº“ç‰ˆæœ¬ï¼Œè¯·ä¸º abiFilters æ ‡è®°å’Œâ€œä¸€ä¸ª ABI å¤šä¸ª APKâ€é…ç½®æä¾›ç›¸åŒçš„ ABI åˆ—è¡¨ã€‚</p>
<h2 id="å¼‚å¸¸é—®é¢˜"><a href="#å¼‚å¸¸é—®é¢˜" class="headerlink" title="å¼‚å¸¸é—®é¢˜"></a>å¼‚å¸¸é—®é¢˜</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/05/Android-CMake/å¼‚å¸¸1.png" alt title class>
                <p></p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/08/05/Android-CMake/å¼‚å¸¸2.jpeg" alt title class>
                <p></p>
            </figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://developer.android.com/studio/projects" target="_blank" rel="noopener">developer.android.com</a></p>
]]></content>
      
        <categories>
            
            <category> NDK </category>
            
        </categories>
        
        
        <tags>
            
            <tag> CMake </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Wiresharkä½¿ç”¨åŠæ•°æ®åˆ†æ]]></title>
      <url>/2020/07/07/Wireshark%E4%BD%BF%E7%94%A8%E5%8F%8A%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ä»¥ç›´æ’­æ¶ˆæ¯é‡‡é›†å’Œåˆ†ææ•°æ®ä¸ºä¾‹è¿›è¡Œè®²è§£ã€‚</p>
<h2 id="é‡‡é›†"><a href="#é‡‡é›†" class="headerlink" title="é‡‡é›†"></a>é‡‡é›†</h2>]]></content>
      
        <categories>
            
            <category> Tools </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Wireshark </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Macæ¸…ç©ºDNSç¼“å­˜]]></title>
      <url>/2020/06/11/Mac%E6%B8%85%E7%A9%BADNS%E7%BC%93%E5%AD%98/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>å¼€å‘è¿‡ç¨‹ä¸­å¶å°”å‘ç°æŸäº›ç½‘ç»œåœ°å€ä¸èƒ½åŠ è½½é—®é¢˜ã€‚</p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><p>æ¸…é™¤dnsç¼“å­˜ï¼š<br>Tigeræˆ–æ›´ä½ç‰ˆæœ¬ Mac OSï¼š</p>
<p>sudo lookupd -flushcache</p>
<p>Leopardå’ŒSnow Leopardï¼š</p>
<p>sudo dscacheutil -flushcache</p>
<p>è€Œåˆ°äº†Lionã€Mountain Lionå’ŒMavericksï¼š</p>
<p>sudo killall -HUP mDNSResponder</p>
<p>æœ€åæ˜¯Yosemite:</p>
<p>sudo discoveryutil mdnsflushcache</p>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/code_liujun/article/details/51661391" target="_blank" rel="noopener">Macä¸‹æ¸…ç©ºDNSç¼“å­˜</a></p>
]]></content>
      
        <categories>
            
            <category> cmd </category>
            
        </categories>
        
        
        <tags>
            
            <tag> cmd </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Androidæ¥å…¥å®æ—¶ç¾é¢œ]]></title>
      <url>/2020/06/06/Android%E6%8E%A5%E5%85%A5%E5%AE%9E%E6%97%B6%E7%BE%8E%E9%A2%9C/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ç›¸äº²é¡¹ç›®ä»3æœˆä»½ä¸Šçº¿è‡³ä»Šï¼Œä¸ç®¡ä»DAU,UV,ç•™å­˜è¿˜æ˜¯Roi,Arpuç­‰å¤šä¸ªæ–¹é¢éƒ½æœ‰äº†æé€Ÿçš„å¢é•¿ã€‚ä½†æ˜¯åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼ŒåŒæ ·ä¹Ÿé‡åˆ°äº†ä¸€äº›æ¯”è¾ƒé‡è¦çš„é—®é¢˜ã€‚æ¯”å¦‚ç¾é¢œé—®é¢˜ï¼Œåœ¨é¡¹ç›®åˆå§‹ï¼Œæˆ‘ä»¬ä½¿ç”¨äº†Agora RTC SDKç‹¬æœ‰çš„ç¾é¢œæ–¹æ¡ˆï¼Œå¯æ˜¯æˆ‘ä»¬çš„ç”¨æˆ·ä¸€ç›´åé¦ˆç°æœ‰çš„ç¾é¢œæ•ˆæœå¾ˆä¸å¥½ï¼Œç¾é¢œæ•ˆæœä¸èƒ½è°ƒèŠ‚ç­‰é—®é¢˜ã€‚ä»è€Œæˆ‘ä»¬å†³å®šæ¥å…¥ç¬¬ä¸‰æ–¹ç›¸èŠ¯ç¾é¢œsdkï¼Œæ¥æ»¡è¶³æˆ‘ä»¬é¡¹ç›®åœ¨ç¾é¢œæ–¹é¢çš„ç¼ºé™·ã€‚</p>
<h2 id="å®ç°æ–¹æ¡ˆ"><a href="#å®ç°æ–¹æ¡ˆ" class="headerlink" title="å®ç°æ–¹æ¡ˆ"></a>å®ç°æ–¹æ¡ˆ</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2020/06/06/Androidæ¥å…¥å®æ—¶ç¾é¢œ/facejr.png" alt title class>
                <p></p>
            </figure>
<p>é€šè¿‡ä¹‹ä¸Šæ–¹æ¡ˆå›¾ï¼Œæˆ‘ä»¬å¯ä»¥çœ‹å‡ºï¼Œæ•´ä¸ªçš„å®ç°æ–¹æ¡ˆå°±æ˜¯åœ¨ç›¸æœºæ•°æ®é‡‡é›†åï¼Œå¯¹æ•°æ®è¿›è¡Œå®æ—¶ç¾é¢œå¤„ç†ï¼Œå¤„ç†å®Œæˆåï¼ŒåŠæ—¶æ¸²æŸ“å±•ç¤ºã€‚åŒæ—¶ï¼Œæˆ‘ä»¬ä¼šæŠŠæ¸²æŸ“åå¯¹NV21æ•°æ®æ¨æµåˆ°CDNæœåŠ¡å™¨ã€‚åŸç†å¾ˆç®€å•ï¼Œä¸»è¦æ˜¯ç¾é¢œsoçš„å®ç°æ–¹æ³•æ˜¯å…³é”®çŸ¥è¯†ç‚¹ï¼Œè¿™æ¬¡æˆ‘ä»¬ä¸åšè®²è§£ï¼Œåªæè¿°ä¸‹æ¥å…¥çš„æ–¹æ³•å’Œä¸šåŠ¡é€»è¾‘ã€‚</p>
<h3 id="åˆå§‹åŒ–"><a href="#åˆå§‹åŒ–" class="headerlink" title="åˆå§‹åŒ–"></a>åˆå§‹åŒ–</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">fuSetup(context, path, authpack.A());</span><br><span class="line">byte[] buffer = FileUtils.readFile(context, bundlePath);</span><br><span class="line">if (buffer != null) &#123;</span><br><span class="line">	faceunity.fuLoadAIModelFromPackage(buffer, type);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="è½¬åŒ–"><a href="#è½¬åŒ–" class="headerlink" title="è½¬åŒ–"></a>è½¬åŒ–</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> *</span><br><span class="line"> * @param img NV21æ•°æ®</span><br><span class="line"> * @param tex çº¹ç†ID</span><br><span class="line"> * @param w</span><br><span class="line"> * @param h</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">public int onDrawFrame(byte[] img, int tex, int w, int h) &#123;</span><br><span class="line">    if (tex &lt;= 0 || img == null || w &lt;= 0 || h &lt;= 0) &#123;</span><br><span class="line">        Log.e(TAG, &quot;onDrawFrame data null&quot;);</span><br><span class="line">        return 0;</span><br><span class="line">    &#125;</span><br><span class="line"> ...</span><br><span class="line">    int fuTex = faceunity.fuDualInputToTexture(img, tex, flags, w, h, mFrameId++, mItemsArray);</span><br><span class="line"> ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ img å’Œ texçº¹ç†æ˜¯æˆ‘ä»¬ä¼ å…¥çš„åŸå§‹æ•°æ®ï¼ŒmItemsArray åˆ™æ˜¯éœ€è¦ç”¨åˆ°çš„ç¾é¢œæ•ˆæœæ•°ç»„ï¼Œå½“è¯¥æ–¹æ³•è¿”å›æ—¶ï¼Œå¾—åˆ°çš„æ•°æ®ä¾¿æ˜¯ç»è¿‡ç¾é¢œå¤„ç†çš„æ•°æ®ï¼Œè¯¥æ•°æ®ä¼šå†™å›åˆ°æˆ‘ä»¬ä¼ å…¥çš„ img æ•°ç»„ä¸­ï¼Œè€Œè¿”å›çš„ fuTex åˆ™æ˜¯ç»è¿‡ç¾é¢œå¤„ç†çš„æ–°çš„çº¹ç†æ ‡è¯†ã€‚</p>
<h3 id="æ¨æµ"><a href="#æ¨æµ" class="headerlink" title="æ¨æµ"></a>æ¨æµ</h3><p>ç¾é¢œå¤„ç†åï¼Œæ¨ä¸¾åˆ°æœåŠ¡å™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mConsumer.consumeTextureFrame(data.mEffectTextureId,</span><br><span class="line">                        MediaIO.PixelFormat.TEXTURE_2D.intValue(), needsFixWidthAndHeight ? data.videoHeight : data.videoWidth,</span><br><span class="line">                        needsFixWidthAndHeight ? data.videoWidth : data.videoHeight, 0, data.mTimeStamp, data.mTexMatrix);</span><br></pre></td></tr></table></figure>

<h3 id="ç¾é¢œè°ƒæ•´"><a href="#ç¾é¢œè°ƒæ•´" class="headerlink" title="ç¾é¢œè°ƒæ•´"></a>ç¾é¢œè°ƒæ•´</h3><p>è€Œç›¸åº”çš„ç¾é¢œæ•ˆæœå¯ä»¥é€šè¿‡å¦‚ä¸‹æ–¹æ³•è¿›è¡Œè°ƒèŠ‚(å‡åœ¨ faceunity å½“ä¸­)ï¼Œç”±äºæˆ‘ä»¬åœ¨å¯¹æ¯ä¸€å¸§çš„æ—¶å€™è¿›è¡Œäº†ç¾é¢œå‚æ•°è®¾ç½®ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç¾é¢œè®¾ç½®å¯ä»¥éšæ—¶çš„è°ƒèŠ‚å¹¶ç”Ÿæ•ˆã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">faceunity.fuItemSetParam(itemBeauty, BeautificationParams.IS_BEAUTY_ON, 1.0);</span><br><span class="line">// filter_name æ»¤é•œåç§°</span><br><span class="line">faceunity.fuItemSetParam(itemBeauty, BeautificationParams.FILTER_NAME, mFilterName);</span><br><span class="line">// filter_level æ»¤é•œå¼ºåº¦ èŒƒå›´ 0~1 SDK é»˜è®¤ä¸º 1</span><br><span class="line">faceunity.fuItemSetParam(itemBeauty, BeautificationParams.FILTER_LEVEL, mFilterLevel);</span><br></pre></td></tr></table></figure>

<h2 id="ç›¸äº²æ¥å…¥"><a href="#ç›¸äº²æ¥å…¥" class="headerlink" title="ç›¸äº²æ¥å…¥"></a>ç›¸äº²æ¥å…¥</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2020/06/06/Androidæ¥å…¥å®æ—¶ç¾é¢œ/faceman.png" alt title class>
                <p></p>
            </figure>

<p>å…³é”®ä»£ç å¦‚ä¸‹ï¼šç›´æ¥çœ‹æ³¨é‡Šå³å¯ã€‚è¿™é‡Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œç¾é¢œçš„sdkï¼Œåœ¨åˆå§‹åŒ–çš„æ—¶å€™ï¼ŒåŠ è½½äº†è¯ä¹¦ä¿¡æ¯å’Œaiçš„bundleæ–‡ä»¶ï¼Œè¿™ä¸ªå¾ˆå®¹æ˜“äº§ç”Ÿè¯¯å¯¼ï¼Œå®é™…ä¸Šï¼Œaiçš„bundleå¹¶ä¸æ˜¯å¿…é¡»åœ¨è¿™é‡Œè¿›è¡ŒåŠ è½½ï¼Œåœ¨ç›´æ’­çš„è¿‡ç¨‹ä¸­ä¹Ÿå¯ä»¥å†åŠ è½½ç”Ÿæ•ˆã€‚æ‰€ä»¥æˆ‘æŠŠç¾é¢œçš„initFuRenderä¸­çš„ai bundleæ‹†åˆ†äº†å‡ºæ¥ã€‚è¿™æ ·æˆ‘ä»¬å¯ä»¥æå‰åŠ è½½è¯ä¹¦ï¼Œä»»ä½•æ—¶å€™åŠ è½½å¹¶å¼€å¯ç¾é¢œåŠŸèƒ½ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">private fun startBroadcast(uid: Int, local: Boolean, type: Int, userInfo: LiveUserInfo) &#123;</span><br><span class="line">		//åˆ›å»ºSurfaceViewï¼Œæœ¬åœ°view=GLSurfaceView è¿œç«¯view=SurfaceView</span><br><span class="line">        var surfaceView = getSurfaceView(uid,local)</span><br><span class="line">        //åˆå§‹åŒ–ç¾é¢œï¼Œä»¥åŠè®¾ç½®å‚æ•°</span><br><span class="line">        initFaceUnityParam(local, type, surfaceView)</span><br><span class="line">        //321å€’è®¡æ—¶ç›´æ’­å¼€å§‹</span><br><span class="line">       mVideoItemAnchor?.showLoading(local, surfaceView, type)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * ç¾é¢œåˆå§‹åŒ–ï¼Œè®¾ç½®ç¾é¢œå‚æ•°</span><br><span class="line"> */</span><br><span class="line">private fun initFaceUnityParam(local: Boolean, type: Int,surfaceViewLocal: Surf</span><br><span class="line">    //åˆå§‹åŒ–</span><br><span class="line">    faceunityManager?.initFuRender(this)</span><br><span class="line">    //è®¾ç½®view</span><br><span class="line">    faceunityManager?.setGLSurfaceView(surfaceViewLocal as GLSurfaceView)</span><br><span class="line">    //è®¾ç½®ç¾é¢œå‚æ•°</span><br><span class="line">    mVideoItemAnchor?.setFaceunity()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç¾é¢œçš„ç®¡ç†éƒ½åœ¨FaceunityManagerä¸­è¿›è¡Œè®¾ç½®ï¼šä»£ç å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br></pre></td><td class="code"><pre><span class="line">class FaceunityManager &#123;</span><br><span class="line">   </span><br><span class="line">    //åˆå§‹åŒ–ç¾é¢œsdkï¼Œä»¥åŠç›¸å…³ç®¡ç†ç±»</span><br><span class="line">    fun initFuRender(context: Context) &#123;</span><br><span class="line">        // The settings of FURender may be slightly different,</span><br><span class="line">        FURenderer.initFURenderer(context)</span><br><span class="line">       </span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    //è®¾è®¡cameraæ•°æ®ç›¸å…³é‡‡é›†å‚æ•°,å®½ï¼Œé«˜ï¼Œå¸§ç‡ï¼Œæ˜¯å¦æ¨æµ......</span><br><span class="line">    fun setFaceUnityParam(width: Int, height: Int) &#123;</span><br><span class="line">        // set capture width</span><br><span class="line">        mVideoCaptureConfigInfo?.videoCaptureWidth = width</span><br><span class="line">        // set capture height</span><br><span class="line">        mVideoCaptureConfigInfo?.videoCaptureHeight = height</span><br><span class="line">        // set capture fps</span><br><span class="line">        mVideoCaptureConfigInfo?.videoCaptureFps = 30</span><br><span class="line">        // set capture camera</span><br><span class="line">        mVideoCaptureConfigInfo?.cameraFace = Constant.CAMERA_FACING_FRONT</span><br><span class="line">        // set agora consumer format</span><br><span class="line">        mVideoCaptureConfigInfo?.videoCaptureFormat = VideoCaptureConfigInfo.CaptureFormat.TEXTURE_2D</span><br><span class="line">        // set agora consumer type</span><br><span class="line">  		......</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è®¾ç½®å¹¶å¼€å¯ç¾é¢œï¼Œå½“ä¸Šéº¦å€’è®¡æ—¶ï¼Œç›´æ¥è°ƒç”¨</span><br><span class="line">     */</span><br><span class="line">    fun setBeauty() &#123;</span><br><span class="line">        if (this.mGLSurfaceViewLocal == null) &#123;</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        if (mVideoManager?.videoRender != null) &#123;</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        isShowVideo = true</span><br><span class="line">        mVideoManager?.allocate(mVideoCaptureConfigInfo)</span><br><span class="line">        mVideoManager?.setRenderView(this.mGLSurfaceViewLocal)</span><br><span class="line">        startBundle()</span><br><span class="line">        mVideoManager?.attachConnectorToRender(mVideoSource)</span><br><span class="line">        mVideoManager?.startCapture()</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * å¼€å¯ç¾é¢œï¼Œå¯¹bundleè¿›è¡Œæ ¡éªŒï¼Œæ ¡éªŒæˆåŠŸï¼ŒåŠ è½½bundleï¼Œå¼€å¯ç¾é¢œåŠŸèƒ½</span><br><span class="line">     * å¦‚æœbundleä¸‹è½½æˆåŠŸåï¼Œä¹Ÿä½¿ç”¨æ­¤æ–¹æ³•å¼€å¯ç¾é¢œåŠŸèƒ½</span><br><span class="line">     */</span><br><span class="line">    fun startBundle(fileName: String) &#123;</span><br><span class="line">            val isVerity = isVerify(mFaceBundlePath, fileName + &quot;_md5&quot;)</span><br><span class="line">            if (isVerity) &#123;</span><br><span class="line">                mVideoManager?.runInRenderThread &#123;</span><br><span class="line">                    if (!mFUInit) &#123;</span><br><span class="line">                        mFURenderer?.onSurfaceCreated()</span><br><span class="line">                        mFUInit = true</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            mVideoManager?.connectEffectHandler(mEffectHandler)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

]]></content>
      
        <categories>
            
            <category> Video </category>
            
        </categories>
        
        
        <tags>
            
            <tag> FaceUnity </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è‡ªå®šä¹‰åœ†è§’çŸ©å½¢æ¸å˜èƒŒæ™¯è¾¹æ¡†]]></title>
      <url>/2020/05/22/%E8%87%AA%E5%AE%9A%E4%B9%89%E5%9C%86%E8%A7%92%E7%9F%A9%E5%BD%A2%E6%B8%90%E5%8F%98%E8%83%8C%E6%99%AF%E8%BE%B9%E6%A1%86/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>è‡ªå®šä¹‰ä¸€ä¸ªlayoutå®ç°èƒŒæ™¯çš„æ¸å˜ä»¥åŠè¾¹æ¡†çš„æ¸å˜ï¼ŒåŒæ—¶åŠåœ†è§’ã€‚æ•ˆæœå›¾å¦‚ä¸‹ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2020/05/22/è‡ªå®šä¹‰åœ†è§’çŸ©å½¢æ¸å˜èƒŒæ™¯è¾¹æ¡†/image.jpg" alt="image" title class>
                <p>image</p>
            </figure>


<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br></pre></td><td class="code"><pre><span class="line">import android.content.Context</span><br><span class="line">import android.graphics.*</span><br><span class="line">import android.util.AttributeSet</span><br><span class="line">import android.widget.LinearLayout</span><br><span class="line"></span><br><span class="line">class GradientBackgroundView  @JvmOverloads constructor(</span><br><span class="line">        context: Context,</span><br><span class="line">        attrs: AttributeSet? = null,</span><br><span class="line">        defStyleAttr: Int = 0</span><br><span class="line">) : LinearLayout(context, attrs, defStyleAttr)  &#123;</span><br><span class="line">    private val mPaint = Paint(Paint.ANTI_ALIAS_FLAG)</span><br><span class="line">    private var mPath = Path()</span><br><span class="line">    private var backGradient: LinearGradient? = null</span><br><span class="line">    private var strokeGradient: LinearGradient? = null</span><br><span class="line">    private val radiusArray = floatArrayOf(0f, 0f, 0f, 0f, 0f, 0f, 0f, 0f)</span><br><span class="line"></span><br><span class="line">    init &#123;</span><br><span class="line">        //è®¾ç½®æŠ—é”¯é½¿</span><br><span class="line">        mPaint.isAntiAlias = true</span><br><span class="line">        //è®¾ç½®é˜²æŠ–åŠ¨</span><br><span class="line">        mPaint.isDither = true</span><br><span class="line">        mPaint.style = Paint.Style.FILL</span><br><span class="line">    &#125;</span><br><span class="line">    /**</span><br><span class="line">     * è®¾ç½®å››ä¸ªè§’çš„åœ†è§’åŠå¾„</span><br><span class="line">     */</span><br><span class="line">    fun setRadius(leftTop: Float, rightTop: Float, rightBottom: Float, leftBottom: Float) &#123;</span><br><span class="line">        radiusArray[0] = leftTop</span><br><span class="line">        radiusArray[1] = leftTop</span><br><span class="line">        radiusArray[2] = rightTop</span><br><span class="line">        radiusArray[3] = rightTop</span><br><span class="line">        radiusArray[4] = rightBottom</span><br><span class="line">        radiusArray[5] = rightBottom</span><br><span class="line">        radiusArray[6] = leftBottom</span><br><span class="line">        radiusArray[7] = leftBottom</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun setGradient(backGradientColors: IntArray?, strokeGradientcolors: IntArray?) &#123;</span><br><span class="line">        backGradient = LinearGradient(0f, 0f, width.toFloat(), 0f, backGradientColors, null, Shader.TileMode.CLAMP)</span><br><span class="line">        strokeGradient = LinearGradient(0f, 0f, width.toFloat(), 0f, strokeGradientcolors, null, Shader.TileMode.CLAMP)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    fun showBackgroundColor() &#123;</span><br><span class="line">        setBackgroundColor(Color.TRANSPARENT)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    override fun onDraw(canvas: Canvas) &#123;</span><br><span class="line">        super.onDraw(canvas)</span><br><span class="line">        if (canvas == null) &#123;</span><br><span class="line">            return</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.save()</span><br><span class="line">        //æ¸å˜è¾¹æ¡†</span><br><span class="line">        mPaint.shader = strokeGradient</span><br><span class="line">        mPaint.style = Paint.Style.STROKE</span><br><span class="line">        mPaint.strokeWidth = 4f</span><br><span class="line">        mPath = Path()</span><br><span class="line">        mPath.addRoundRect(RectF(0f, 0f, width.toFloat(), height.toFloat()), radiusArray, Path.Direction.CW)</span><br><span class="line">        canvas.clipPath(mPath)</span><br><span class="line">        canvas.drawPath(mPath, mPaint)</span><br><span class="line"></span><br><span class="line">        //æ¸å˜èƒŒæ™¯è‰²</span><br><span class="line">        mPaint.shader = backGradient</span><br><span class="line">        mPaint.style = Paint.Style.FILL</span><br><span class="line">        mPath = Path()</span><br><span class="line">        mPath.addRoundRect(RectF(2f, 2f, (width - 2).toFloat(), (height - 2).toFloat()), radiusArray, Path.Direction.CW)</span><br><span class="line">        canvas.clipPath(mPath)</span><br><span class="line">        canvas.drawPath(mPath, mPaint)</span><br><span class="line">        canvas.restore()</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">mBarrageLayout.setRadius(mRadius,0,0,mRadius);</span><br><span class="line">mBarrageLayout.setGradient(new int[]&#123;0xffff53a3,0xfd316a&#125;,new int[]&#123;0xffFFC92B,0x979797&#125;);</span><br><span class="line">mBarrageLayout.showBackgroundColor();</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.cnblogs.com/everhad/p/6161083.html" target="_blank" rel="noopener">ä¸€ç§androidä¸­å®ç°â€œåœ†è§’çŸ©å½¢â€çš„æ–¹æ³•</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> View </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é¢œè‰²é€æ˜åº¦åå…­è¿›åˆ¶]]></title>
      <url>/2019/12/06/%E9%A2%9C%E8%89%B2%E9%80%8F%E6%98%8E%E5%BA%A6%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>00æ˜¯å®Œå…¨é€æ˜(ç™¾åˆ†ç™¾é€æ˜)ï¼ŒFFå°±æ˜¯å®Œå…¨<strong>ä¸</strong>é€æ˜</p>

<table>
<thead>
<tr>
  <th align="left" style="width: 300px;">é€æ˜åº¦</th>
  <th align="left" style="width: 300px;">16è¿›åˆ¶è¡¨ç¤º</th>
</tr>
</thead>
<tbody><tr>
  <td align="left">100â€ƒ%</td>
  <td align="left">00</td>
</tr>
<tr>
  <td align="left">99â€‚â€‚â€ƒ%</td>
  <td align="left">03</td>
</tr>
<tr>
  <td align="left">98â€‚â€‚â€ƒ%</td>
  <td align="left">05</td>
</tr>
<tr>
  <td align="left">97â€‚â€‚â€ƒ%</td>
  <td align="left">07</td>
</tr>
<tr>
  <td align="left">96â€‚â€‚â€ƒ%</td>
  <td align="left">0A</td>
</tr>
<tr>
  <td align="left">95â€‚â€‚â€ƒ%</td>
  <td align="left">0D</td>
</tr>
<tr>
  <td align="left">94â€‚â€‚â€ƒ%</td>
  <td align="left">0F</td>
</tr>
<tr>
  <td align="left">93â€‚â€‚â€ƒ%</td>
  <td align="left">12</td>
</tr>
<tr>
  <td align="left">92â€‚â€‚â€ƒ%</td>
  <td align="left">14</td>
</tr>
<tr>
  <td align="left">91â€‚â€‚â€ƒ%</td>
  <td align="left">17</td>
</tr>
<tr>
  <td align="left">90â€‚â€‚â€ƒ%</td>
  <td align="left">1A</td>
</tr>
<tr>
  <td align="left">89â€‚â€‚â€ƒ%</td>
  <td align="left">1C</td>
</tr>
<tr>
  <td align="left">88â€‚â€‚â€ƒ%</td>
  <td align="left">1E</td>
</tr>
<tr>
  <td align="left">87â€‚â€‚â€ƒ%</td>
  <td align="left">21</td>
</tr>
<tr>
  <td align="left">86â€‚â€‚â€ƒ%</td>
  <td align="left">24</td>
</tr>
<tr>
  <td align="left">85â€‚â€‚â€ƒ%</td>
  <td align="left">26</td>
</tr>
<tr>
  <td align="left">84â€‚â€‚â€ƒ%</td>
  <td align="left">29</td>
</tr>
<tr>
  <td align="left">83â€‚â€‚â€ƒ%</td>
  <td align="left">2B</td>
</tr>
<tr>
  <td align="left">82â€‚â€‚â€ƒ%</td>
  <td align="left">2E</td>
</tr>
<tr>
  <td align="left">81â€‚â€‚â€ƒ%</td>
  <td align="left">30</td>
</tr>
<tr>
  <td align="left">80â€‚â€‚â€ƒ%</td>
  <td align="left">33</td>
</tr>
<tr>
  <td align="left">79â€‚â€‚â€ƒ%</td>
  <td align="left">36</td>
</tr>
<tr>
  <td align="left">78â€‚â€‚â€ƒ%</td>
  <td align="left">38</td>
</tr>
<tr>
  <td align="left">77â€‚â€‚â€ƒ%</td>
  <td align="left">3B</td>
</tr>
<tr>
  <td align="left">76â€‚â€‚â€ƒ%</td>
  <td align="left">3D</td>
</tr>
<tr>
  <td align="left">75â€‚â€‚â€ƒ%</td>
  <td align="left">40</td>
</tr>
<tr>
  <td align="left">74â€‚â€‚â€ƒ%</td>
  <td align="left">42</td>
</tr>
<tr>
  <td align="left">73â€‚â€‚â€ƒ%</td>
  <td align="left">45</td>
</tr>
<tr>
  <td align="left">72â€‚â€‚â€ƒ%</td>
  <td align="left">47</td>
</tr>
<tr>
  <td align="left">71â€‚â€‚â€ƒ%</td>
  <td align="left">4A</td>
</tr>
<tr>
  <td align="left">70â€‚â€‚â€ƒ%</td>
  <td align="left">4D</td>
</tr>
<tr>
  <td align="left">69â€‚â€‚â€ƒ%</td>
  <td align="left">4F</td>
</tr>
<tr>
  <td align="left">68â€‚â€‚â€ƒ%</td>
  <td align="left">52</td>
</tr>
<tr>
  <td align="left">67â€‚â€‚â€ƒ%</td>
  <td align="left">54</td>
</tr>
<tr>
  <td align="left">66â€‚â€‚â€ƒ%</td>
  <td align="left">57</td>
</tr>
<tr>
  <td align="left">65â€‚â€‚â€ƒ%</td>
  <td align="left">59</td>
</tr>
<tr>
  <td align="left">64â€‚â€‚â€ƒ%</td>
  <td align="left">5C</td>
</tr>
<tr>
  <td align="left">63â€‚â€‚â€ƒ%</td>
  <td align="left">5E</td>
</tr>
<tr>
  <td align="left">62â€‚â€‚â€ƒ%</td>
  <td align="left">61</td>
</tr>
<tr>
  <td align="left">61â€‚â€‚â€ƒ%</td>
  <td align="left">63</td>
</tr>
<tr>
  <td align="left">60â€‚â€‚â€ƒ%</td>
  <td align="left">66</td>
</tr>
<tr>
  <td align="left">59â€‚â€‚â€ƒ%</td>
  <td align="left">69</td>
</tr>
<tr>
  <td align="left">58â€‚â€‚â€ƒ%</td>
  <td align="left">6B</td>
</tr>
<tr>
  <td align="left">57â€‚â€‚â€ƒ%</td>
  <td align="left">6E</td>
</tr>
<tr>
  <td align="left">56â€‚â€‚â€ƒ%</td>
  <td align="left">70</td>
</tr>
<tr>
  <td align="left">55â€‚â€‚â€ƒ%</td>
  <td align="left">73</td>
</tr>
<tr>
  <td align="left">54â€‚â€‚â€ƒ%</td>
  <td align="left">75</td>
</tr>
<tr>
  <td align="left">53â€‚â€‚â€ƒ%</td>
  <td align="left">78</td>
</tr>
<tr>
  <td align="left">52â€‚â€‚â€ƒ%</td>
  <td align="left">7A</td>
</tr>
<tr>
  <td align="left">51â€‚â€‚â€ƒ%</td>
  <td align="left">7D</td>
</tr>
<tr>
  <td align="left">50â€‚â€‚â€ƒ%</td>
  <td align="left">80</td>
</tr>
<tr>
  <td align="left">49â€‚â€‚â€ƒ%</td>
  <td align="left">82</td>
</tr>
<tr>
  <td align="left">48â€‚â€‚â€ƒ%</td>
  <td align="left">85</td>
</tr>
<tr>
  <td align="left">47â€‚â€‚â€ƒ%</td>
  <td align="left">87</td>
</tr>
<tr>
  <td align="left">46â€‚â€‚â€ƒ%</td>
  <td align="left">8A</td>
</tr>
<tr>
  <td align="left">45â€‚â€‚â€ƒ%</td>
  <td align="left">8C</td>
</tr>
<tr>
  <td align="left">44â€‚â€‚â€ƒ%</td>
  <td align="left">8F</td>
</tr>
<tr>
  <td align="left">43â€‚â€‚â€ƒ%</td>
  <td align="left">91</td>
</tr>
<tr>
  <td align="left">42â€‚â€‚â€ƒ%</td>
  <td align="left">94</td>
</tr>
<tr>
  <td align="left">41â€‚â€‚â€ƒ%</td>
  <td align="left">96</td>
</tr>
<tr>
  <td align="left">40â€‚â€‚â€ƒ%</td>
  <td align="left">99</td>
</tr>
<tr>
  <td align="left">39â€‚â€‚â€ƒ%</td>
  <td align="left">9C</td>
</tr>
<tr>
  <td align="left">38â€‚â€‚â€ƒ%</td>
  <td align="left">9E</td>
</tr>
<tr>
  <td align="left">37â€‚â€‚â€ƒ%</td>
  <td align="left">A1</td>
</tr>
<tr>
  <td align="left">36â€‚â€‚â€ƒ%</td>
  <td align="left">A3</td>
</tr>
<tr>
  <td align="left">35â€‚â€‚â€ƒ%</td>
  <td align="left">A6</td>
</tr>
<tr>
  <td align="left">34â€‚â€‚â€ƒ%</td>
  <td align="left">A8</td>
</tr>
<tr>
  <td align="left">33â€‚â€‚â€ƒ%</td>
  <td align="left">AB</td>
</tr>
<tr>
  <td align="left">32â€‚â€‚â€ƒ%</td>
  <td align="left">AD</td>
</tr>
<tr>
  <td align="left">31â€‚â€‚â€ƒ%</td>
  <td align="left">B0</td>
</tr>
<tr>
  <td align="left">30â€‚â€‚â€ƒ%</td>
  <td align="left">B3</td>
</tr>
<tr>
  <td align="left">29â€‚â€‚â€ƒ%</td>
  <td align="left">B5</td>
</tr>
<tr>
  <td align="left">28â€‚â€‚â€ƒ%</td>
  <td align="left">B8</td>
</tr>
<tr>
  <td align="left">27â€‚â€‚â€ƒ%</td>
  <td align="left">BA</td>
</tr>
<tr>
  <td align="left">26â€‚â€‚â€ƒ%</td>
  <td align="left">BD</td>
</tr>
<tr>
  <td align="left">25â€‚â€‚â€ƒ%</td>
  <td align="left">BF</td>
</tr>
<tr>
  <td align="left">24â€‚â€‚â€ƒ%</td>
  <td align="left">C2</td>
</tr>
<tr>
  <td align="left">23â€‚â€‚â€ƒ%</td>
  <td align="left">C4</td>
</tr>
<tr>
  <td align="left">22â€‚â€‚â€ƒ%</td>
  <td align="left">C7</td>
</tr>
<tr>
  <td align="left">21â€‚â€‚â€ƒ%</td>
  <td align="left">C9</td>
</tr>
<tr>
  <td align="left">20â€‚â€‚â€ƒ%</td>
  <td align="left">CC</td>
</tr>
<tr>
  <td align="left">19â€‚â€‚â€ƒ%</td>
  <td align="left">CF</td>
</tr>
<tr>
  <td align="left">18â€‚â€‚â€ƒ%</td>
  <td align="left">D1</td>
</tr>
<tr>
  <td align="left">17â€‚â€‚â€ƒ%</td>
  <td align="left">D4</td>
</tr>
<tr>
  <td align="left">16â€‚â€‚â€ƒ%</td>
  <td align="left">D6</td>
</tr>
<tr>
  <td align="left">15â€‚â€‚â€ƒ%</td>
  <td align="left">D9</td>
</tr>
<tr>
  <td align="left">14â€‚â€‚â€ƒ%</td>
  <td align="left">DB</td>
</tr>
<tr>
  <td align="left">13â€‚â€‚â€ƒ%</td>
  <td align="left">DE</td>
</tr>
<tr>
  <td align="left">12â€‚â€‚â€ƒ%</td>
  <td align="left">E0</td>
</tr>
<tr>
  <td align="left">11â€‚â€‚â€ƒ%</td>
  <td align="left">E3</td>
</tr>
<tr>
  <td align="left">10â€‚â€‚â€ƒ%</td>
  <td align="left">E6</td>
</tr>
<tr>
  <td align="left">9â€‚â€ƒâ€ƒ%</td>
  <td align="left">E8</td>
</tr>
<tr>
  <td align="left">8â€‚â€ƒâ€ƒ%</td>
  <td align="left">EB</td>
</tr>
<tr>
  <td align="left">7â€‚â€ƒâ€ƒ%</td>
  <td align="left">ED</td>
</tr>
<tr>
  <td align="left">6â€‚â€ƒâ€ƒ%</td>
  <td align="left">F0</td>
</tr>
<tr>
  <td align="left">5â€‚â€ƒâ€ƒ%</td>
  <td align="left">F2</td>
</tr>
<tr>
  <td align="left">4â€‚â€ƒâ€ƒ%</td>
  <td align="left">F5</td>
</tr>
<tr>
  <td align="left">3â€‚â€ƒâ€ƒ%</td>
  <td align="left">F7</td>
</tr>
<tr>
  <td align="left">2â€‚â€ƒâ€ƒ%</td>
  <td align="left">FA</td>
</tr>
<tr>
  <td align="left">1â€‚â€ƒâ€ƒ%</td>
  <td align="left">FC</td>
</tr>
<tr>
  <td align="left">0â€‚â€ƒâ€ƒ%</td>
  <td align="left">FF</td>
</tr>
</tbody></table>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/hewuzhao/article/details/78821954" target="_blank" rel="noopener">æœ€å…¨çš„Android é¢œè‰²é€æ˜åº¦</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Color </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android æ²‰æµ¸å¼è§£æ]]></title>
      <url>/2019/11/19/Android-%E6%B2%89%E6%B5%B8%E5%BC%8F%E8%A7%A3%E6%9E%90/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>é¦–å…ˆæˆ‘ä»¬å¾—äº†è§£ä»€ä¹ˆæ˜¯é€æ˜çŠ¶æ€æ ä»¥åŠä»€ä¹ˆæ˜¯æ²‰æµ¸å¼çŠ¶æ€æ ï¼Œä»¥åŠå…¶åŒºåˆ«ï¼Œå›½å†…ä¹ æƒ¯ç§°å˜è‰²çŠ¶æ€æ ä¸ºæ²‰æµ¸å¼çŠ¶æ€æ ï¼Œä½†æ˜¯ä¸¤è€…æ˜¯æœ‰æœ¬è´¨åŒºåˆ«çš„:</p>
<ul>
<li>æ²‰æµ¸å¼ï¼š<br>Android 4.4ä¸­ï¼Œæ²‰æµ¸å¼ä½“éªŒå¾—åˆ°äº†å†æ¬¡å¼ºåŒ–ï¼Œæä¾›äº†ä¸€ç§â€œå…¨å±æ¨¡å¼â€(Full-screen Immersive Mode)ã€‚å…¨å±æ¨¡å¼åˆåˆ†ä¸¤ç§ï¼Œä¸€ç§å«åæ’¤å¼ (Lean Back)ï¼Œå¦ä¸€ç§å«åšæ²‰æµ¸å¼(Immersive)ã€‚åæ’¤å¼å·²ç»åœ¨ä¹‹å‰çš„ç³»ç»Ÿä¸­è¢«å¹¿æ³›ä½¿ç”¨äº†â€”â€”å½“ä½ åœ¨ä¼˜é…·APPä¸­è§‚çœ‹è§†é¢‘æ—¶ï¼Œå¤§éƒ¨åˆ†æ—¶é—´æ‰‹æŒ‡æ˜¯ä¸ä¼šå»ç¢°å±å¹•çš„ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œè™šæ‹Ÿé”®å’ŒçŠ¶æ€æ éƒ½ä¼šè‡ªåŠ¨éšè—ï¼Œä½†å½“ä½ è§¦æ‘¸å±å¹•çš„æ—¶å€™ï¼Œå®ƒä»¬åˆä¼šå‡ºç°ã€‚è€Œæ–°åŠ å…¥çš„æ²‰æµ¸å¼åˆ™ä¸å¤ªä¸€æ ·ï¼Œåœ¨æ²‰æµ¸å¼å…¨å±çŠ¶æ€ä¸‹ï¼Œå¯¹å±å¹•çš„æ“ä½œå¹¶ä¸ä¼šå”¤å‡ºç³»ç»Ÿæ ã€‚æƒ³è¦å”¤å‡ºç³»ç»Ÿæ ï¼Œä½ å¿…é¡»ä»å±å¹•çš„ä¸Š/ä¸‹è¾¹ç¼˜å‘å±å¹•å†…åˆ’å…¥ã€‚æ²‰æµ¸å¼çš„å…¨å±çŠ¶æ€æ›´é€‚åˆæ¸¸æˆå’Œé˜…è¯»è¿™æ ·çš„åº”ç”¨ã€‚</li>
</ul>
<ul>
<li>å˜è‰²ï¼š<ul>
<li>é€æ˜ï¼š<br>Android 4.4 ä¸€ä¸ªå¾ˆé‡è¦çš„æ”¹å˜å°±æ˜¯é€æ˜ç³»ç»Ÿæ .ã€‚æ–°çš„ç³»ç»Ÿæ æ˜¯æ¸å˜é€æ˜çš„, å¯ä»¥æœ€å¤§é™åº¦çš„å…è®¸å±å¹•æ˜¾ç¤ºæ›´å¤šå†…å®¹, ä¹Ÿå¯ä»¥è®©ç³»ç»Ÿæ å’Œ Action Bar èä¸ºä¸€ä½“, ä»…ä»…ç•™ä¸‹æœ€ä½é™åº¦çš„èƒŒæ™¯ä¿æŠ¤ä»¥å…é€šçŸ¥é€šçŸ¥æ å†…å®¹å’Œ Action Bar æ–‡å­—/å›¾æ ‡éš¾ä»¥è¯†åˆ«ã€‚è°·æ­ŒæŠŠè¿™ç§æ•ˆæœç§°ä¹‹ä¸ºï¼šTranslucent Barã€‚<br>Translucent Bar æ˜¯ Android å¯¹ Edge to Edge å°è¯•ä¸­çš„ä¸€ä¸ª, ä¹Ÿæ˜¯æœ€å®¹æ˜“è¢«ç”¨æˆ·æ³¨æ„åˆ°çš„. å®ƒçš„åˆå§‹ç›®çš„å°±æ˜¯è¦æœ€å¤§åŒ–å¯è§†é¢ç§¯å’Œæ·¡åŒ–ç³»ç»Ÿç•Œé¢çš„å­˜åœ¨æ„Ÿã€‚</li>
<li>å˜è‰²ï¼š<br>Android 5.0åå¯ä»¥è‡ªç”±è®¾ç½®çŠ¶æ€æ é¢œè‰²ï¼Œæ‰€ä»¥ä¹Ÿå¯ä»¥ç§°ä½œå˜è‰²çŠ¶æ€æ ã€‚</li>
</ul>
</li>
</ul>
<p>æ‰€ä»¥æˆ‘ä»¬è¿™é‡Œè®²çš„æ˜¯å˜è‰²çŠ¶æ€æ ï¼Œå˜è‰²çŠ¶æ€æ å°±æ˜¯å¦‚ä½•å¯¹ StatusBarï¼ˆçŠ¶æ€æ ï¼‰çš„èƒŒæ™¯é€æ˜æ“ä½œï¼›å½“æˆ‘ä»¬æ‰“å¼€åº”ç”¨æ—¶ï¼Œä¸€èˆ¬å¦‚æœä¸å¯¹çŠ¶æ€æ è¿›è¡Œä¿®æ”¹çš„è¯ï¼Œåœ¨å±å¹•çš„é¡¶éƒ¨æœ‰ä¸€æ¡é»˜è®¤çš„(é»‘è‰²ã€ç°è‰²ã€å…¶ä»–)çŠ¶æ€æ ï¼Œå’Œåº”ç”¨çš„é£æ ¼éå¸¸ä¸åè°ƒï¼Œä¸ºäº†æä¾›æ›´å¥½çš„ç•Œé¢äº¤äº’ï¼Œç„¶ååœ¨çŠ¶æ€æ çš„ä½ç½®æ˜¾ç¤ºæˆ‘ä»¬è‡ªå®šä¹‰çš„é¢œè‰²ï¼Œé€šå¸¸ä¸ºåº”ç”¨çš„TitleBarçš„é¢œè‰²ï¼Œæˆ–è€…æ˜¯å°†åº”ç”¨çš„æ•´ä½“çš„ä¸€å¼ å›¾ç‰‡ä¹Ÿå æ®åˆ°çŠ¶æ€æ ä¸­ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬å°±éœ€è¦å¯¹çŠ¶æ€æ çš„èƒŒæ™¯è¿›è¡Œæ“ä½œã€‚<br><a href="http://www.androidchina.net/3520.html" target="_blank" rel="noopener">çŠ¶æ€æ è¯¦è§£ç‚¹å‡»</a></p>
<h2 id="StatusBarã€TitleBar"><a href="#StatusBarã€TitleBar" class="headerlink" title="StatusBarã€TitleBar"></a>StatusBarã€TitleBar</h2><p>StatusBaræ˜¯çŠ¶æ€æ ï¼Œå®ƒå¤„äºå±å¹•çš„æœ€é¡¶éƒ¨ï¼Œæ­£å¸¸æƒ…å†µä¸‹å®ƒæ˜¯æ˜¾ç¤ºçš„ï¼Œå®ƒå’ŒTitleBarä¹‹é—´æ²¡æœ‰ç›´æ¥çš„å…³ç³»ï¼›</p>
<p>TitleBaræ˜¯æ ‡é¢˜æ ï¼Œæ¯”å¦‚ActionBarã€ToolBarï¼Œç´§ä½äºçŠ¶æ€æ çš„ä¸‹æ–¹æ˜¾ç¤ºã€‚</p>
<p>ActionBarï¼ˆæ“ä½œæ ï¼‰ æ˜¯åœ¨Android 3.0(API 11ï¼‰ä¸­åŠ å…¥åˆ°SKä¸­çš„ã€‚</p>
<p>ToolBarï¼ˆå·¥å…·æ ï¼‰æ˜¯ Android 5.0 æ¨å‡ºçš„ä¸€ä¸ª Material Design é£æ ¼çš„å¯¼èˆªæ§ä»¶ ,ç”¨æ¥å–ä»£ä¹‹å‰çš„ Actionbar ã€‚ä¸ Actionbar ç›¸æ¯”ï¼ŒToolbar æ˜æ˜¾è¦çµæ´»çš„å¤šã€‚å®ƒä¸åƒ Actionbar ä¸€æ ·ï¼Œä¸€å®šè¦å›ºå®šåœ¨Activityçš„é¡¶éƒ¨ï¼Œè€Œæ˜¯å¯ä»¥æ”¾åˆ°ç•Œé¢çš„ä»»æ„ä½ç½®ã€‚ä¸ActionBarç›¸æ¯”æ˜¾ç¤ºæ•ˆæœè·ŸActionBarå¹¶æ²¡æœ‰åŒºåˆ«ã€‚ä½†ä¼˜ç‚¹æ˜¯è‡ªå®šä¹‰è§†å›¾çš„æ“ä½œæ›´åŠ ç®€å•ï¼š</p>
<ul>
<li>1.è®¾ç½®å¯¼èˆªæ å›¾æ ‡ï¼›</li>
<li>2.è®¾ç½®Appçš„logoï¼›</li>
<li>3.æ”¯æŒè®¾ç½®æ ‡é¢˜å’Œå­æ ‡é¢˜ï¼›</li>
<li>4.æ”¯æŒæ·»åŠ ä¸€ä¸ªæˆ–å¤šä¸ªçš„è‡ªå®šä¹‰æ§ä»¶ï¼›</li>
<li>5.æ”¯æŒAction Menuï¼›</li>
</ul>
<h3 id="ActionBar"><a href="#ActionBar" class="headerlink" title="ActionBar"></a>ActionBar</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;AppCompatActivity_ActionBarTheme&quot; parent=&quot;Theme.AppCompat.Light.DarkActionBar&quot;&gt;</span><br><span class="line">    &lt;!-- Customize your theme here. --&gt;</span><br><span class="line">    &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">    ActionBar actionBar = getSupportActionBar();</span><br><span class="line">    actionBar.setTitle(&quot;ActionBar Title&quot;);</span><br><span class="line">actionBar.setBackgroundDrawable(getDrawable(R.drawable.ic_launcher_background));</span><br><span class="line">    actionBar.setCustomView(R.layout.activity_actionbar);</span><br><span class="line">    actionBar.setDisplayOptions(ActionBar.DISPLAY_SHOW_CUSTOM);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¤‡æ³¨</strong>æ˜¯getSupportActionBar()è¿˜æ˜¯é»˜è®¤çš„getActionBar()ï¼Œè¿˜å¯ä»¥è‡ªå®šä¹‰title view</p>
<h3 id="Toolbar"><a href="#Toolbar" class="headerlink" title="Toolbar"></a>Toolbar</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">&lt;style name=&quot;AppCompatActivity_ToolBarTheme&quot; parent=&quot;Theme.AppCompat.Light&quot;&gt;</span><br><span class="line">    &lt;item name=&quot;windowActionBar&quot;&gt;false&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;windowNoTitle&quot;&gt;true&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;colorPrimary&quot;&gt;@color/colorPrimary&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimaryDark&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;colorAccent&quot;&gt;@color/colorAccent&lt;/item&gt;</span><br><span class="line">    &lt;item name=&quot;android:textAllCaps&quot;&gt;false&lt;/item&gt;</span><br><span class="line">&lt;/style&gt;</span><br><span class="line"></span><br><span class="line">&lt;android.support.v7.widget.Toolbar</span><br><span class="line">    android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">    android:orientation=&quot;vertical&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:background=&quot;?attr/colorPrimary&quot;</span><br><span class="line">    android:layout_height=&quot;200dp&quot;</span><br><span class="line">    app:title=&quot;æ ‡é¢˜&quot;</span><br><span class="line">    android:minHeight=&quot;?attr/actionBarSize&quot;&gt;</span><br><span class="line">    &lt;TextView</span><br><span class="line">        android:id=&quot;@+id/toolbar_view&quot;</span><br><span class="line">        android:layout_width=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:textColor=&quot;#ff0000&quot;</span><br><span class="line">        android:text=&quot;è‡ªå®šä¹‰View&quot;/&gt;</span><br><span class="line">&lt;/android.support.v7.widget.Toolbar&gt;</span><br><span class="line"></span><br><span class="line">@Override</span><br><span class="line">protected void onCreate(Bundle savedInstanceState) &#123;</span><br><span class="line">    super.onCreate(savedInstanceState);</span><br><span class="line">	//ä¹Ÿå¯ä»¥è¿™é‡Œè®¾ç½®toolbar</span><br><span class="line">    Toolbar toolBar = findViewById(R.id.toolbar);</span><br><span class="line">    //ä¸»æ ‡é¢˜ï¼Œå¿…é¡»åœ¨setSupportActionBarä¹‹å‰è®¾ç½®ï¼Œå¦åˆ™æ— æ•ˆï¼Œå¦‚æœæ”¾åœ¨å…¶ä»–ä½ç½®ï¼Œåˆ™ç›´æ¥setTitleå³å¯</span><br><span class="line">    toolBar.setTitle(&quot;ToolBar Title&quot;);</span><br><span class="line">    //ç”¨toolbaræ›¿æ¢actionbar</span><br><span class="line">    setSupportActionBar(toolBar);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>å¤‡æ³¨</strong>å¯ä»¥åœ¨xmlè®¾ç½®å±æ€§ï¼Œä¹Ÿä»¥åœ¨ä»£ç ä¸­è®¾ç½®ï¼›è¿˜å¯ä»¥åœ¨xmlæ·»åŠ viewï¼›è¿˜å¯ä»¥å¯¹Toolbarè‡ªå®šä¹‰ï¼›ä½¿ç”¨Toolbarè¦éšè—ActionBarï¼›</p>
<p><a href="https://www.jianshu.com/p/81d0bcb282cb" target="_blank" rel="noopener">ActionBarå’ŒToolBarï¼šä½¿ç”¨è¯¦ç»†ç‚¹å‡»</a></p>
<h3 id="itemå±æ€§é‡Šä¹‰"><a href="#itemå±æ€§é‡Šä¹‰" class="headerlink" title="itemå±æ€§é‡Šä¹‰"></a>itemå±æ€§é‡Šä¹‰</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/11/19/Android-æ²‰æµ¸å¼è§£æ/item.png" alt="item" title class>
                <p>item</p>
            </figure>
<p>æ¯”è¾ƒé€šç”¨çš„å‡ ä¸ªå±æ€§ï¼Œå¼•ç”¨äº†ç½‘ä¸Šçš„ä¸€ä¸ªæˆªå›¾ï¼›æ›´å¤šè¯¦ç»†è§ï¼š<br><a href="https://blog.csdn.net/jinmie0193/article/details/80723724" target="_blank" rel="noopener">å„å±æ€§æŒ‡å®šé¢œè‰²çš„ä½ç½®</a></p>
<h2 id="çŠ¶æ€æ èƒŒæ™¯è‰²"><a href="#çŠ¶æ€æ èƒŒæ™¯è‰²" class="headerlink" title="çŠ¶æ€æ èƒŒæ™¯è‰²"></a>çŠ¶æ€æ èƒŒæ™¯è‰²</h2><h3 id="Android4-4ï¼ˆ-lt-API-19ï¼‰"><a href="#Android4-4ï¼ˆ-lt-API-19ï¼‰" class="headerlink" title="Android4.4ï¼ˆ&lt; API 19ï¼‰"></a>Android4.4ï¼ˆ&lt; API 19ï¼‰</h3><p>åœ¨Androidç³»ç»Ÿ4.4ä»¥å‰ï¼ŒçŠ¶æ€æ çš„èƒŒæ™¯è‰²å’Œå­—ä½“é¢œè‰²éƒ½æ˜¯ä¸èƒ½æ”¹å˜çš„ï¼Œæˆ‘ä»¬å¯ä»¥å¯¹ StatusBar è¿›è¡Œå…¨å±æˆ–éšè—æ“ä½œã€‚</p>
<ul>
<li><p>é…ç½®theme</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">android:theme=&quot;@android:style/Theme.NoTitleBar.Fullscreen&quot;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»£ç å…¨å±</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">getWindow().setFlags(WindowManager.LayoutParams. FLAG_FULLSCREEN ,</span><br><span class="line">                WindowManager.LayoutParams. FLAG_FULLSCREEN);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Android4-4ï¼ˆAPI-19ï¼‰-Android-5-0ï¼ˆ-lt-API-21ï¼‰"><a href="#Android4-4ï¼ˆAPI-19ï¼‰-Android-5-0ï¼ˆ-lt-API-21ï¼‰" class="headerlink" title="Android4.4ï¼ˆAPI 19ï¼‰- Android 5.0ï¼ˆ&lt; API 21ï¼‰"></a>Android4.4ï¼ˆAPI 19ï¼‰- Android 5.0ï¼ˆ&lt; API 21ï¼‰</h3><ul>
<li><p>themeï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&lt;item name=&quot;android:windowTranslucentStatus&quot;&gt;true&lt;/item&gt;</span><br><span class="line"></span><br><span class="line">&lt;!-- å¤±æ•ˆ --&gt;</span><br><span class="line">   &lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimary&lt;/item&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»£ç ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>è®¾ç½®å¦‚ä¸Šå±æ€§åï¼Œæˆ‘ä»¬ä¼šå‘ç°çŠ¶æ€æ çš„èƒŒæ™¯å˜äº†ï¼Œå…¶å®ä¸æ˜¯å˜äº†ï¼Œè€Œæ˜¯æ ‡é¢˜æ çš„å¸ƒå±€å»¶ä¼¸åˆ°äº†çŠ¶æ€æ é‡Œã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/11/19/Android-æ²‰æµ¸å¼è§£æ/translu.png" alt title class>
                <p></p>
            </figure>
<p>å¦‚æœæ˜¯å›¾ç‰‡æµ¸å…¥çš„è¯ï¼šç›´æ¥ç»™TitleBaræˆ–è€…è‡ªå®šä¹‰viewè®¾ç½®èƒŒæ™¯å›¾å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">Toolbar toolBar = findViewById(R.id.toolbar);</span><br><span class="line">toolBar.setBackgroundResource(R.mipmap.title_back);</span><br></pre></td></tr></table></figure>

<figure class="image-box">
                <img src="http://nunu03.github.io/2019/11/19/Android-æ²‰æµ¸å¼è§£æ/img_header.jpg" alt title class>
                <p></p>
            </figure>
<h3 id="Android-5-0ï¼ˆ-gt-API-21ï¼‰"><a href="#Android-5-0ï¼ˆ-gt-API-21ï¼‰" class="headerlink" title="Android 5.0ï¼ˆ&gt;= API 21ï¼‰"></a>Android 5.0ï¼ˆ&gt;= API 21ï¼‰</h3><ul>
<li><p>themeï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;item name=&quot;colorPrimaryDark&quot;&gt;@color/colorPrimary&lt;/item&gt;</span><br></pre></td></tr></table></figure>
</li>
<li><p>ä»£ç ï¼š</p>
  <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getWindow().setStatusBarColor(getResources().getColor(android.R.color.holo_red_light));</span><br></pre></td></tr></table></figure>

</li>
</ul>
<p>å¦‚æœæ˜¯å›¾ç‰‡æµ¸å…¥çš„è¯ï¼šç›´æ¥åœ¨ä¸»é¢˜ä¸­è®¾ç½®çŠ¶æ€æ èƒŒæ™¯è‰²é€æ˜å³å¯,åŒç†ç›´æ¥ç»™TitleBaræˆ–è€…è‡ªå®šä¹‰viewè®¾ç½®èƒŒæ™¯å›¾å³å¯ï¼›æ•ˆæœå›¾åŒä¸Šã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;item name=&quot;android:windowTranslucentStatus&quot;&gt;true&lt;/item&gt;</span><br><span class="line">&lt;item name = &quot;android:statusBarColor&quot;&gt;@android:color/transparent&lt;/item&gt;</span><br><span class="line">	</span><br><span class="line">Toolbar toolBar = findViewById(R.id.toolbar);</span><br><span class="line">toolBar.setBackgroundResource(R.mipmap.title_back);</span><br></pre></td></tr></table></figure>

<h3 id="android-fitsSystemWindows-â€trueâ€"><a href="#android-fitsSystemWindows-â€trueâ€" class="headerlink" title="android:fitsSystemWindows=â€trueâ€"></a>android:fitsSystemWindows=â€trueâ€</h3><p>å½“æˆ‘ä»¬è®¾ç½®äº†android:windowTranslucentStatus=trueåï¼Œæˆ‘ä»¬å‘ç°Toolbarå†…å®¹è¢«StatusBarè¦†ç›–ï¼Œç›¸å½“äºToolbaræ•´ä½“å¸ƒå±€ä¸Šç§»äº†ï¼Œæ€ä¹ˆè§£å†³ï¼Ÿæˆ‘ä»¬å¯ä»¥è®¾ç½®android:fitsSystemWindows=â€trueâ€ï¼Œä½†æ˜¯è¿™æ—¶å€™æˆ‘ä»¬å‘ç°ï¼Œæˆ‘ä»¬çš„StatusBarçš„èƒŒæ™¯è‰²å®æ•ˆäº†ã€‚å¦‚ä½•è§£å†³ï¼Ÿæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡å¾€Windowçª—å£çš„decorViewæ·»åŠ ä¸€ä¸ªView,è®©å®ƒå¤§å°ä¸ç³»ç»ŸçŠ¶æ€æ ä¸€æ ·ï¼Œç„¶åè®¾ç½®è¿™ä¸ªviewçš„èƒŒæ™¯ï¼Œå°±å¯ä»¥å®ç°ä¿®æ”¹çŠ¶æ€æ é¢œè‰²çš„æ•ˆæœäº†ã€‚ä½†æ˜¯è¿™ç§åªé€‚åˆä¿®æ”¹StatusBarçš„èƒŒæ™¯è‰²ï¼Œå¦‚æœæ˜¯å›¾ç‰‡æµ¸å…¥ï¼Œå°±ä¸å¯ä»¥äº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">ViewGroup decorViewGroup = (ViewGroup) getWindow().getDecorView();</span><br><span class="line">View statusBarView = new View(getWindow().getContext());</span><br><span class="line">int statusBarHeight = getStatusBarHeight(getWindow().getContext());</span><br><span class="line">FrameLayout.LayoutParams params = new FrameLayout.LayoutParams(FrameLayout.LayoutParams.MATCH_PARENT, statusBarHeight);</span><br><span class="line">params.gravity = Gravity.TOP;</span><br><span class="line">statusBarView.setLayoutParams(params);</span><br><span class="line">statusBarView.setBackgroundResource(R.color.colorPrimary);</span><br><span class="line">decorViewGroup.addView(statusBarView);</span><br><span class="line">        </span><br><span class="line">private static int getStatusBarHeight(Context context) &#123;</span><br><span class="line">    int statusBarHeight = 0;</span><br><span class="line">    Resources res = context.getResources();</span><br><span class="line">    int resourceId = res.getIdentifier(&quot;status_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);</span><br><span class="line">    if (resourceId &gt; 0) &#123;</span><br><span class="line">        statusBarHeight = res.getDimensionPixelSize(resourceId);</span><br><span class="line">    &#125;</span><br><span class="line">    return statusBarHeight;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="TitleBarå›¾ç‰‡æµ¸å…¥"><a href="#TitleBarå›¾ç‰‡æµ¸å…¥" class="headerlink" title="TitleBarå›¾ç‰‡æµ¸å…¥"></a>TitleBarå›¾ç‰‡æµ¸å…¥</h3><p>æˆ‘ä»¬ä»ä¸Šé¢çš„æ•ˆæœå›¾ï¼Œå¯ä»¥çœ‹å‡ºï¼Œå›¾ç‰‡æµ¸å…¥æ—¶ï¼Œç›¸å½“äºTitleBarç§»åŠ¨åˆ°äº†çŠ¶æ€æ çš„ä¸‹é¢ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ ‡é¢˜å¯èƒ½ä¸çŠ¶æ€æ çš„å›¾æ ‡é‡å ï¼Œé‚£æ€ä¹ˆåŠå‘¢ï¼Ÿä¸Šè¾¹è¯´äº†android:fitsSystemWindows=â€trueâ€ä¸è¡Œï¼Œéœ€è¦è®¾ç½®çŠ¶æ€æ èƒŒæ™¯è‰²å¤±æ•ˆï¼Œå…¶å®æˆ‘ä»¬è¿™ä¸ªæ—¶å€™ï¼Œå¯ä»¥åœ¨TitleBarä¸Šæ·»åŠ ä¸€ä¸ªå’ŒçŠ¶æ€æ å¤§å°çš„é€æ˜viewå³å¯ï¼ŒTitleBarè®¾ç½®paddingTop ä¹Ÿå¯ä»¥ï¼Œä½†æ˜¯ä½ éœ€è¦é‡æ–°è®¾ç½®TitleBarçš„é«˜åº¦ï¼Œè¿™æ ·çš„è¯å°±ä¸å¦‚ç¬¬ä¸€ç§æ–¹æ¡ˆåˆé€‚äº†ã€‚<br>è®¾è®¡ä¸€ä¸ªxmlï¼Œè¿™ä¸ªåŒ…å«äº†TitleBarå’Œé»˜è®¤çš„StatusBarçš„æ›¿ä»£viewã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;RelativeLayout xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;</span><br><span class="line">    android:layout_width=&quot;match_parent&quot;</span><br><span class="line">    android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">    android:orientation=&quot;vertical&quot;&gt;</span><br><span class="line"></span><br><span class="line">    &lt;ImageView</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_alignBottom=&quot;@+id/toolbar&quot;</span><br><span class="line">        android:layout_alignTop=&quot;@+id/statusBartop&quot;</span><br><span class="line">        android:scaleType=&quot;fitXY&quot;</span><br><span class="line">        android:src=&quot;@mipmap/title_back&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;LinearLayout</span><br><span class="line">        android:id=&quot;@+id/statusBartop&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:background=&quot;#00000000&quot;</span><br><span class="line">        android:orientation=&quot;horizontal&quot; /&gt;</span><br><span class="line"></span><br><span class="line">    &lt;android.support.v7.widget.Toolbar</span><br><span class="line">        android:id=&quot;@+id/toolbar&quot;</span><br><span class="line">        android:layout_width=&quot;match_parent&quot;</span><br><span class="line">        android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">        android:layout_below=&quot;@+id/statusBartop&quot;</span><br><span class="line">        &gt;</span><br><span class="line"></span><br><span class="line">        &lt;TextView</span><br><span class="line">            android:layout_width=&quot;match_parent&quot;</span><br><span class="line">            android:layout_height=&quot;wrap_content&quot;</span><br><span class="line">            android:text=&quot; dkfslfjslfsjflsjflsf&quot;</span><br><span class="line">            android:textColor=&quot;@android:color/holo_red_dark&quot;</span><br><span class="line"></span><br><span class="line">            android:textSize=&quot;16dp&quot; /&gt;</span><br><span class="line">    &lt;/android.support.v7.widget.Toolbar&gt;</span><br><span class="line">&lt;/RelativeLayout&gt;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæˆ‘ä»¬åœ¨ä»£ç ä¸­è¿›è¡Œè®¾ç½®å³å¯ï¼šç‰ˆæœ¬å¤§äº18ï¼Œå³4.4ä»¥ä¸Šå³å¯ï¼Œ4.4ä¸€ä¸‹ä¸å­˜åœ¨æ²‰æµ¸å¼æ¨¡å¼ï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">int sysVersion = Build.VERSION.SDK_INT;</span><br><span class="line">if (sysVersion &gt; Build.VERSION_CODES.JELLY_BEAN_MR2 ) &#123;</span><br><span class="line">    int result = 0;</span><br><span class="line">    int resourceId = getResources().getIdentifier(&quot;status_bar_height&quot;, &quot;dimen&quot;, &quot;android&quot;);</span><br><span class="line">    if (resourceId &gt; 0) &#123;</span><br><span class="line">        result = getResources().getDimensionPixelSize(resourceId);</span><br><span class="line">    &#125;</span><br><span class="line">    LinearLayout toptop = this.findViewById(R.id.statusBartop);</span><br><span class="line">    RelativeLayout.LayoutParams para = new RelativeLayout.LayoutParams(this.getWindowManager().getDefaultDisplay().getWidth(), result);</span><br><span class="line">    //è®¾ç½®ä¿®æ”¹åçš„å¸ƒå±€ã€‚</span><br><span class="line">    toptop.setLayoutParams(para);</span><br><span class="line"></span><br><span class="line">    Toolbar toolbar = this.findViewById(R.id.toolbar);</span><br><span class="line">    RelativeLayout.LayoutParams paraBar = new RelativeLayout.LayoutParams(this.getWindowManager().getDefaultDisplay().getWidth(), 150);</span><br><span class="line">    paraBar.addRule(RelativeLayout.BELOW,R.id.statusBartop);</span><br><span class="line">    toolbar.setLayoutParams(paraBar);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æœ€ååˆ«å¿˜è®°è®¾ç½®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">&lt;item name=&quot;android:windowTranslucentStatus&quot;&gt;true&lt;/item&gt;</span><br><span class="line">æˆ–è€…åœ¨ä»£ç ä¸­ï¼š</span><br><span class="line">getWindow().addFlags(WindowManager.LayoutParams.FLAG_TRANSLUCENT_STATUS);</span><br></pre></td></tr></table></figure>

<p>çœ‹ä¸‹æ•ˆæœå›¾ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/11/19/Android-æ²‰æµ¸å¼è§£æ/image.jpg" alt title class>
                <p></p>
            </figure>



]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Title </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Toastæºç è§£è¯»]]></title>
      <url>/2019/10/11/Toast%E8%A7%A3%E8%AF%BB/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>Toast(åå¸)ï¼Œè¿™ä¸ªæ§ä»¶çš„ç”¨è¯ç›¸å½“å‡†ç¡®,å®ƒæ‰€è¡¨ç°å‡ºæ¥çš„ç‰¹å¾æ­£æ˜¯åå¸ä¼¼çš„å¼¹å‡ºæ•ˆæœï¼Œä½¿ç”¨éå¸¸ç®€å•ä¾¿æ·ã€‚<br>è€Œä¸”Toastå¼€å‘æ—¶æ¯”è¾ƒå¸¸ç”¨çš„ä¸€ä¸ªç±»äº†ï¼Œç”¨å®ƒç»™ç”¨æˆ·å¼¹æç¤ºä¿¡æ¯å’Œç•Œé¢åé¦ˆï¼Œæœ‰æ—¶å€™ä¹Ÿç”¨å®ƒæ¥ä½œä¸ºè¾…åŠ©è°ƒè¯•çš„æ‰‹æ®µã€‚ä½†æ˜¯ç”¨å¾—å¤šäº†ï¼Œæœ‰æ—¶å€™è‡ªç„¶ä¼šé‡åˆ°å„ç§å„æ ·çš„é—®é¢˜ï¼Œæ¯”å¦‚é‡å¤ç‚¹å‡»é—®é¢˜ï¼Œå¼¹æ¡†ä½ç½®ï¼Œæ˜¾ç¤ºæ—¶é—´ç­‰ï¼Œè¿™æ—¶å€™æˆ‘ä»¬å°±è¦å¯¹è¿è¡Œæœºåˆ¶ä»¥åŠæºç è¿›è¡Œäº†è§£ã€‚</p>
<h2 id="ç‰¹ç‚¹"><a href="#ç‰¹ç‚¹" class="headerlink" title="ç‰¹ç‚¹"></a>ç‰¹ç‚¹</h2><p>1.Toastä¸æ˜¯Viewï¼Œå®ƒç”¨äºå¸®åŠ©åˆ›å»ºå¹¶å±•ç¤ºåŒ…å«ä¸€æ¡å°æ¶ˆæ¯çš„Viewï¼›</p>
<p>2.å®ƒçš„è®¾è®¡ç†å¿µæ˜¯å°½é‡ä¸æƒ¹çœ¼ï¼Œä½†åˆèƒ½å±•ç¤ºæƒ³è®©ç”¨æˆ·çœ‹åˆ°çš„ä¿¡æ¯ï¼›</p>
<p>3.è¢«å±•ç¤ºæ—¶ï¼Œæµ®åœ¨åº”ç”¨ç•Œé¢ä¹‹ä¸Šï¼›</p>
<p>4.æ°¸è¿œä¸ä¼šè·å–åˆ°ç„¦ç‚¹ï¼›</p>
<p>5.å¤§å°å–å†³äºæ¶ˆæ¯çš„é•¿åº¦ï¼›</p>
<p>6.è¶…æ—¶åä¼šè‡ªåŠ¨æ¶ˆå¤±ï¼›</p>
<p>7.å¯ä»¥è‡ªå®šä¹‰æ˜¾ç¤ºåœ¨å±å¹•ä¸Šçš„ä½ç½®ï¼ˆé»˜è®¤å·¦å³å±…ä¸­æ˜¾ç¤ºåœ¨é è¿‘å±å¹•åº•éƒ¨çš„ä½ç½®ï¼›</p>
<p>8.å¯ä»¥ä½¿ç”¨è‡ªå®šä¹‰å¸ƒå±€ï¼Œä¹Ÿåªæœ‰åœ¨è‡ªå®šä¹‰å¸ƒå±€çš„æ—¶å€™æ‰éœ€è¦ç›´æ¥è°ƒç”¨Toastçš„æ„é€ æ–¹æ³•ï¼Œå…¶å®ƒæ—¶å€™éƒ½æ˜¯ä½¿ç”¨ makeTextæ–¹æ³•æ¥åˆ›å»ºToastï¼›</p>
<p>9.Toastå¼¹å‡ºåå½“å‰Activityä¼šä¿æŒå¯è§æ€§å’Œå¯äº¤äº’æ€§ï¼›</p>
<p>10.ä½¿ç”¨cancelæ–¹æ³•å¯ä»¥ç«‹å³å°†å·²æ˜¾ç¤ºçš„Toastå…³é—­è®©æœªæ˜¾ç¤ºçš„Toastä¸å†æ˜¾ç¤ºï¼›</p>
<p>11.Toast ä¹Ÿç®—æ˜¯ä¸€ä¸ªã€Œé€šçŸ¥ã€ï¼Œå¦‚æœå¼¹å‡ºçŠ¶æ€æ¶ˆæ¯åæœŸæœ›å¾—åˆ°ç”¨æˆ·å“åº”ï¼Œåº”è¯¥ä½¿ç”¨ Notificationã€‚</p>
<h2 id="æºç è§£æ"><a href="#æºç è§£æ" class="headerlink" title="æºç è§£æ"></a>æºç è§£æ</h2><h3 id="åˆ›å»º"><a href="#åˆ›å»º" class="headerlink" title="åˆ›å»º"></a>åˆ›å»º</h3><h4 id="new-Toast"><a href="#new-Toast" class="headerlink" title="new Toast"></a>new Toast</h4><blockquote>
<p>Toast.class</p>
<p>è¿™é‡Œé¢åˆå§‹åŒ–äº†TN,TNæ˜¯ä»€ä¹ˆï¼Ÿä¸€ä¼šä¸‹é¢ä¼šè®²é“</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Constructs an empty Toast object.  If looper is null, Looper.myLooper() is used.</span><br><span class="line"> * @hide</span><br><span class="line"> */</span><br><span class="line">public Toast(@NonNull Context context, @Nullable Looper looper) &#123;</span><br><span class="line">    mContext = context;</span><br><span class="line">    mTN = new TN(context.getPackageName(), looper);</span><br><span class="line">    mTN.mY = context.getResources().getDimensionPixelSize(</span><br><span class="line">            com.android.internal.R.dimen.toast_y_offset);</span><br><span class="line">    mTN.mGravity = context.getResources().getInteger(</span><br><span class="line">            com.android.internal.R.integer.config_toastDefaultGravity);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="Toast-makeText"><a href="#Toast-makeText" class="headerlink" title="Toast.makeText"></a>Toast.makeText</h4><blockquote>
<p>Toast.class</p>
<p>è¿™é‡Œé¢è•´å«äº†å¾ˆå¤šçš„ä¿¡æ¯,XMLå¸ƒå±€,textæ˜¾ç¤ºæ–‡æ¡ˆï¼Œæ˜¾ç¤ºæ—¶é•¿ç­‰ç­‰</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">Toast.class</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Make a standard toast to display using the specified looper.</span><br><span class="line"> * If looper is null, Looper.myLooper() is used.</span><br><span class="line"> * @hide</span><br><span class="line"> */</span><br><span class="line">public static Toast makeText(@NonNull Context context, @Nullable Looper looper,</span><br><span class="line">        @NonNull CharSequence text, @Duration int duration) &#123;</span><br><span class="line">    Toast result = new Toast(context, looper);</span><br><span class="line"></span><br><span class="line">    LayoutInflater inflate = (LayoutInflater)</span><br><span class="line">            context.getSystemService(Context.LAYOUT_INFLATER_SERVICE);</span><br><span class="line">    View v = inflate.inflate(com.android.internal.R.layout.transient_notification, null);</span><br><span class="line">    TextView tv = (TextView)v.findViewById(com.android.internal.R.id.message);</span><br><span class="line">    tv.setText(text);</span><br><span class="line"></span><br><span class="line">    result.mNextView = v;</span><br><span class="line">    result.mDuration = duration;</span><br><span class="line"></span><br><span class="line">    return result;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ˜¾ç¤º"><a href="#æ˜¾ç¤º" class="headerlink" title="æ˜¾ç¤º"></a>æ˜¾ç¤º</h3><blockquote>
<p>Toast.class</p>
<p>è¿™é‡Œæ˜¯showä¸€ä¸ªToast,æ˜¾ç¤ºçš„æ—¶å€™æŠŠtnï¼Œå’ŒåŒ…åç›¸å…³ä¿¡æ¯ä¼ é€’ç»™serviceï¼Œå°†æˆ‘ä»¬éœ€è¦æ˜¾ç¤ºçš„toastæ”¾åˆ°è¿™ä¸ªæœåŠ¡çš„é˜Ÿåˆ—ä¸­è¿›è¡Œæ˜¾ç¤ºã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Show the view for the specified duration.</span><br><span class="line"> */</span><br><span class="line">public void show() &#123;</span><br><span class="line">    if (mNextView == null) &#123;</span><br><span class="line">        throw new RuntimeException(&quot;setView must have been called&quot;);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    INotificationManager service = getService();</span><br><span class="line">    String pkg = mContext.getOpPackageName();</span><br><span class="line">    TN tn = mTN;</span><br><span class="line">    tn.mNextView = mNextView;</span><br><span class="line"></span><br><span class="line">    try &#123;</span><br><span class="line">        service.enqueueToast(pkg, tn, mDuration);</span><br><span class="line">    &#125; catch (RemoteException e) &#123;</span><br><span class="line">        // Empty</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>NotificationManagerService.class</p>
<p>Toastå…¥ç³»ç»Ÿé˜Ÿåˆ—çš„æ–¹æ³•:åœ¨Toastçš„TNå¯¹è±¡ä¸­ï¼Œä¼šè°ƒç”¨service.enqueueToast(String pkg,ItransientNotification callback,int duaraion)æ¥å°†åˆ›å»ºå‡ºæ¥çš„Toastæ”¾å…¥NotificationManagerServiceçš„ToastRecordé˜Ÿåˆ—ä¸­ã€‚<br>NotificationManagerServiceæ˜¯ä¸€ä¸ªè¿è¡Œåœ¨SystemServerè¿›ç¨‹ä¸­çš„ä¸€ä¸ªå®ˆæŠ¤è¿›ç¨‹ï¼ŒAndroidå¤§éƒ¨åˆ†çš„IPCé€šä¿¡éƒ½æ˜¯é€šè¿‡Binderæœºåˆ¶ï¼Œè¿™ä¸ªå®ˆæŠ¤è¿›ç¨‹åƒä¸€ä¸ªä¸»ç®¡ä¸€æ ·ï¼Œæ‰€æœ‰çš„ä¸‹é¢çš„äººéƒ½å¿…é¡»è®©å®ƒè¿›è¡Œè°ƒåº¦ï¼Œç„¶åç”±å®ƒæ¥è¿›è¡Œæ˜¾ç¤ºæˆ–è€…æ˜¯éšè—ã€‚</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public void enqueueToast(String pkg, ITransientNotification callback, int duration)</span><br><span class="line">&#123;</span><br><span class="line">    .........................................</span><br><span class="line"></span><br><span class="line">    synchronized (mToastQueue) &#123;</span><br><span class="line">        int callingPid = Binder.getCallingPid();</span><br><span class="line">        long callingId = Binder.clearCallingIdentity();</span><br><span class="line">        try &#123;</span><br><span class="line">            ToastRecord record;</span><br><span class="line">            int index;</span><br><span class="line">            // All packages aside from the android package can enqueue one toast at a time</span><br><span class="line">            //æŸ¥çœ‹è¿™ä¸ªtoastæ˜¯å¦åœ¨å½“å‰é˜Ÿåˆ—ä¸­ï¼Œæœ‰çš„è¯å°±è¿”å›ç´¢å¼•</span><br><span class="line">            if (!isSystemToast) &#123;</span><br><span class="line">                index = indexOfToastPackageLocked(pkg);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">                index = indexOfToastLocked(pkg, callback);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            // If the package already has a toast, we update its toast</span><br><span class="line">            // in the queue, we don&apos;t move it to the end of the queue.</span><br><span class="line">            //å¦‚æœè¿™ä¸ªindexå¤§äºç­‰äº0ï¼Œè¯´æ˜è¿™ä¸ªtoastå·²ç»åœ¨è¿™ä¸ªé˜Ÿåˆ—ä¸­äº†ï¼Œåªéœ€è¦æ›´æ–°æ˜¾ç¤ºæ—¶é—´å°±å¯ä»¥äº†</span><br><span class="line">            //å½“ç„¶è¿™é‡Œcallbackæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œpkgæ˜¯ä¸€ä¸ªStringï¼Œæ‰€ä»¥æ¯”è¾ƒçš„æ—¶å€™æ˜¯å¯¹è±¡çš„æ¯”è¾ƒ</span><br><span class="line">            if (index &gt;= 0) &#123;</span><br><span class="line">                record = mToastQueue.get(index);</span><br><span class="line">                record.update(duration);</span><br><span class="line">                try &#123;</span><br><span class="line">                    record.callback.hide();</span><br><span class="line">                &#125; catch (RemoteException e) &#123;</span><br><span class="line">                &#125;</span><br><span class="line">                record.update(callback);</span><br><span class="line">            &#125; else &#123;</span><br><span class="line">            		//å°†è¿™ä¸ªtoastå°è£…æˆToastRecordå¯¹è±¡ï¼Œæ”¾åˆ°é˜Ÿåˆ—ä¸­</span><br><span class="line">                Binder token = new Binder();</span><br><span class="line">                mWindowManagerInternal.addWindowToken(token, TYPE_TOAST, DEFAULT_DISPLAY);</span><br><span class="line">                record = new ToastRecord(callingPid, pkg, callback, duration, token);</span><br><span class="line">                mToastQueue.add(record);</span><br><span class="line">                index = mToastQueue.size() - 1;</span><br><span class="line">            &#125;</span><br><span class="line">            keepProcessAliveIfNeededLocked(callingPid);</span><br><span class="line">            // If it&apos;s at index 0, it&apos;s the current toast.  It doesn&apos;t matter if it&apos;s</span><br><span class="line">            // new or just been updated.  Call back and tell it to show itself.</span><br><span class="line">            // If the callback fails, this will remove it from the list, so don&apos;t</span><br><span class="line">            // assume that it&apos;s valid after this.</span><br><span class="line">            //å¦‚æœè¿”å›çš„ç´¢å¼•æ˜¯0ï¼Œè¯´æ˜å½“å‰çš„è¿™ä¸ªå­˜åœ¨çš„toastå°±åœ¨å¯¹å¤´ï¼Œç›´æ¥æ˜¾ç¤º</span><br><span class="line">            if (index == 0) &#123;</span><br><span class="line">                showNextToastLocked();</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; finally &#123;</span><br><span class="line">            Binder.restoreCallingIdentity(callingId);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">void showNextToastLocked() &#123;</span><br><span class="line">    ToastRecord record = mToastQueue.get(0);</span><br><span class="line">    ....................................  </span><br><span class="line">    record.callback.show(record.token);</span><br><span class="line">    scheduleTimeoutLocked(record);</span><br><span class="line">    return;</span><br><span class="line">    ...................................    </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void scheduleTimeoutLocked(ToastRecord r)</span><br><span class="line">&#123;</span><br><span class="line">    mHandler.removeCallbacksAndMessages(r);</span><br><span class="line">    Message m = Message.obtain(mHandler, MESSAGE_TIMEOUT, r);</span><br><span class="line">    long delay = r.duration == Toast.LENGTH_LONG ? LONG_DELAY : SHORT_DELAY;</span><br><span class="line">    mHandler.sendMessageDelayed(m, delay);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void handleTimeout(ToastRecord record)</span><br><span class="line">&#123;</span><br><span class="line">        int index = indexOfToastLocked(record.pkg, record.callback);</span><br><span class="line">        if (index &gt;= 0) &#123;</span><br><span class="line">            cancelToastLocked(index);</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="å–æ¶ˆ"><a href="#å–æ¶ˆ" class="headerlink" title="å–æ¶ˆ"></a>å–æ¶ˆ</h3><blockquote>
<p>NotificationManagerService.class</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">void cancelToastLocked(int index) &#123;</span><br><span class="line">    ToastRecord record = mToastQueue.get(index);</span><br><span class="line">    try &#123;</span><br><span class="line">        record.callback.hide();</span><br><span class="line">    &#125; catch (RemoteException e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    ToastRecord lastToast = mToastQueue.remove(index);</span><br><span class="line">    mWindowManagerInternal.removeWindowToken(lastToast.token, true, DEFAULT_DISPLAY);</span><br><span class="line"></span><br><span class="line">    keepProcessAliveIfNeededLocked(record.pid);</span><br><span class="line">    if (mToastQueue.size() &gt; 0) &#123;</span><br><span class="line">        // Show the next one. If the callback fails, this will remove</span><br><span class="line">        // it from the list, so don&apos;t assume that the list hasn&apos;t changed</span><br><span class="line">        // after this point.</span><br><span class="line">        showNextToastLocked();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="TN"><a href="#TN" class="headerlink" title="TN"></a>TN</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br></pre></td><td class="code"><pre><span class="line">private static class TN extends ITransientNotification.Stub &#123;</span><br><span class="line">    private final WindowManager.LayoutParams mParams = new WindowManager.LayoutParams();</span><br><span class="line">.................................................................</span><br><span class="line"></span><br><span class="line">    TN(String packageName, @Nullable Looper looper) &#123;</span><br><span class="line">        // XXX This should be changed to use a Dialog, with a Theme.Toast</span><br><span class="line">        // defined that sets up the layout params appropriately.</span><br><span class="line">        final WindowManager.LayoutParams params = mParams;</span><br><span class="line">        params.height = WindowManager.LayoutParams.WRAP_CONTENT;</span><br><span class="line">        params.width = WindowManager.LayoutParams.WRAP_CONTENT;</span><br><span class="line">        params.format = PixelFormat.TRANSLUCENT;</span><br><span class="line">        params.windowAnimations = com.android.internal.R.style.Animation_Toast;</span><br><span class="line">        params.type = WindowManager.LayoutParams.TYPE_TOAST;</span><br><span class="line">        params.setTitle(&quot;Toast&quot;);</span><br><span class="line">        params.flags = WindowManager.LayoutParams.FLAG_KEEP_SCREEN_ON</span><br><span class="line">                | WindowManager.LayoutParams.FLAG_NOT_FOCUSABLE</span><br><span class="line">                | WindowManager.LayoutParams.FLAG_NOT_TOUCHABLE;</span><br><span class="line"></span><br><span class="line">        mPackageName = packageName;</span><br><span class="line"></span><br><span class="line">        if (looper == null) &#123;</span><br><span class="line">            // Use Looper.myLooper() if looper is not specified.</span><br><span class="line">            looper = Looper.myLooper();</span><br><span class="line">            if (looper == null) &#123;</span><br><span class="line">                throw new RuntimeException(</span><br><span class="line">                        &quot;Can&apos;t toast on a thread that has not called Looper.prepare()&quot;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        mHandler = new Handler(looper, null) &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void handleMessage(Message msg) &#123;</span><br><span class="line">                switch (msg.what) &#123;</span><br><span class="line">                    case SHOW: &#123;</span><br><span class="line">                        IBinder token = (IBinder) msg.obj;</span><br><span class="line">                        handleShow(token);</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    case HIDE: &#123;</span><br><span class="line">                        handleHide();</span><br><span class="line">                        // Don&apos;t do this in handleHide() because it is also invoked by</span><br><span class="line">                        // handleShow()</span><br><span class="line">                        mNextView = null;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                    case CANCEL: &#123;</span><br><span class="line">                        handleHide();</span><br><span class="line">                        // Don&apos;t do this in handleHide() because it is also invoked by</span><br><span class="line">                        // handleShow()</span><br><span class="line">                        mNextView = null;</span><br><span class="line">                        try &#123;</span><br><span class="line">                            getService().cancelToast(mPackageName, TN.this);</span><br><span class="line">                        &#125; catch (RemoteException e) &#123;</span><br><span class="line">                        &#125;</span><br><span class="line">                        break;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * schedule handleShow into the right thread</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void show(IBinder windowToken) &#123;</span><br><span class="line">        if (localLOGV) Log.v(TAG, &quot;SHOW: &quot; + this);</span><br><span class="line">        mHandler.obtainMessage(SHOW, windowToken).sendToTarget();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * schedule handleHide into the right thread</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void hide() &#123;</span><br><span class="line">        if (localLOGV) Log.v(TAG, &quot;HIDE: &quot; + this);</span><br><span class="line">        mHandler.obtainMessage(HIDE).sendToTarget();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void cancel() &#123;</span><br><span class="line">        if (localLOGV) Log.v(TAG, &quot;CANCEL: &quot; + this);</span><br><span class="line">        mHandler.obtainMessage(CANCEL).sendToTarget();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void handleShow(IBinder windowToken) &#123;</span><br><span class="line">        .................................................</span><br><span class="line">            if (mView != mNextView) &#123;</span><br><span class="line">            // remove the old view if necessary</span><br><span class="line">            handleHide();</span><br><span class="line">            mView = mNextView;</span><br><span class="line">            Context context = mView.getContext().getApplicationContext();</span><br><span class="line">            String packageName = mView.getContext().getOpPackageName();</span><br><span class="line">            if (context == null) &#123;</span><br><span class="line">                context = mView.getContext();</span><br><span class="line">            &#125;</span><br><span class="line">            mWM = (WindowManager)context.getSystemService(Context.WINDOW_SERVICE);</span><br><span class="line">            // We can resolve the Gravity here by using the Locale for getting</span><br><span class="line">            // the layout direction</span><br><span class="line">            final Configuration config = mView.getContext().getResources().getConfiguration();</span><br><span class="line">            final int gravity = Gravity.getAbsoluteGravity(mGravity, config.getLayoutDirection());</span><br><span class="line">            mParams.gravity = gravity;</span><br><span class="line">            if ((gravity &amp; Gravity.HORIZONTAL_GRAVITY_MASK) == Gravity.FILL_HORIZONTAL) &#123;</span><br><span class="line">                mParams.horizontalWeight = 1.0f;</span><br><span class="line">            &#125;</span><br><span class="line">            if ((gravity &amp; Gravity.VERTICAL_GRAVITY_MASK) == Gravity.FILL_VERTICAL) &#123;</span><br><span class="line">                mParams.verticalWeight = 1.0f;</span><br><span class="line">            &#125;</span><br><span class="line">            mParams.x = mX;</span><br><span class="line">            mParams.y = mY;</span><br><span class="line">            mParams.verticalMargin = mVerticalMargin;</span><br><span class="line">            mParams.horizontalMargin = mHorizontalMargin;</span><br><span class="line">            mParams.packageName = packageName;</span><br><span class="line">            mParams.hideTimeoutMilliseconds = mDuration ==</span><br><span class="line">                Toast.LENGTH_LONG ? LONG_DURATION_TIMEOUT : SHORT_DURATION_TIMEOUT;</span><br><span class="line">            mParams.token = windowToken;</span><br><span class="line">            if (mView.getParent() != null) &#123;</span><br><span class="line">                if (localLOGV) Log.v(TAG, &quot;REMOVE! &quot; + mView + &quot; in &quot; + this);</span><br><span class="line">                mWM.removeView(mView);</span><br><span class="line">            &#125;</span><br><span class="line">            if (localLOGV) Log.v(TAG, &quot;ADD! &quot; + mView + &quot; in &quot; + this);</span><br><span class="line">            // Since the notification manager service cancels the token right</span><br><span class="line">            // after it notifies us to cancel the toast there is an inherent</span><br><span class="line">            // race and we may attempt to add a window after the token has been</span><br><span class="line">            // invalidated. Let us hedge against that.</span><br><span class="line">            try &#123;</span><br><span class="line">                mWM.addView(mView, mParams);</span><br><span class="line">                trySendAccessibilityEvent();</span><br><span class="line">            &#125; catch (WindowManager.BadTokenException e) &#123;</span><br><span class="line">                /* ignore */</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private void trySendAccessibilityEvent() &#123;</span><br><span class="line">        AccessibilityManager accessibilityManager =</span><br><span class="line">                AccessibilityManager.getInstance(mView.getContext());</span><br><span class="line">        if (!accessibilityManager.isEnabled()) &#123;</span><br><span class="line">            return;</span><br><span class="line">        &#125;</span><br><span class="line">        // treat toasts as notifications since they are used to</span><br><span class="line">        // announce a transient piece of information to the user</span><br><span class="line">        AccessibilityEvent event = AccessibilityEvent.obtain(</span><br><span class="line">                AccessibilityEvent.TYPE_NOTIFICATION_STATE_CHANGED);</span><br><span class="line">        event.setClassName(getClass().getName());</span><br><span class="line">        event.setPackageName(mView.getContext().getPackageName());</span><br><span class="line">        mView.dispatchPopulateAccessibilityEvent(event);</span><br><span class="line">        accessibilityManager.sendAccessibilityEvent(event);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public void handleHide() &#123;</span><br><span class="line">        if (localLOGV) Log.v(TAG, &quot;HANDLE HIDE: &quot; + this + &quot; mView=&quot; + mView);</span><br><span class="line">        if (mView != null) &#123;</span><br><span class="line">            // note: checking parent() just to make sure the view has</span><br><span class="line">            // been added...  i have seen cases where we get here when</span><br><span class="line">            // the view isn&apos;t yet added, so let&apos;s try not to crash.</span><br><span class="line">            if (mView.getParent() != null) &#123;</span><br><span class="line">                if (localLOGV) Log.v(TAG, &quot;REMOVE! &quot; + mView + &quot; in &quot; + this);</span><br><span class="line">                mWM.removeViewImmediate(mView);</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            mView = null;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="æ˜¾ç¤ºæ—¶é•¿"><a href="#æ˜¾ç¤ºæ—¶é•¿" class="headerlink" title="æ˜¾ç¤ºæ—¶é•¿"></a>æ˜¾ç¤ºæ—¶é•¿</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">static final int LONG_DELAY = PhoneWindowManager.TOAST_WINDOW_TIMEOUT;</span><br><span class="line">public static final int TOAST_WINDOW_TIMEOUT = 3500; // 3.5 seconds</span><br><span class="line">static final int SHORT_DELAY = 2000; // 2 seconds</span><br></pre></td></tr></table></figure>

<h3 id="è¶…æ—¶æ—¶é•¿"><a href="#è¶…æ—¶æ—¶é•¿" class="headerlink" title="è¶…æ—¶æ—¶é•¿"></a>è¶…æ—¶æ—¶é•¿</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">static final long SHORT_DURATION_TIMEOUT = 4000;</span><br><span class="line">static final long LONG_DURATION_TIMEOUT = 7000;</span><br></pre></td></tr></table></figure>

<h2 id="é—®é¢˜è§£ç­”"><a href="#é—®é¢˜è§£ç­”" class="headerlink" title="é—®é¢˜è§£ç­”"></a>é—®é¢˜è§£ç­”</h2><h3 id="èƒ½å¦åœ¨é-UI-çº¿ç¨‹è°ƒç”¨"><a href="#èƒ½å¦åœ¨é-UI-çº¿ç¨‹è°ƒç”¨" class="headerlink" title="èƒ½å¦åœ¨é UI çº¿ç¨‹è°ƒç”¨"></a>èƒ½å¦åœ¨é UI çº¿ç¨‹è°ƒç”¨</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">new Thread(new Runnable() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        Toast.makeText(getContext(), &quot;Call toast on non-UI thread&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>

<p>å¼‚å¸¸æç¤ºï¼šCanâ€™t create handler inside thread that has not called Looper.prepare()</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">new Thread(new Runnable() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public void run() &#123;</span><br><span class="line">        Looper.prepare();</span><br><span class="line">        Toast.makeText(getContext(), &quot;Call toast on non-UI thread&quot;, Toast.LENGTH_SHORT).show();</span><br><span class="line">        Looper.loop();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;).start();</span><br></pre></td></tr></table></figure>

<h3 id="Toastæ•°é‡"><a href="#Toastæ•°é‡" class="headerlink" title="Toastæ•°é‡"></a>Toastæ•°é‡</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">static final int MAX_PACKAGE_NOTIFICATIONS = 50;</span><br></pre></td></tr></table></figure>

<h3 id="Serviceä¸­èƒ½å¦æ˜¾ç¤ºToast"><a href="#Serviceä¸­èƒ½å¦æ˜¾ç¤ºToast" class="headerlink" title="Serviceä¸­èƒ½å¦æ˜¾ç¤ºToast"></a>Serviceä¸­èƒ½å¦æ˜¾ç¤ºToast</h3><p>å¯ä»¥ã€‚ä½†æ˜¯ç½‘ä¸Šè¯´IntentServiceä¸å¯ä»¥,å› ä¸ºIntentServiceè¿è¡Œåœ¨ç‹¬ç«‹çš„çº¿ç¨‹ä¸­ï¼Œæ‰€ä»¥Toastä¸æ­£å¸¸éœ€è¦é€šè¿‡Handlerè¿è¡Œäºä¸»çº¿ç¨‹ä¹‹ä¸Šï¼Œä½†æ˜¯æˆ‘æ‰“å°IntentServiceä¹Ÿæ˜¯mainçº¿ç¨‹ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">Handler handler = new Handler(Looper.getMainLooper());  </span><br><span class="line">handler.post(new Runnable() &#123;  </span><br><span class="line">	public void run() &#123;  </span><br><span class="line">		dialog.show();  </span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>


<h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><h3 id="æºç å·®å¼‚"><a href="#æºç å·®å¼‚" class="headerlink" title="æºç å·®å¼‚"></a>æºç å·®å¼‚</h3><blockquote>
<p>8 ä»¥ä¸‹</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">if (index &gt;= 0) &#123;</span><br><span class="line">    record = mToastQueue.get(index);</span><br><span class="line">    record.update(duration);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<blockquote>
<p>9</p>
</blockquote>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">if (index &gt;= 0) &#123;</span><br><span class="line">    record = mToastQueue.get(index);</span><br><span class="line">    record.update(duration);</span><br><span class="line">    try &#123;</span><br><span class="line">        record.callback.hide();</span><br><span class="line">    &#125; catch (RemoteException e) &#123;</span><br><span class="line">    &#125;</span><br><span class="line">    record.update(callback);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœ9ï¼Œå¿«é€Ÿç‚¹å‡»ï¼Œå½“toastå¼¹æ¡†ï¼Œå†æ¬¡ç‚¹å‡»ç«‹åˆ»æ¶ˆå¤±ï¼Œç„¶ååˆ°äº‹ä»¶åï¼Œæ¸…é™¤é˜Ÿåˆ—åæ‰èƒ½å†æ¬¡æ˜¾ç¤ºã€‚è€Œ8ä»¥ä¸‹ï¼Œåˆ™æ˜¯toastå¼¹æ¡†åˆ°æ—¶é—´æ¶ˆå¤±åï¼Œå†æ¬¡ç‚¹å‡»æ‰èƒ½æ˜¾ç¤ºã€‚ä¸¤è€…toastæ¯æ¬¡æ˜¾ç¤ºçš„æ—¶é—´ä¸åŒã€‚</p>
<h3 id="ç³»ç»Ÿé—®é¢˜"><a href="#ç³»ç»Ÿé—®é¢˜" class="headerlink" title="ç³»ç»Ÿé—®é¢˜"></a>ç³»ç»Ÿé—®é¢˜</h3><p>æŸäº›æ‰‹æœºç³»ç»Ÿæºç åšäº†ä¿®æ”¹ï¼Œæ¯”å¦‚çº¢ç±³5pï¼Œå¦‚æœä¸€ç›´ç‚¹å‡»ï¼Œåœ¨toastæ¶ˆå¤±åï¼Œåˆ™ä¸ä¼šåœ¨å¼¹æç¤ºã€‚åœä¸‹ä¸€æ®µæ—¶é—´åï¼Œlogä¼šè¾“å…¥å¼‚å¸¸æç¤ºã€‚åˆæ­¥è®¤å®šæ˜¯å¿«é€Ÿç‚¹å‡»æ—¶çš„toastæœºåˆ¶åšäº†ä¿®æ”¹ã€‚è¿™ä¸ªå›°æ‰°äº†æˆ‘å¥½é•¿æ—¶é—´ï¼Œæœ€åæ ¹æ®æ—¥å¿—ï¼Œå’Œå…¶ä»–çš„æ‰‹æœºæ‰å‘ç°è¿™ä¸ªé—®é¢˜ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">2019-11-08 17:41:33.311 1632-1632/? W/WindowManager: Attempted to remove non-existing token: android.os.Binder@bc43f4e</span><br><span class="line">2019-11-08 17:41:33.315 1632-2685/? W/WindowManager: Failed looking up window</span><br><span class="line">    java.lang.IllegalArgumentException: Requested window android.os.BinderProxy@22ce86f does not exist</span><br><span class="line">        at com.android.server.wm.WindowManagerService.windowForClientLocked(WindowManagerService.java:9651)</span><br><span class="line">        at com.android.server.wm.WindowManagerService.windowForClientLocked(WindowManagerService.java:9642)</span><br><span class="line">        at com.android.server.wm.WindowManagerService.removeWindow(WindowManagerService.java:2420)</span><br><span class="line">        at com.android.server.wm.Session.remove(Session.java:202)</span><br><span class="line">        at android.view.IWindowSession$Stub.onTransact(IWindowSession.java:242)</span><br><span class="line">        at com.android.server.wm.Session.onTransact(Session.java:145)</span><br><span class="line">        at android.os.Binder.execTransact(Binder.java:567)</span><br></pre></td></tr></table></figure>

<h2 id="æ€»ç»“"><a href="#æ€»ç»“" class="headerlink" title="æ€»ç»“"></a>æ€»ç»“</h2><p>æ•´ä¸ªè°ƒç ”è¿‡ç¨‹æ¯”è¾ƒé•¿ï¼ŒæœŸé—´ä¸»è¦å¡åœ¨äº†å›½å†…æ‰‹æœºå‚å•†çš„ç³»ç»Ÿä¿®æ”¹ä¸Šï¼Œä»Šååœ¨é‡åˆ°åŒæ ·é—®é¢˜ï¼Œè¿˜æ˜¯è¦åšæµ‹è¯•ï¼Œå°½é‡æ—©å‘ç°é—®é¢˜ï¼Œä»Šæ—©æå‡ºè§£å†³å’Œæ–¹æ¡ˆã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/mzlogin/article/details/78580687" target="_blank" rel="noopener">Android æºç åˆ†æ â€”â€” ä» Toast å‡ºå‘</a></p>
<p><a href="https://github.com/aosp-mirror/platform_frameworks_base/blob/master/services/core/java/com/android/server/notification/NotificationManagerService.java" target="_blank" rel="noopener">NotificationManagerService</a></p>
<p><a href="https://github.com/aosp-mirror/platform_frameworks_base/blob/master/core/java/android/view/WindowManager.java" target="_blank" rel="noopener">WindowManager</a></p>
<p><a href="https://github.com/aosp-mirror/platform_frameworks_base/blob/master/core/java/android/widget/Toast.java" target="_blank" rel="noopener">Toast</a></p>
<p><a href="https://github.com/aosp-mirror/platform_frameworks_base/blob/master/services/core/java/com/android/server/policy/PhoneWindowManager.java" target="_blank" rel="noopener">PhoneWindowManager</a></p>
<p><a href="https://blog.csdn.net/androidguy/article/details/90750688" target="_blank" rel="noopener">å…³äºBinderä¸­clearCallingIdentity()ä¸restoreCallingIdentity()çš„ä½œç”¨åŠå¦‚ä½•å®ç°æƒé™è®¤è¯</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Toast </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[TextViewå›¾æ–‡æ··æ’å±…ä¸­ã€å›¾ç‰‡è¢«æˆªæ–­ã€è‡ªåŠ¨æ¢è¡Œé—®é¢˜]]></title>
      <url>/2019/09/26/TextView%E5%9B%BE%E6%96%87%E6%B7%B7%E6%8E%92%E5%B1%85%E4%B8%AD%E3%80%81%E5%9B%BE%E7%89%87%E8%A2%AB%E6%88%AA%E6%96%AD%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>åœ¨Androidä¸­åšå›¾æ–‡æ··æ’ï¼Œä¸€èˆ¬éƒ½æ˜¯é€‰æ‹©ç”¨TextView+ImageSpanæ¥å®ç°ï¼Œä½†æ˜¯åœ¨ImageSpanä¸­ï¼Œå¯¹é½æ–¹å¼åªæœ‰ImageSpan.ALIGN_BASELINE,ImageSpan.ALIGN_BOTTOMä¸¤ç§å¯¹é½æ–¹å¼ï¼Œä¸èƒ½ç›¸å¯¹äºæ–‡æœ¬å±…ä¸­ï¼Œå¦‚æœæˆ‘ä»¬å›¾ç‰‡å°äºæ–‡å­—ï¼Œæˆ–è€…å¤§äºæ–‡å­—ï¼Œéƒ½ä¼šå¯¼è‡´æ’ç‰ˆé—®é¢˜å‡ºç°ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/09/26/TextViewå›¾æ–‡æ··æ’å±…ä¸­ã€å›¾ç‰‡è¢«æˆªæ–­é—®é¢˜/nocenter.png" alt="nocenter" title class>
                <p>nocenter</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/09/26/TextViewå›¾æ–‡æ··æ’å±…ä¸­ã€å›¾ç‰‡è¢«æˆªæ–­é—®é¢˜/blocked.png" alt="blocked" title class>
                <p>blocked</p>
            </figure>
<h2 id="å±…ä¸­"><a href="#å±…ä¸­" class="headerlink" title="å±…ä¸­"></a>å±…ä¸­</h2><p>ä¸‹é¢æ˜¯æŠ„è‡ªwangkunlinåŒå­¦éƒ½ä¸€ä¸ªå±…ä¸­å®ç°ä»£ç ï¼Œå°è£…çš„å¾ˆå¥½ï¼Œå°±æ‹¿è¿‡æ¥ç›´æ¥ç”¨äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br></pre></td><td class="code"><pre><span class="line">package com.wkl.imagespan;</span><br><span class="line"></span><br><span class="line">import android.graphics.Canvas;</span><br><span class="line">import android.graphics.Paint;</span><br><span class="line">import android.graphics.Rect;</span><br><span class="line">import android.graphics.drawable.Drawable;</span><br><span class="line">import android.support.annotation.IntDef;</span><br><span class="line">import android.text.style.ImageSpan;</span><br><span class="line"></span><br><span class="line">import java.lang.annotation.Retention;</span><br><span class="line">import java.lang.annotation.RetentionPolicy;</span><br><span class="line">import java.lang.ref.WeakReference;</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * Created by wangkunlin</span><br><span class="line"> * On 2017-03-15</span><br><span class="line"> */</span><br><span class="line"></span><br><span class="line">public class AlignImageSpan extends ImageSpan &#123;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * é¡¶éƒ¨å¯¹é½</span><br><span class="line">     */</span><br><span class="line">    public static final int ALIGN_TOP = 3;</span><br><span class="line">    /**</span><br><span class="line">     * å‚ç›´å±…ä¸­</span><br><span class="line">     */</span><br><span class="line">    public static final int ALIGN_CENTER = 4;</span><br><span class="line"></span><br><span class="line">    @IntDef(&#123;ALIGN_BOTTOM, ALIGN_BASELINE, ALIGN_TOP, ALIGN_CENTER&#125;)</span><br><span class="line">    @Retention(RetentionPolicy.SOURCE)</span><br><span class="line">    public @interface Alignment &#123;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public AlignImageSpan(Drawable d) &#123;</span><br><span class="line">        this(d, ALIGN_CENTER);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    public AlignImageSpan(Drawable d, @Alignment int verticalAlignment) &#123;</span><br><span class="line">        super(d, verticalAlignment);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public int getSize(Paint paint, CharSequence text, int start, int end, Paint.FontMetricsInt fm) &#123;</span><br><span class="line">        Drawable d = getCachedDrawable();</span><br><span class="line">        Rect rect = d.getBounds();</span><br><span class="line">        if (fm != null) &#123;</span><br><span class="line">            Paint.FontMetrics fmPaint = paint.getFontMetrics();</span><br><span class="line">            // é¡¶éƒ¨ leading</span><br><span class="line">            float topLeading = fmPaint.top - fmPaint.ascent;</span><br><span class="line">            // åº•éƒ¨ leading</span><br><span class="line">            float bottomLeading = fmPaint.bottom - fmPaint.descent;</span><br><span class="line">            // drawable çš„é«˜åº¦</span><br><span class="line">            int drHeight = rect.height();</span><br><span class="line"></span><br><span class="line">            switch (mVerticalAlignment) &#123;</span><br><span class="line">                case ALIGN_CENTER: &#123; // drawable çš„ä¸­é—´ä¸ è¡Œä¸­é—´å¯¹é½</span><br><span class="line">                    // å½“å‰è¡Œ çš„é«˜åº¦</span><br><span class="line">                    float fontHeight = fmPaint.descent - fmPaint.ascent;</span><br><span class="line">                    // æ•´è¡Œçš„ yæ–¹å‘ä¸Šçš„ä¸­é—´ y åæ ‡</span><br><span class="line">                    float center = fmPaint.descent - fontHeight / 2;</span><br><span class="line"></span><br><span class="line">                    // ç®—å‡º ascent å’Œ descent</span><br><span class="line">                    float ascent = center - drHeight / 2;</span><br><span class="line">                    float descent = center + drHeight / 2;</span><br><span class="line"></span><br><span class="line">                    fm.ascent = (int) ascent;</span><br><span class="line">                    fm.top = (int) (ascent + topLeading);</span><br><span class="line">                    fm.descent = (int) descent;</span><br><span class="line">                    fm.bottom = (int) (descent + bottomLeading);</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                case ALIGN_BASELINE: &#123; // drawable çš„åº•éƒ¨ä¸ baseline å¯¹é½</span><br><span class="line">                    // æ‰€ä»¥ ascent çš„å€¼å°±æ˜¯ è´Ÿçš„ drawable çš„é«˜åº¦</span><br><span class="line">                    float ascent = -drHeight;</span><br><span class="line">                    fm.ascent = -drHeight;</span><br><span class="line">                    fm.top = (int) (ascent + topLeading);</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                case ALIGN_TOP: &#123; // drawable çš„é¡¶éƒ¨ä¸ è¡Œçš„é¡¶éƒ¨ å¯¹é½</span><br><span class="line">                    // ç®—å‡º descent</span><br><span class="line">                    float descent = drHeight + fmPaint.ascent;</span><br><span class="line">                    fm.descent = (int) descent;</span><br><span class="line">                    fm.bottom = (int) (descent + bottomLeading);</span><br><span class="line">                    break;</span><br><span class="line">                &#125;</span><br><span class="line">                case ALIGN_BOTTOM: // drawable çš„åº•éƒ¨ä¸ è¡Œçš„åº•éƒ¨ å¯¹é½</span><br><span class="line">                default: &#123;</span><br><span class="line">                    // ç®—å‡º ascent</span><br><span class="line">                    float ascent = fmPaint.descent - drHeight;</span><br><span class="line">                    fm.ascent = (int) ascent;</span><br><span class="line">                    fm.top = (int) (ascent + topLeading);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return rect.right;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    /**</span><br><span class="line">     * è¿™é‡Œçš„ x, y, top ä»¥åŠ bottom éƒ½æ˜¯åŸºäºæ•´ä¸ª TextView çš„åæ ‡ç³»çš„åæ ‡</span><br><span class="line">     *</span><br><span class="line">     * @param x      drawable ç»˜åˆ¶çš„èµ·å§‹ x åæ ‡</span><br><span class="line">     * @param top    å½“å‰è¡Œæœ€é«˜å¤„ï¼Œåœ¨ TextView ä¸­çš„ y åæ ‡</span><br><span class="line">     * @param y      å½“å‰è¡Œçš„ BaseLine åœ¨ TextView ä¸­çš„ y åæ ‡</span><br><span class="line">     * @param bottom å½“å‰è¡Œæœ€ä½å¤„ï¼Œåœ¨ TextView ä¸­çš„ y åæ ‡</span><br><span class="line">     */</span><br><span class="line">    @Override</span><br><span class="line">    public void draw(Canvas canvas, CharSequence text, int start, int end, float x, int top, int y, int bottom, Paint paint) &#123;</span><br><span class="line">        Drawable drawable = getDrawable();</span><br><span class="line">        Rect rect = drawable.getBounds();</span><br><span class="line">        float transY;</span><br><span class="line">        switch (mVerticalAlignment) &#123;</span><br><span class="line">            case ALIGN_BASELINE:</span><br><span class="line">                transY = y - rect.height();</span><br><span class="line">                break;</span><br><span class="line">            case ALIGN_CENTER:</span><br><span class="line">                transY = ((bottom - top) - rect.height()) / 2 + top;</span><br><span class="line">                break;</span><br><span class="line">            case ALIGN_TOP:</span><br><span class="line">                transY = top;</span><br><span class="line">                break;</span><br><span class="line">            case ALIGN_BOTTOM:</span><br><span class="line">            default:</span><br><span class="line">                transY = bottom - rect.height();</span><br><span class="line">        &#125;</span><br><span class="line">        canvas.save();</span><br><span class="line">        // è¿™é‡Œå¦‚æœä¸ç§»åŠ¨ç”»å¸ƒï¼Œdrawable å°±ä¼šåœ¨ Textview çš„å·¦ä¸Šè§’å‡ºç°</span><br><span class="line">        canvas.translate(x, transY);</span><br><span class="line">        drawable.draw(canvas);</span><br><span class="line">        canvas.restore();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private Drawable getCachedDrawable() &#123;</span><br><span class="line">        WeakReference&lt;Drawable&gt; wr = mDrawableRef;</span><br><span class="line">        Drawable d = null;</span><br><span class="line"></span><br><span class="line">        if (wr != null)</span><br><span class="line">            d = wr.get();</span><br><span class="line"></span><br><span class="line">        if (d == null) &#123;</span><br><span class="line">            d = getDrawable();</span><br><span class="line">            mDrawableRef = new WeakReference&lt;&gt;(d);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        return d;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    private WeakReference&lt;Drawable&gt; mDrawableRef;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æˆªæ–­å¤„ç†"><a href="#æˆªæ–­å¤„ç†" class="headerlink" title="æˆªæ–­å¤„ç†"></a>æˆªæ–­å¤„ç†</h2><p>å›¾ç‰‡è¢«æˆªæ–­ï¼Œåœ¨æ¦‚è¿°é‡Œæˆ‘ä»¬è¯´æ˜äº†åŸå› ï¼Œé‚£æ€ä¹ˆè§£å†³å‘¢ï¼Ÿè¿™é‡Œæˆ‘ä»¬ä½¿ç”¨äº†TextUtils.ellipsizeï¼Œå®ƒç›¸å½“äº TextViewçš„xmlä¸­ellipsizeï¼Œæ˜¯åœ¨è·å–TextViewå·²setMaxLinesåï¼Œæ˜¾ç¤ºå‡ºæ¥çš„å¸¦æœ‰â€¦ç»“å°¾çš„å†…å®¹ã€‚</p>
<p>æ‰€ä»¥æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è®¡ç®—ï¼Œè·å–åˆ°æœ€ç»ˆæ˜¾ç¤ºçš„æ–‡æœ¬ï¼Œç„¶åç›´æ¥æ˜¾ç¤ºäº†ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">//è·å–å›¾ç‰‡å¤§å°</span><br><span class="line">int wh = mContext.getResources().getDimensionPixelOffset(R.dimen.28);</span><br><span class="line">textView.post(() -&gt; &#123;</span><br><span class="line">    int width = textView.getWidth(); //è·å–textviewå®½åº¦</span><br><span class="line">    int padding = textView.getPaddingLeft()+textView.getPaddingRight();//è·å–textview å†…è¾¹è·</span><br><span class="line">    int lineWidth = width - padding-wh*2;//è·å–å®é™…å±•ç¤ºçš„ä½†èˆªå†…å®¹å®½åº¦</span><br><span class="line">    //é€šè¿‡TextUtils.ellipsizeè·å–æˆªæ–­åçš„å®é™…æ–‡æœ¬</span><br><span class="line">    String ellipsizeStr = TextUtils.ellipsize(signature, textView.getPaint(), lineWidth*2, TextUtils.TruncateAt.END).toString();</span><br><span class="line">    textView.setText(getSignatureText(&quot;.  &quot;+ellipsizeStr+&quot;  .&quot;,wh));</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">private SpannableString getSignatureText(String selfDesc,int wh)&#123;</span><br><span class="line">        Drawable drawableLeft = mContext.getResources().getDrawable(R.drawable.mark_left);</span><br><span class="line">        drawableLeft.setBounds(0, 0, wh, wh);</span><br><span class="line">        AlignImageSpan imgSpanLeft = new AlignImageSpan(drawableLeft, AlignImageSpan.ALIGN_CENTER);</span><br><span class="line"></span><br><span class="line">        Drawable drawableRight = mContext.getResources().getDrawable(R.drawable.mark_right);</span><br><span class="line">        drawableRight.setBounds(0, 0, wh, wh);</span><br><span class="line">        AlignImageSpan imgSpanRight = new AlignImageSpan(drawableRight, AlignImageSpan.ALIGN_CENTER);</span><br><span class="line"></span><br><span class="line">        SpannableString spannableString = new SpannableString(selfDesc);</span><br><span class="line">        spannableString.setSpan(imgSpanLeft, 0, 1, Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</span><br><span class="line">        spannableString.setSpan(imgSpanRight, selfDesc.length()-1, selfDesc.length(), Spannable.SPAN_EXCLUSIVE_EXCLUSIVE);</span><br><span class="line">        return spannableString;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„</strong></p>
<p><strong>â€œ.  â€œ+ellipsizeStr+â€  .â€ï¼Œæˆ‘ä»¬åœ¨è¿™é‡ŒåŠ å…¥å›¾ç‰‡çš„åœ°æ–¹åŠ äº†ç‚¹å’Œç©ºæ ¼ï¼Œç‚¹æ˜¯ä¸ºäº†å ä½ï¼Œç©ºæ ¼æ˜¯ä¸ºäº†è®¾ç½®ä¸æ–‡å­—ä¹‹é—´çš„é—´è·ã€‚ä¸ºå•¥è¦ç”¨ç‚¹å ä½ï¼Œä¸åŠ å ä½çš„è¯ï¼Œé¦–ä¸ªæ–‡å­—ä¼šè¢«å¼€å§‹çš„å›¾ç‰‡ç»™æˆªå–ç‚¹ï¼Œå¯¼è‡´å°‘å±•ç¤ºäº†ä¸€ä¸ªå¼€å§‹çš„æ–‡å­—ã€‚ï¼ˆä½†æ˜¯ç›´æ¥ç”¨ç³»ç»ŸImageSpanï¼Œä¸ç”¨TextUtils.ellipsizeçš„æ—¶å€™å°±ä¸ä¼šï¼Œæ„Ÿå…´è¶£çš„æœ‹å‹å¯ä»¥éªŒè¯ä¸‹åŸå› ï¼‰ã€‚</strong></p>
<h2 id="è‡ªåŠ¨æ¢è¡Œåï¼Œç»“å°¾å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸"><a href="#è‡ªåŠ¨æ¢è¡Œåï¼Œç»“å°¾å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸" class="headerlink" title="è‡ªåŠ¨æ¢è¡Œåï¼Œç»“å°¾å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸"></a>è‡ªåŠ¨æ¢è¡Œåï¼Œç»“å°¾å›¾ç‰‡æ˜¾ç¤ºæ­£å¸¸</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line">textView.post(() -&gt; &#123;</span><br><span class="line">int ellipsisCount = textView.getLayout().getEllipsisCount(textView.getLineCount() - 1);</span><br><span class="line">    if (ellipsisCount &gt; 0) &#123;</span><br><span class="line">        int endIndex = getSubLength(text,textView,ellipsisCount);</span><br><span class="line">        text = text.substring(0, endIndex) + &quot;...  img&quot;;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line">/**</span><br><span class="line"> * è®¡ç®—å­—ç¬¦æˆªå–çš„point lengthï¼Œå¯ä»¥å¤„ç†æ··æ’æ¢è¡Œæˆ–æ•°å­—ï¼Œå­—æ¯ç»“å°¾å›¾ç‰‡å±•ç¤ºä¸å…¨çš„æƒ…å†µ</span><br><span class="line"> * @param text</span><br><span class="line"> * @param textView</span><br><span class="line"> * @param ellipsisCount</span><br><span class="line"> * @return</span><br><span class="line"> */</span><br><span class="line">private int getSubLength(String text, TextView textView, int ellipsisCount) &#123;</span><br><span class="line">    int endIndex = text.length() - ellipsisCount;</span><br><span class="line">    //é»˜è®¤å‡å»ä¸€ä¸ªå­—ç¬¦ä»£æ›¿å›¾ç‰‡ä½ç½®</span><br><span class="line">    if (textView == null || textView.getPaint() == null) &#123;</span><br><span class="line">        return endIndex - 1;</span><br><span class="line">    &#125;</span><br><span class="line">    //ç²¾ç¡®è®¡ç®—éœ€è¦å±•ç¤ºçš„å­—ç¬¦length</span><br><span class="line">    String subText = text.substring(0, endIndex);</span><br><span class="line">    char[] chars = subText.toCharArray();</span><br><span class="line">    float textWidth = 0;</span><br><span class="line">    Paint paint = textView.getPaint();</span><br><span class="line">    float point = paint.measureText(&quot;...&quot;);</span><br><span class="line">    for (int i = chars.length - 1; ; i--) &#123;</span><br><span class="line">        textWidth = textWidth + paint.measureText(String.valueOf(chars[i]));</span><br><span class="line">        endIndex = i;</span><br><span class="line">        if (textWidth &gt;= mImgSize + point) &#123;</span><br><span class="line">            break;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    return endIndex;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Html-fromHtml"><a href="#Html-fromHtml" class="headerlink" title="Html.fromHtml"></a>Html.fromHtml</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">String texts = &quot;&lt;img src=\&quot;startimg\&quot;/&gt;&amp;nbsp;&amp;nbsp;&quot; + text +&quot;...&amp;nbsp;&amp;nbsp;&lt;img src=\&quot;endimg\&quot;/&gt;&quot;;</span><br><span class="line">Spanned spanned =  Html.fromHtml(texts, new Html.ImageGetter() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    public Drawable getDrawable(String source) &#123;</span><br><span class="line">        if(&quot;startimg&quot;.equals(source))&#123;</span><br><span class="line">            //æ ¹æ®idä»èµ„æºæ–‡ä»¶ä¸­è·å–å›¾ç‰‡å¯¹è±¡</span><br><span class="line">            Drawable d = mContext.getResources().getDrawable(R.drawable.friend_list_card_selfdesc_mark_left);</span><br><span class="line">            d.setBounds(0, 0, wh,wh);</span><br><span class="line">            return d;</span><br><span class="line">        &#125;else&#123;</span><br><span class="line">            Drawable d = mContext.getResources().getDrawable(R.drawable.friend_list_card_selfdesc_mark_right);</span><br><span class="line">            d.setBounds(0, 0, wh,wh);</span><br><span class="line">            return d;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;,null);</span><br><span class="line">textView.setText(spanned);</span><br></pre></td></tr></table></figure>

<p>htmlä¹Ÿä¸æ”¯æŒæ··æ’ã€‚</p>
<h2 id="è‡ªåŠ¨æ¢è¡Œ"><a href="#è‡ªåŠ¨æ¢è¡Œ" class="headerlink" title="è‡ªåŠ¨æ¢è¡Œ"></a>è‡ªåŠ¨æ¢è¡Œ</h2><p>é€šè¿‡è®¡ç®—æ¯ä¸ªå­—ç¬¦çš„å®½åº¦ï¼Œæ¥è‡ªåŠ¨æ·»åŠ \næ¢è¡Œ,ä¸”xmlä¸­ä¸éœ€è¦è®¾ç½®ellipsizeã€‚æš‚æ”¯æŒåªä¸¤è¡Œï¼Œå…¶ä»–æƒ…å†µåŸç†ç›¸åŒã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line">textView.post(() -&gt; &#123;</span><br><span class="line">        String endText = getAutoSplitText(textView,signature,2);</span><br><span class="line">        textView.setText(getSignatureText(endText,wh));</span><br><span class="line">    &#125;);</span><br><span class="line">        </span><br><span class="line">private String getAutoSplitText(TextView textView, String signature, int maxLineCount) &#123;</span><br><span class="line">	int imgSize = mContext.getResources().getDimensionPixelOffset(R.dimen.px28);</span><br><span class="line">	String rawText = signature.replaceAll(&quot;\r&quot;, &quot;&quot;);</span><br><span class="line">	final Paint tvPaint = textView.getPaint();</span><br><span class="line">	float space = tvPaint.measureText(&quot;  &quot;);</span><br><span class="line">	float dot = tvPaint.measureText(&quot;...&quot;);</span><br><span class="line">	float tvWidth = textView.getWidth() - textView.getPaddingLeft() - textView.getPaddingRight(); //æ§ä»¶å¯ç”¨å®½åº¦</span><br><span class="line">	//å¦‚æœæ•´è¡Œå®½åº¦è¶…è¿‡æ§ä»¶å¯ç”¨å®½åº¦ï¼Œåˆ™æŒ‰å­—ç¬¦æµ‹é‡ï¼Œåœ¨è¶…è¿‡å¯ç”¨å®½åº¦çš„å‰ä¸€ä¸ªå­—ç¬¦å¤„æ‰‹åŠ¨æ¢è¡Œ</span><br><span class="line">	StringBuilder startText = new StringBuilder();</span><br><span class="line">	float lineWidth = imgSize + space;</span><br><span class="line">	int lineCount = 0;</span><br><span class="line">	for (int count = 0; count &lt; rawText.length(); ++count) &#123;</span><br><span class="line">	    char ch = rawText.charAt(count);</span><br><span class="line">	    lineWidth += tvPaint.measureText(String.valueOf(ch));</span><br><span class="line">	    if (lineWidth &lt;= tvWidth) &#123;</span><br><span class="line">	        startText.append(ch);</span><br><span class="line">	    &#125; else &#123;</span><br><span class="line">	        startText.append(&quot;\n&quot;);</span><br><span class="line">	        lineCount++;</span><br><span class="line">	        if (lineCount == maxLineCount) &#123;</span><br><span class="line">	            break;</span><br><span class="line">	        &#125;</span><br><span class="line">	        tvWidth = tvWidth - imgSize - space - dot - tvPaint.measureText(String.valueOf(ch));</span><br><span class="line">	        lineWidth = 0;</span><br><span class="line">	        --count;</span><br><span class="line">	    &#125;</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	//æŠŠç»“å°¾å¤šä½™çš„\nå»æ‰</span><br><span class="line">	if (startText.toString().endsWith(&quot;\n&quot;)) &#123;</span><br><span class="line">	    startText.deleteCharAt(startText.length() - 1);</span><br><span class="line">	&#125;</span><br><span class="line">	</span><br><span class="line">	StringBuilder endText = new StringBuilder();</span><br><span class="line">	if(lineCount &lt; 2)&#123;</span><br><span class="line">	    endText.append(&quot;img  &quot;).append(startText).append(&quot;  img&quot;);</span><br><span class="line">	&#125;else&#123;</span><br><span class="line">	    endText.append(&quot;img  &quot;).append(startText).append(&quot;...  img&quot;);</span><br><span class="line">	&#125;</span><br><span class="line">	return endText.toString();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="æœ€ç»ˆæ•ˆæœ"><a href="#æœ€ç»ˆæ•ˆæœ" class="headerlink" title="æœ€ç»ˆæ•ˆæœ"></a>æœ€ç»ˆæ•ˆæœ</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2019/09/26/TextViewå›¾æ–‡æ··æ’å±…ä¸­ã€å›¾ç‰‡è¢«æˆªæ–­é—®é¢˜/nodot.png" alt="nodot" title class>
                <p>nodot</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/09/26/TextViewå›¾æ–‡æ··æ’å±…ä¸­ã€å›¾ç‰‡è¢«æˆªæ–­é—®é¢˜/dot.png" alt="dot" title class>
                <p>dot</p>
            </figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="http://ddrv.cn/a/232387" target="_blank" rel="noopener">TextView å›¾æ–‡æ··æ’ï¼Œè§£å†³å›¾ç‰‡è¢«æˆªæ–­</a></p>
<p><a href="https://blog.csdn.net/jdsjlzx/article/details/90033791" target="_blank" rel="noopener">TextViewå›¾æ–‡æ··æ’å›¾ç‰‡è¢«æˆªæ–­çš„é—®é¢˜ä»¥åŠAndroidçœç•¥å·åªæœ‰ä¸€ä¸ªç‚¹çš„é—®é¢˜</a></p>
<p><a href="https://blog.csdn.net/jiangtea/article/details/54098123" target="_blank" rel="noopener">SpannableStringçš„ç”¨æ³•è¯¦è§£</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android 7.0ä¹‹åæŠ“åŒ…è¯ä¹¦æ— æ•ˆçš„è§£å†³æ–¹æ¡ˆ]]></title>
      <url>/2019/09/20/Android-7-0%E4%B9%8B%E5%90%8E%E6%8A%93%E5%8C%85%E8%AF%81%E4%B9%A6%E6%97%A0%E6%95%88%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/</url>
      <content type="html"><![CDATA[<h2 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h2><p>ä½¿ç”¨æŠ“åŒ…è½¯ä»¶ï¼ˆä»¥ Charles ä¸ºä¾‹ï¼‰æŠ“å–APPçš„ https è¯·æ±‚æ—¶ï¼ŒAndroidå’ŒCharleséƒ½æ­£ç¡®å®‰è£…äº†è¯ä¹¦å´å‡ºç°æŠ“åŒ…å¤±è´¥ï¼ŒæŠ¥é”™ï¼š</p>
<p>Failure    Client SSL handshake failed: An unknown issue occurred processing the certificate (certificate_unknown)</p>
<p><img src="http://nunu03.github.io/2019/09/20/Android-7-0%E4%B9%8B%E5%90%8E%E6%8A%93%E5%8C%85%E8%AF%81%E4%B9%A6%E6%97%A0%E6%95%88%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/certunknow.png" alt="certunknow"></p>
<h2 id="è§£å†³æ–¹æ¡ˆ"><a href="#è§£å†³æ–¹æ¡ˆ" class="headerlink" title="è§£å†³æ–¹æ¡ˆ"></a>è§£å†³æ–¹æ¡ˆ</h2><h3 id="å¯¼å‡º-pem"><a href="#å¯¼å‡º-pem" class="headerlink" title="å¯¼å‡º.pem"></a>å¯¼å‡º.pem</h3><h3 id="è·å–æ–‡ä»¶å"><a href="#è·å–æ–‡ä»¶å" class="headerlink" title="è·å–æ–‡ä»¶å"></a>è·å–æ–‡ä»¶å</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">openssl x509 -subject_hash -in  /Users/chenyulong01/Desktop/Untitled.pem </span><br><span class="line">07cc5b45</span><br><span class="line">-----BEGIN CERTIFICATE-----</span><br><span class="line">MIIFbDCCBFSgAwIBAgIGAV84nCXLMA0GCSqGSIb3DQEBCwUAMIG6MUswSQYDVQQD</span><br><span class="line">DEJDaGFybGVzIFByb3h5IENBICgyMCDljYHmnIggMjAxNywgY2hlbnl1bG9uZzAx</span><br><span class="line">ZGVNYWNCb29rLVByby5sb2NhbCkxJTAjBgNVBAsMHGh0dHBzOi8vY2hhcmxlc3By</span><br><span class="line">b3h5LmNvbS9zc2wxETAPBgNVBAoMCFhLNzIgTHRkMREwDwYDVQQHDAhBdWNrbGFu</span><br><span class="line">ZDERMA8GA1UECAwIQXVja2xhbmQxCzAJBgNVBAYTAk5aMB4XDTAwMDEwMTAwMDAw</span><br><span class="line">MFoXDTQ2MTIxNzA3MDc1OFowgboxSzBJBgNVBAMMQkNoYXJsZXMgUHJveHkgQ0Eg</span><br><span class="line">KDIwIOWNgeaciCAyMDE3LCBjaGVueXVsb25nMDFkZU1hY0Jvb2stUHJvLmxvY2Fs</span><br><span class="line">KTElMCMGA1UECwwcaHR0cHM6Ly9jaGFybGVzcHJveHkuY29tL3NzbDERMA8GA1UE</span><br><span class="line">CgwIWEs3MiBMdGQxETAPBgNVBAcMCEF1Y2tsYW5kMREwDwYDVQQIDAhBdWNrbGFu</span><br><span class="line">ZDELMAkGA1UEBhMCTlowggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQCU</span><br><span class="line">i7FUgkLSIxIYcQWXNf4OkncxNZl1SWXExV8whjC3W+IWA3C3gJgYVY57j4uj+B1q</span><br><span class="line">EGbqIYw4dok3ayB+Yrrcm0WVirb4IJVwUc/EfNnkqAluc/US01Mti6+PuUnya8ze</span><br><span class="line">JZN8ZzJReIgiI7LlYlrPjD0hl4cTckpsdcGLqlfkjuXyeUU3b/qNyKsquAq42o8M</span><br><span class="line">ngB7zbObsie/EpEsI3beqa7MForKeuq5Cc900IdMfTqeIATY7GTdtyXPXPzSionF</span><br><span class="line">TcYMk3QQqLZz+hqF6v8sKB4NeZNFpjSzJF2l7xjUMApMeDppaBN8kTSgf8k8OSxe</span><br><span class="line">HWk1lLhdJfh96O/nEbz9AgMBAAGjggF0MIIBcDAPBgNVHRMBAf8EBTADAQH/MIIB</span><br><span class="line">LAYJYIZIAYb4QgENBIIBHROCARlUaGlzIFJvb3QgY2VydGlmaWNhdGUgd2FzIGdl</span><br><span class="line">bmVyYXRlZCBieSBDaGFybGVzIFByb3h5IGZvciBTU0wgUHJveHlpbmcuIElmIHRo</span><br><span class="line">aXMgY2VydGlmaWNhdGUgaXMgcGFydCBvZiBhIGNlcnRpZmljYXRlIGNoYWluLCB0</span><br><span class="line">aGlzIG1lYW5zIHRoYXQgeW91J3JlIGJyb3dzaW5nIHRocm91Z2ggQ2hhcmxlcyBQ</span><br><span class="line">cm94eSB3aXRoIFNTTCBQcm94eWluZyBlbmFibGVkIGZvciB0aGlzIHdlYnNpdGUu</span><br><span class="line">IFBsZWFzZSBzZWUgaHR0cDovL2NoYXJsZXNwcm94eS5jb20vc3NsIGZvciBtb3Jl</span><br><span class="line">IGluZm9ybWF0aW9uLjAOBgNVHQ8BAf8EBAMCAgQwHQYDVR0OBBYEFPDxZ1dwMgBq</span><br><span class="line">AuPwBWMv/Lcd7GOGMA0GCSqGSIb3DQEBCwUAA4IBAQA3nLkJtVRUUX94BJbryczU</span><br><span class="line">C0l5dqURDA6KKlNF3PtYvXxGGrdt7Ojkno9d2thUg1b+vKRwcY8tioJJHt01/QbH</span><br><span class="line">BK3uSIsdoxR+FY9Q7+hJc7XE8d+D3h4KlUgRY8EhCvBZMMo45O4t7wZYRbiCZh3q</span><br><span class="line">p4bayK99HZ8naYovYYK9oJiR8L41+YwuLZllkn5thJ+kvKw0NAgrP5YOsuxu+3DV</span><br><span class="line">uoDEhQPOwmPSVWq1JRAKMi8Ck9dfRYxZklLGZ+ZiT1L2ShyNuCLRKFHaP880RWJF</span><br><span class="line">uwuKep/FHqmCHWj5DumZF37jbsY56i13f723nSVZ56XJUq+yQ8KZzTqbEYBfC9Si</span><br><span class="line">-----END CERTIFICATE-----</span><br></pre></td></tr></table></figure>

<p>07cc5b45,å°±æ˜¯æˆ‘ä»¬è·å–åˆ°çš„æ–‡ä»¶åã€‚</p>
<h3 id="ä¿®æ”¹æ–‡ä»¶å"><a href="#ä¿®æ”¹æ–‡ä»¶å" class="headerlink" title="ä¿®æ”¹æ–‡ä»¶å"></a>ä¿®æ”¹æ–‡ä»¶å</h3><p>å°±æ˜¯å°†æˆ‘ä»¬ä»charlesä¸­å¯¼å‡ºçš„xxxxx.pemæ–‡ä»¶åæ”¹ä¸º07cc5b45.0</p>
<h3 id="pushåˆ°æ‰‹æœºä¸­ï¼ˆéœ€è¦rootï¼‰"><a href="#pushåˆ°æ‰‹æœºä¸­ï¼ˆéœ€è¦rootï¼‰" class="headerlink" title="pushåˆ°æ‰‹æœºä¸­ï¼ˆéœ€è¦rootï¼‰"></a>pushåˆ°æ‰‹æœºä¸­ï¼ˆéœ€è¦rootï¼‰</h3><p>/system/etc/security/cacerts/</p>
<p>æ”¾å…¥çš„è¿‡ç¨‹ä¸­ï¼Œä¸Šè¿°æ–‡ä»¶åç¼€åçš„æ•°å­—æ˜¯ä¸ºäº†é˜²æ­¢æ–‡ä»¶åå†²çªçš„ï¼Œæ¯”å¦‚å¦‚æœä¸¤ä¸ªè¯ä¹¦ç®—å‡ºçš„Hashå€¼æ˜¯ä¸€æ ·çš„è¯ï¼Œé‚£ä¹ˆä¸€ä¸ªè¯ä¹¦çš„åç¼€åæ•°å­—å¯ä»¥è®¾ç½®æˆ0ï¼Œè€Œå¦ä¸€ä¸ªè¯ä¹¦çš„åç¼€åæ•°å­—å¯ä»¥è®¾ç½®æˆ1ï¼ˆ07cc5b45.1ï¼‰ã€‚</p>
<h3 id="è¯ä¹¦å®‰è£…æˆåŠŸ"><a href="#è¯ä¹¦å®‰è£…æˆåŠŸ" class="headerlink" title="è¯ä¹¦å®‰è£…æˆåŠŸ"></a>è¯ä¹¦å®‰è£…æˆåŠŸ</h3><p>æ­¤æ—¶ä½ åº”è¯¥å¯ä»¥åœ¨ è®¾ç½®-&gt;å®‰å…¨-&gt;ä¿¡ä»»çš„å‡­æ® çš„ç³»ç»Ÿæ ‡ç­¾é¡µçœ‹åˆ°ä½ æ–°åŠ å…¥çš„è¯ä¹¦ï¼Œå°†å…¶å¯ç”¨å³å¯é¡ºåˆ©æŠ“åŒ…ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/09/20/Android-7-0ä¹‹åæŠ“åŒ…è¯ä¹¦æ— æ•ˆçš„è§£å†³æ–¹æ¡ˆ/certsuc.png" alt="certsuc" title class>
                <p>certsuc</p>
            </figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/shadowyspirits/article/details/79756274" target="_blank" rel="noopener">Android 7.0 ä¹‹åæŠ“åŒ… unknown å’Œè¯ä¹¦æ— æ•ˆçš„è§£å†³æ–¹æ¡ˆï¼ˆæ— éœ€æ”¹ä»£ç )</a></p>
]]></content>
      
        <categories>
            
            <category> Charles </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Charles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[gitlab api ä½¿ç”¨é—®é¢˜]]></title>
      <url>/2019/08/29/gitlab-api-%E4%BD%BF%E7%94%A8%E9%97%AE%E9%A2%98/</url>
      <content type="html"><![CDATA[<p>åœ¨æˆ‘ä»¬ä½¿ç”¨gitlabè·å–æ•°æ®çš„æ—¶å€™ï¼Œä¸€èˆ¬è¿”å›çš„æ•°æ®éƒ½æ˜¯æ¯é¡µ20æ¡æ•°æ®ï¼Œä½†æ˜¯å¦‚æœæˆ‘ä»¬æƒ³ä¸€æ¬¡è·å–è·å–å¤šäº20æ¡æ€ä¹ˆåŠï¼Ÿå…¶å®gitlabæœ‰ä¸¤ä¸ªå‚æ•°å¯ä»¥è®¾ç½®ã€‚pageå’Œper_pageï¼Œå¯ä»¥åˆ†åˆ«è®¾ç½®é¡µæ•°å’Œæ¡æ•°ï¼ŒåŠ åˆ°è¯·æ±‚å‚æ•°é‡Œå³å¯ã€‚<br>APIå¦‚ä¸‹ï¼š</p>
<h2 id="Pagination"><a href="#Pagination" class="headerlink" title="Pagination"></a>Pagination</h2><p>Sometimes the returned result will span across many pages. When listing<br>resources you can pass the following parameters:</p>
<table>
<thead>
<tr>
<th>Parameter</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>page</td>
<td>Page number (default: 1)</td>
</tr>
<tr>
<td>per_page</td>
<td>Number of items to list per page (default: 20, max: 100)</td>
</tr>
</tbody></table>
]]></content>
      
        <categories>
            
            <category> GitLab </category>
            
        </categories>
        
        
        <tags>
            
            <tag> GitLab </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[é€šè¿‡ngrokæ­å»ºgithubçš„webhook]]></title>
      <url>/2019/08/21/%E9%80%9A%E8%BF%87ngrok%E6%90%AD%E5%BB%BAgithub%E7%9A%84webhook/</url>
      <content type="html"><![CDATA[<h2 id="WebHook"><a href="#WebHook" class="headerlink" title="WebHook"></a>WebHook</h2><h3 id="webhookæ¦‚è¿°"><a href="#webhookæ¦‚è¿°" class="headerlink" title="webhookæ¦‚è¿°"></a>webhookæ¦‚è¿°</h3><p>When one of those events is triggered, weâ€™ll send a HTTP POST payload to the webhookâ€™s configured URL. Webhooks can be used to update an external issue tracker, trigger CI builds, update a backup mirror, or even deploy to your production server. Youâ€™re only limited by your imagination.</p>
<p>Webhooks can be installed on an organization, a specific repository, or a GitHub App. Once installed, the webhook will be sent each time one or more subscribed events occurs.</p>
<p>You can create up to 20 webhooks for each event on each installation target (specific organization or specific repository).<br>Learn more in our <a href="https://developer.github.com/webhooks/" target="_blank" rel="noopener">Webhooks Guide</a>.</p>
<p>å½“è§¦å‘å…¶ä¸­ä¸€ä¸ªäº‹ä»¶æ—¶ï¼Œæˆ‘ä»¬å°†å‘webhooké…ç½®çš„URLå‘é€httppostè´Ÿè½½ã€‚webhookå¯ä»¥ç”¨äºæ›´æ–°å¤–éƒ¨é—®é¢˜è·Ÿè¸ªç¨‹åºã€è§¦å‘CIæ„å»ºã€æ›´æ–°å¤‡ä»½é•œåƒï¼Œç”šè‡³å¯ä»¥éƒ¨ç½²åˆ°ç”Ÿäº§æœåŠ¡å™¨ã€‚webhookä¸èƒ½åšçš„çš„ï¼Œå¯èƒ½æ˜¯å—åˆ°æƒ³è±¡åŠ›çš„é™åˆ¶ã€‚</p>
<p>webhookå¯ä»¥å®‰è£…åœ¨ç»„ç»‡ã€ç‰¹å®šå­˜å‚¨åº“æˆ–GitHubåº”ç”¨ç¨‹åºä¸Šã€‚ä¸€æ—¦å®‰è£…ï¼Œwebhookå°†åœ¨æ¯æ¬¡å‘ç”Ÿä¸€ä¸ªæˆ–å¤šä¸ªè®¢é˜…äº‹ä»¶æ—¶å‘é€ã€‚</p>
<p>æ‚¨å¯ä»¥ä¸ºæ¯ä¸ªå®‰è£…ç›®æ ‡ï¼ˆç‰¹å®šç»„ç»‡æˆ–ç‰¹å®šå­˜å‚¨åº“ï¼‰ä¸Šçš„æ¯ä¸ªäº‹ä»¶åˆ›å»ºæœ€å¤š20ä¸ªwebhookã€‚</p>
<p>æ‰€ä»¥ï¼ŒWebhooké¡¾åæ€ä¹‰ï¼Œå…¶å®å°±æ˜¯ä¸€é’©å­ã€‚å½“æˆ‘ä»¬åœ¨Githubä¸Šåšå‡ºæŸäº›ç‰¹å®šæ“ä½œæ—¶ï¼Œå¯ä»¥è§¦å‘é’©å­ï¼Œå»è¿›è¡Œä¸€äº›æˆ‘ä»¬äº‹å…ˆè®¾å®šå¥½çš„è„šæœ¬ï¼Œä»¥è¾¾åˆ°æŸäº›ç‰¹å®šåŠŸèƒ½ï¼ˆä¾‹å¦‚â€“å‰ç«¯é¡¹ç›®è‡ªåŠ¨å‘å¸ƒï¼‰ã€‚</p>
<h3 id="githubä¸Šwebhookè®¾ç½®"><a href="#githubä¸Šwebhookè®¾ç½®" class="headerlink" title="githubä¸Šwebhookè®¾ç½®"></a>githubä¸Šwebhookè®¾ç½®</h3><p>åœ¨é…ç½®webhookçš„æ—¶å€™ï¼Œä½ å¯ä»¥é€‰æ‹©è‡ªå·±æƒ³è¦æ¥æ”¶çš„äº‹ä»¶ã€‚ä½ ç”šè‡³å¯ä»¥é€‰æ‹©å‚åŠ è§¦å‘æ‰€æœ‰äº‹ä»¶ã€‚åªæœ‰è®¢é˜…ç‰¹æ®Šçš„éœ€è¦çš„äº‹ä»¶ï¼Œå¯ä»¥æœ‰æ•ˆé™åˆ¶æœåŠ¡å™¨HTTPè¯·æ±‚æ•°ã€‚å¯ä»¥é€šè¿‡APIæˆ–è€…URéšæ—¶è®¢é˜…äº‹ä»¶ã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œwebhookåªè®¢é˜…pushäº‹ä»¶ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/21/é€šè¿‡ngrokæ­å»ºgithubçš„webhook/webhooks.png" alt="webhooks position" title class>
                <p>webhooks position</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/21/é€šè¿‡ngrokæ­å»ºgithubçš„webhook/webhooksuc.png" alt="add webhook" title class>
                <p>add webhook</p>
            </figure>
<p>ä¸Šå›¾æ˜¯æˆ‘è®¾ç½®çš„å¥½çš„webhookï¼šå¯ä»¥çœ‹åˆ°æˆ‘è®¾ç½®å¥½äº†Payload URLå’ŒContent type.</p>
<p>Payload URLï¼šå°±æ˜¯æˆ‘ä»¬è¦è®¾ç½®çš„é’©å­ã€‚</p>
<p>Content typeï¼šæ˜¯åœ¨é€šçŸ¥æˆ‘ä»¬æ—¶ä¼ é€’çš„å†…å®¹ç±»å‹ï¼Œä¸€èˆ¬æƒ…å†µä¸‹æˆ‘ä»¬é€‰æ‹©jsonæ•°æ®æ ¼å¼ã€‚è¿˜æœ‰å¦å¤–ä¸€ç§ç±»å‹ï¼šapplication/x-www-form-urlencodedã€‚</p>
<p>Which events would you like to trigger this webhook?ï¼šè¿™ä¸ªé€‰æ‹©æ¯”è¾ƒé‡è¦ï¼Œç›´æ¥å†³å®šäº†å½“ä»“åº“å‘ç”Ÿä»€ä¹ˆå˜åŒ–æ—¶æ‰å¯¹æˆ‘ä»¬è¿›è¡Œé€šçŸ¥ã€‚</p>
<p>åˆ°æ­¤webhookæ·»åŠ å®Œæˆã€‚</p>
<h3 id="è´Ÿè½½æ•°æ®å±æ€§"><a href="#è´Ÿè½½æ•°æ®å±æ€§" class="headerlink" title="è´Ÿè½½æ•°æ®å±æ€§"></a>è´Ÿè½½æ•°æ®å±æ€§</h3><p>æ¯ä¸ªwebhookäº‹ä»¶è´Ÿè½½è¿˜åŒ…å«äº‹ä»¶ç‰¹æœ‰çš„å±æ€§ã€‚</p>
<table>
<thead>
<tr>
<th>Key</th>
<th>Type</th>
<th>Description</th>
</tr>
</thead>
<tbody><tr>
<td>action</td>
<td>string</td>
<td>Most webhook payloads contain an action property that contains the specific activity that triggered the event.</td>
</tr>
<tr>
<td>sender</td>
<td>object</td>
<td>The user that triggered the event. This property is included in every webhook payload.</td>
</tr>
<tr>
<td>repository</td>
<td>object</td>
<td>The repository where the event occurred. Webhook payloads contain the repository property when the event occurs from activity in a repository.</td>
</tr>
<tr>
<td>organization</td>
<td>object</td>
<td>Webhook payloads contain the organization object when the webhook is configured for an organization or the event occurs from activity in a repository owned by an organization.</td>
</tr>
<tr>
<td>installation</td>
<td>object</td>
<td>The GitHub App installation. Webhook payloads contain the installation property when the event is configured for and sent to a GitHub App. For more information, see â€œBuilding GitHub App.â€</td>
</tr>
</tbody></table>
<p><strong>æ³¨æ„ï¼š</strong></p>
<blockquote>
<p>Payloads are capped at 25 MB. If your event generates a larger payload, a<br>webhook will not be fired. This may happen, for example, on a create event if  many branches or tags are pushed at once.</p>
</blockquote>
<h3 id="æŠ¥æ–‡å¤´"><a href="#æŠ¥æ–‡å¤´" class="headerlink" title="æŠ¥æ–‡å¤´"></a>æŠ¥æ–‡å¤´</h3><p>å‘é€åˆ°webhooké…ç½®URLçš„HTTP POSTè´Ÿè½½ä¼šåŒ…å«å‡ ä¸ªæŒ‡å®šçš„æŠ¥æ–‡å¤´ã€‚</p>
<p>X-GitHub-Eventï¼šè§¦å‘åˆ†å‘çš„äº‹ä»¶ç±»å‹ã€‚<br>X-GitHub-Deliveryï¼šå”¯ä¸€è¯†åˆ«åˆ†å‘çš„GUIDã€‚<br>X-Hub-Signatureï¼šHMACåå…­è¿›åˆ¶çš„å“åº”ä½“ã€‚<br>X-Hub-Signature-256ï¼š<br>å¦‚æœsecreté…ç½®äº†ï¼Œè¿™ä¸ªå¤´ä¿¡æ¯å°†è¢«å‘é€ã€‚HMACåå…­è¿›åˆ¶ç”±sha1å“ˆå¸Œç®—æ³•ç”Ÿæˆï¼Œsecretä½œä¸ºHMACçš„keyã€‚</p>
<h3 id="äº‹ä¾‹"><a href="#äº‹ä¾‹" class="headerlink" title="äº‹ä¾‹"></a>äº‹ä¾‹</h3><p>é€šè¿‡pythoné…ç½®ä¸€ä¸ªç®€å•çš„æœåŠ¡å™¨ï¼Œç”¨äºæ¥æ”¶é€šçŸ¥ä¿¡æ¯ã€‚å…·ä½“äº‹ä¾‹å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@route(&apos;/payload&apos;, method=[&apos;GET&apos;,&apos;POST&apos;])</span><br><span class="line">def payload():</span><br><span class="line">    print(&apos;payload----request.json:&apos;+request.json.__str__())</span><br><span class="line">    print(&apos;payload----request.headers.X-GitHub-Event:&apos;+request.get_header(&apos;X-GitHub-Event&apos;))</span><br><span class="line">    print(&apos;payload----request.headers.X-GitHub-Delivery:&apos;+request.get_header(&apos;X-GitHub-Delivery&apos;))</span><br><span class="line">    return &quot;hello world&quot;</span><br></pre></td></tr></table></figure>

<p>è¿™ä¸ªæ—¶å€™æˆ‘ä»¬æ‰‹åŠ¨pushä¸€ä¸ªä¿¡æ¯ï¼Œæ‰“å°ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">	&quot;ref&quot;: &quot;refs/heads/master&quot;,</span><br><span class="line">	&quot;before&quot;: &quot;fc7585b3799386a625a2584b75c3e94424212889&quot;,</span><br><span class="line">	&quot;after&quot;: &quot;db7bbed15a40cec6c3cbbd778877fee8941bf86d&quot;,</span><br><span class="line">	&quot;created&quot;: false,</span><br><span class="line">	&quot;deleted&quot;: false,</span><br><span class="line">	&quot;forced&quot;: false,</span><br><span class="line">	&quot;base_ref&quot;: &quot;none&quot;,</span><br><span class="line">	&quot;compare&quot;: &quot;https://github.com/nunu03/photo/compare/fc7585b37993...db7bbed15a40&quot;,</span><br><span class="line">	&quot;commits&quot;: [&#123;</span><br><span class="line">		&quot;id&quot;: &quot;db7bbed15a40cec6c3cbbd778877fee8941bf86d&quot;,</span><br><span class="line">		&quot;tree_id&quot;: &quot;8394661d6d3855d60e431ad5a73a88b03e6944ab&quot;,</span><br><span class="line">		&quot;distinct&quot;: true,</span><br><span class="line">		&quot;message&quot;: &quot;6 update and commit&quot;,</span><br><span class="line">		&quot;timestamp&quot;: &quot;2019-08-21T18:04:00+08:00&quot;,</span><br><span class="line">		&quot;url&quot;: &quot;https://github.com/nunu03/photo/commit/db7bbed15a40cec6c3cbbd778877fee8941bf86d&quot;,</span><br><span class="line">		&quot;author&quot;: &#123;</span><br><span class="line">			&quot;name&quot;: &quot;YlJava110&quot;,</span><br><span class="line">			&quot;email&quot;: &quot;594531261@qq.com&quot;,</span><br><span class="line">			&quot;username&quot;: &quot;nunu03&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;committer&quot;: &#123;</span><br><span class="line">			&quot;name&quot;: &quot;YlJava110&quot;,</span><br><span class="line">			&quot;email&quot;: &quot;594531261@qq.com&quot;,</span><br><span class="line">			&quot;username&quot;: &quot;nunu03&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;added&quot;: [],</span><br><span class="line">		&quot;removed&quot;: [],</span><br><span class="line">		&quot;modified&quot;: [&quot;P2.docx&quot;]</span><br><span class="line">	&#125;],</span><br><span class="line">	&quot;head_commit&quot;: &#123;</span><br><span class="line">		&quot;id&quot;: &quot;db7bbed15a40cec6c3cbbd778877fee8941bf86d&quot;,</span><br><span class="line">		&quot;tree_id&quot;: &quot;8394661d6d3855d60e431ad5a73a88b03e6944ab&quot;,</span><br><span class="line">		&quot;distinct&quot;: true,</span><br><span class="line">		&quot;message&quot;: &quot;6 update and commit&quot;,</span><br><span class="line">		&quot;timestamp&quot;: &quot;2019-08-21T18:04:00+08:00&quot;,</span><br><span class="line">		&quot;url&quot;: &quot;https://github.com/nunu03/photo/commit/db7bbed15a40cec6c3cbbd778877fee8941bf86d&quot;,</span><br><span class="line">		&quot;author&quot;: &#123;</span><br><span class="line">			&quot;name&quot;: &quot;YlJava110&quot;,</span><br><span class="line">			&quot;email&quot;: &quot;594531261@qq.com&quot;,</span><br><span class="line">			&quot;username&quot;: &quot;nunu03&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;committer&quot;: &#123;</span><br><span class="line">			&quot;name&quot;: &quot;YlJava110&quot;,</span><br><span class="line">			&quot;email&quot;: &quot;594531261@qq.com&quot;,</span><br><span class="line">			&quot;username&quot;: &quot;nunu03&quot;</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;added&quot;: [],</span><br><span class="line">		&quot;removed&quot;: [],</span><br><span class="line">		&quot;modified&quot;: [&quot;P2.docx&quot;]</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;repository&quot;: &#123;</span><br><span class="line">		&quot;id&quot;: 158326464,</span><br><span class="line">		&quot;node_id&quot;: &quot;MDEwOlJlcG9zaXRvcnkxNTgzMjY0NjQ=&quot;,</span><br><span class="line">		&quot;name&quot;: &quot;photo&quot;,</span><br><span class="line">		&quot;full_name&quot;: &quot;nunu03/photo&quot;,</span><br><span class="line">		&quot;private&quot;: false,</span><br><span class="line">		&quot;owner&quot;: &#123;</span><br><span class="line">			&quot;name&quot;: &quot;nunu03&quot;,</span><br><span class="line">			&quot;email&quot;: &quot;594531261@qq.com&quot;,</span><br><span class="line">			&quot;login&quot;: &quot;nunu03&quot;,</span><br><span class="line">			&quot;id&quot;: 9353063,</span><br><span class="line">			&quot;node_id&quot;: &quot;MDQ6VXNlcjkzNTMwNjM=&quot;,</span><br><span class="line">			&quot;avatar_url&quot;: &quot;https://avatars0.githubusercontent.com/u/9353063?v=4&quot;,</span><br><span class="line">			......</span><br><span class="line">		&#125;,</span><br><span class="line">		&quot;created_at&quot;: 1542684949,</span><br><span class="line">		......</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;pusher&quot;: &#123;</span><br><span class="line">		&quot;name&quot;: &quot;nunu03&quot;,</span><br><span class="line">		&quot;email&quot;: &quot;594531261@qq.com&quot;</span><br><span class="line">	&#125;,</span><br><span class="line">	&quot;sender&quot;: &#123;</span><br><span class="line">		&quot;login&quot;: &quot;nunu03&quot;,</span><br><span class="line">		&quot;id&quot;: 9353063,</span><br><span class="line">		......</span><br><span class="line">		&quot;type&quot;: &quot;User&quot;,</span><br><span class="line">		&quot;site_admin&quot;: false</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">payload----request.headers.X-GitHub-Event:push</span><br><span class="line">payload----request.headers.X-GitHub-Delivery:7a8185c4-c40a-11e9-8ed7-401aabcf3ce7</span><br></pre></td></tr></table></figure>

<p>äº‹ä»¶çš„é©±åŠ¨ä¿¡æ¯å¯ä»¥åœ¨webhookä¸­æŸ¥çœ‹ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/21/é€šè¿‡ngrokæ­å»ºgithubçš„webhook/webhookimage.jpg" alt="webhook deliveries" title class>
                <p>webhook deliveries</p>
            </figure>

<p><a href="https://igit.58corp.com/help/api/README.md" target="_blank" rel="noopener">igit api help</a></p>
<h2 id="ngroké…ç½®"><a href="#ngroké…ç½®" class="headerlink" title="ngroké…ç½®"></a>ngroké…ç½®</h2><p>ä½ è®¾ç½®å¥½äº†é’©å­ï¼Œé‚£å°±éœ€è¦å½“æ”¶åˆ°é€šçŸ¥çš„æ—¶å€™è¿›è¡Œæ¥æ”¶å¤„ç†ã€‚è¿™ä¸ªæ—¶å€™è¦æ³¨æ„ï¼Œæˆ‘ä»¬çš„é’©å­é‡Œè¦æ±‚ä½ çš„æœåŠ¡å™¨èƒ½è¿æ¥åˆ°å¤–ç½‘ä¸Šã€‚é‚£æ€ä¹ˆåŠï¼Œæˆ‘ä»¬æœ¬åœ°åšæœåŠ¡å™¨ï¼Œè‚¯å®šå°±æ”¶ä¸åˆ°é€šçŸ¥äº†ã€‚è¿™ä¸ªæ—¶å€™æ¨èä¸€ä¸ªç¥å™¨ngrokï¼Œå®ƒå°±å¯ä»¥è®©ä½ åœ¨æœ¬åœ°å°±æœ‰ä¸€ä¸ªå¤–ç½‘åœ°å€ã€‚<a href="https://ngrok.com/download" target="_blank" rel="noopener">ngrokä¸‹è½½åœ°å€</a>.ä¸‹è½½ä¹‹åï¼Œåœ¨ngrokç›®å½•æ‰§è¡Œcmdï¼š./ngrok http 4567ï¼Œå¼¹å‡ºä¸‹é¢çš„ç•Œé¢ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/21/é€šè¿‡ngrokæ­å»ºgithubçš„webhook/ngrok.png" alt="ngrok start" title class>
                <p>ngrok start</p>
            </figure>
<p>å¯ä»¥çœ‹åˆ°æˆ‘ä»¬æœ¬åœ°æœåŠ¡å™¨çš„åœ°å€è¢«æ˜ å°„åˆ°äº†ä¸€ä¸ªå¤–ç½‘çš„åœ°å€ã€‚è€Œè¿™ä¸ª<a href="http://4c8a9e3f.ngrok.io/å°±æ˜¯ä¸Šå›¾ä¸­æˆ‘ä»¬è®¾ç½®å¥½çš„Payload" target="_blank" rel="noopener">http://4c8a9e3f.ngrok.io/å°±æ˜¯ä¸Šå›¾ä¸­æˆ‘ä»¬è®¾ç½®å¥½çš„Payload</a> URLã€‚</p>
<p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬è°ƒè¯•ç¨‹åºçš„æ—¶å€™ï¼Œngrokè¦æ‰“å¼€ï¼Œå¹¶ä¸”æ¯æ¬¡å¯åŠ¨ngrokï¼Œå¤–ç½‘åœ°å€éƒ½ä¸åŒï¼Œæ¯æ¬¡å¯åŠ¨æœ‰æ•ˆæ—¶é—´ä¸º8å°æ—¶ã€‚</p>
<h3 id="ngrokæ³¨å†Œ"><a href="#ngrokæ³¨å†Œ" class="headerlink" title="ngrokæ³¨å†Œ"></a>ngrokæ³¨å†Œ</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/21/é€šè¿‡ngrokæ­å»ºgithubçš„webhook/authtoken.png" alt="ngrok register" title class>
                <p>ngrok register</p>
            </figure>

<p>é€šè¿‡å®˜ç½‘æ³¨å†Œï¼Œæ‹¿åˆ°äº†authtokenï¼Œç„¶åä¿å­˜å³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">chenyulong01deMacBook-Pro:ngrok chenyulong01$ ./ngrok authtoken 1mg5VxMW7jhF3J90SBAerxFulVJ_7YWWYmNVX4C3jYyYoz5xR</span><br><span class="line">Authtoken saved to configuration file: /Users/chenyulong01/.ngrok2/ngrok.yml</span><br><span class="line"></span><br><span class="line">chenyulong01deMacBook-Pro:ngrok chenyulong01$ ./ngrok http 4567</span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨open .ngrok2 æ‰“å¼€ngrok.ymlæ–‡ä»¶å¤¹ï¼Œngrok.ymlä¸­å­˜å‚¨äº†Authtokenï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥ä¿®æ”¹å…¶å†…å®¹ï¼Œå¢åŠ root_cas: trustedï¼Œå¯ä»¥è§£å†³How to fix ngrok reconnecting (x509 certificate signed by unknown authority)å¼‚å¸¸é—®é¢˜ã€‚</p>
<h3 id="å…¶ä»–åä»£ç†å·¥å…·"><a href="#å…¶ä»–åä»£ç†å·¥å…·" class="headerlink" title="å…¶ä»–åä»£ç†å·¥å…·"></a>å…¶ä»–åä»£ç†å·¥å…·</h3><p>localtunnelï¼Œnatappï¼ŒèŠ±ç”Ÿå£³</p>
<h2 id="é…ç½®æœåŠ¡å™¨"><a href="#é…ç½®æœåŠ¡å™¨" class="headerlink" title="é…ç½®æœåŠ¡å™¨"></a>é…ç½®æœåŠ¡å™¨</h2><h3 id="bottle"><a href="#bottle" class="headerlink" title="bottle"></a>bottle</h3><p>Bottleæ˜¯ä¸€ä¸ªç®€å•é«˜æ•ˆçš„éµå¾ªWSGIçš„å¾®å‹python Webæ¡†æ¶ã€‚bottleå‡ ä¹æ²¡æœ‰ä»»ä½•ä¾èµ–ï¼Œè€Œä¸”åªæœ‰ä¸€ä¸ªæ–‡ä»¶ã€‚è€Œç›¸å¯¹äºpythoné»˜è®¤çš„SimpleHTTPServerï¼ŒåŠŸèƒ½æ›´åŠ ä¸°å¯Œï¼Œå®ç”¨æ›´åŠ çµæ´»ã€‚å¦‚æœåªæ˜¯å¼€å‘ä¸€ä¸ªå°å‹çš„webç¨‹åºï¼Œbottleå·²ç»è¶³å¤Ÿäº†ã€‚ä½†æ˜¯è¿™ä¸ªæœåŠ¡å™¨æ˜¯é˜»å¡å¼çš„ï¼Œå½“ä¸€ä¸ªç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…¶ä»–ç”¨æˆ·çš„è¯·æ±‚ä¼šè¢«é˜»å¡ã€‚å¯ä»¥å¾ˆç®€å•çš„ä½¿ç”¨å…¶ä»–çš„æ¡†æ¶æ¥é…åˆbottleæ¥å®ç°æ— é˜»å¡çš„webæœåŠ¡å™¨ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@route(&apos;/&apos;)</span><br><span class="line">@route(&apos;/index.html&apos;)</span><br><span class="line">def index():</span><br><span class="line">    return &apos;&lt;a href=&quot;/hello&quot;&gt;Go to Hello World Page&lt;/a&gt;&apos;</span><br><span class="line">@route(&apos;/hello&apos;)</span><br><span class="line">def hello():</span><br><span class="line">    return &apos;Hello World&apos;</span><br><span class="line">@route(&apos;/hello/&lt;id&gt;&apos;)</span><br><span class="line">def hello(id):</span><br><span class="line">    return &apos;Hello World&apos;</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">server_names = &#123;</span><br><span class="line">    &apos;cgi&apos;: CGIServer,</span><br><span class="line">    &apos;flup&apos;: FlupFCGIServer,</span><br><span class="line">    &apos;wsgiref&apos;: WSGIRefServer,</span><br><span class="line">    &apos;waitress&apos;: WaitressServer,</span><br><span class="line">    &apos;cherrypy&apos;: CherryPyServer,</span><br><span class="line">    &apos;paste&apos;: PasteServer,</span><br><span class="line">    &apos;fapws3&apos;: FapwsServer,</span><br><span class="line">    &apos;tornado&apos;: TornadoServer,</span><br><span class="line">    &apos;gae&apos;: AppEngineServer,</span><br><span class="line">    &apos;twisted&apos;: TwistedServer,</span><br><span class="line">    &apos;diesel&apos;: DieselServer,</span><br><span class="line">    &apos;meinheld&apos;: MeinheldServer,</span><br><span class="line">    &apos;gunicorn&apos;: GunicornServer,</span><br><span class="line">    &apos;eventlet&apos;: EventletServer,</span><br><span class="line">    &apos;gevent&apos;: GeventServer,</span><br><span class="line">    &apos;geventSocketIO&apos;:GeventSocketIOServer,</span><br><span class="line">    &apos;rocket&apos;: RocketServer,</span><br><span class="line">    &apos;bjoern&apos; : BjoernServer,</span><br><span class="line">    &apos;auto&apos;: AutoServer,</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="paste"><a href="#paste" class="headerlink" title="paste"></a>paste</h3><table>
<tbody>
<tr><th style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);font-size:1.2em;">
åç§°</th>
<th style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);font-size:1.2em;">
ä¸»é¡µ</th>
<th style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);font-size:1.2em;">
ä»‹ç»</th>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
cgi</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
 </td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
ä»¥CGIè„šæœ¬è¿è¡Œ</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
flup</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://trac.saddi.com/flup" rel="noopener" title="FLUP" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="c7b4b5077834a0ed1f5c0a4bca14f4cf" target="_blank">http://trac.saddi.com/flup</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
ä»¥FastCGIè¿›ç¨‹è¿è¡Œ</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
gae</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://code.google.com/appengine/docs/python/overview.html" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="288e3bc1b26e0f48f7cbdecc50951f37" target="_blank">http://code.google.com/appengine/docs/python/overview.html</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Google App Engineéƒ¨å±</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
wsgiref</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://docs.python.org/library/wsgiref.html" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="237e23e44a4365b59fcc33b28a891844" target="_blank">http://docs.python.org/library/wsgiref.html</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
é»˜è®¤ä¸ºå•çº¿ç¨‹çš„æœåŠ¡å™¨</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
cherrypy</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://www.cherrypy.org/" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="72c50cd82c583c625d441d5022206177" target="_blank">http://www.cherrypy.org/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
å¤šçº¿ç¨‹æœåŠ¡å™¨</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
paste</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://pythonpaste.org/" rel="noopener" title="http://pythonpaste.org/" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="71228709dedcb943fefeb0aec3bbd640" target="_blank">http://pythonpaste.org/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
å¤šçº¿ç¨‹æœåŠ¡å™¨</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
rocket</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://pypi.python.org/pypi/rocket" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="cefb0f508a65db9aca1af3f78aa8df61" target="_blank">http://pypi.python.org/pypi/rocket</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
å¤šçº¿ç¨‹æœåŠ¡å™¨</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
gunicorn</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://pypi.python.org/pypi/gunicorn" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="9a58bd759fbfdbd2c6bb60b30eb894f3" target="_blank">http://pypi.python.org/pypi/gunicorn</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
éƒ¨åˆ†ç”¨Cç¼–å†™</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
fapws3</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://www.fapws.org/" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="7380c8ebddf823041cb3785a15444f1e" target="_blank">http://www.fapws.org/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronousï¼ŒåŸºäºCå¼€å‘</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
tornado</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://www.tornadoweb.org/" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="28816a7f106f3be4d11b72a58302eabb" target="_blank">http://www.tornadoweb.org/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronousï¼ŒæœåŠ¡äº†éƒ¨åˆ† FaceBook çš„æœåŠ¡</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
twisted</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://twistedmatrix.com/" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="c11813c5b43ff62fd484194d38ea9b09" target="_blank">http://twistedmatrix.com/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronous</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
gevent</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://www.gevent.org/" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="8739ffd1da6ba93b622d20965903c018" target="_blank">http://dieselweb.org/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronousï¼ŒåŸºäºGreenlet</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
diesel</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://dieselweb.org/" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="8739ffd1da6ba93b622d20965903c018" target="_blank">http://dieselweb.org/</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronousï¼ŒåŸºäºGreenlet</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
meinheld</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://pypi.python.org/pypi/meinheld" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="e8fc885d48908fbe74c4848d401bb8f0" target="_blank">http://pypi.python.org/pypi/meinheld</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronousï¼Œéƒ¨åˆ†åŸºäºCå¼€å‘</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
bjoern</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
<a href="http://pypi.python.org/pypi/bjoern" rel="noopener" style="text-decoration:none;color:rgb(38,94,21);border-bottom-color:rgb(153,102,51);border-bottom-width:1px;border-bottom-style:dashed;" data-token="f9fa6703b208a2b47317f58614c91139" target="_blank">http://pypi.python.org/pypi/bjoern</a></td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
Asynchronousï¼Œéå¸¸å¿«ï¼ŒåŸºäºCå¼€å‘</td>
</tr>

<tr><td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
auto</td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
 </td>
<td style="border-bottom-width:1px;border-bottom-style:solid;border-bottom-color:rgb(221,221,221);">
è‡ªåŠ¨é€‰æ‹©ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å™¨</td>
</tr>
</tbody>
</table>
å¯ä»¥çœ‹åˆ°ï¼Œbottleé€‚é…çš„webæœåŠ¡å™¨å¾ˆä¸°å¯Œã€‚å·¥ä½œæ¨¡å¼ä¹Ÿå¾ˆå…¨é¢ï¼Œæœ‰å¤šçº¿ç¨‹çš„ï¼ˆå¦‚pasteï¼‰ã€æœ‰å¤šè¿›ç¨‹æ¨¡å¼çš„ï¼ˆå¦‚gunicornï¼‰ã€ä¹Ÿæœ‰åŸºäºåç¨‹çš„ï¼ˆå¦‚geventï¼‰ã€‚

<h3 id="å¯åŠ¨"><a href="#å¯åŠ¨" class="headerlink" title="å¯åŠ¨"></a>å¯åŠ¨</h3><p>nohup python3 -u githook.py &gt; nohup.log 2&gt;&amp;1 &amp;</p>
<p>nohupï¼šæ”¾åœ¨å‘½ä»¤çš„å¼€å¤´ï¼Œè¡¨ç¤ºä¸æŒ‚èµ·ï¼ˆno hang upï¼‰ï¼Œä¹Ÿå³ï¼Œå…³é—­ç»ˆç«¯æˆ–è€…é€€å‡ºæŸä¸ªè´¦å·ï¼Œè¿›ç¨‹ä¹Ÿç»§ç»­ä¿æŒè¿è¡ŒçŠ¶æ€ã€‚</p>
<p>-u ï¼šä¸å¯ç”¨ç¼“å†²ã€‚</p>
<p>nohup.logï¼šæ—¥å¿—æ–‡ä»¶</p>
<p>2&gt;&amp;1ï¼šä¹Ÿå°±è¡¨ç¤ºå°†é”™è¯¯é‡å®šå‘åˆ°æ ‡å‡†è¾“å‡ºä¸Š</p>
<p>&amp; ï¼šæ”¾åœ¨å‘½ä»¤åˆ°ç»“å°¾ï¼Œè¡¨ç¤ºåå°è¿è¡Œï¼Œé˜²æ­¢ç»ˆç«¯ä¸€ç›´è¢«æŸä¸ªè¿›ç¨‹å ç”¨ï¼Œè¿™æ ·ç»ˆç«¯å¯ä»¥æ‰§è¡Œåˆ«åˆ°ä»»åŠ¡ã€‚</p>
<p><strong>æ³¨æ„ä½¿ç”¨nohupå‘½ä»¤åå°è¿è¡Œå‘½ä»¤ä¹‹åï¼Œéœ€è¦ä½¿ç”¨exitæ­£å¸¸é€€å‡ºå½“å‰è´¦æˆ·ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯å‘½ä»¤ä¸€ç›´åœ¨åå°è¿è¡Œã€‚å¦åˆ™å½“å‰è´¦æˆ·éæ­£å¸¸é€€å‡ºæˆ–è€…ç»“æŸçš„æ—¶å€™ï¼Œå‘½ä»¤è¿˜æ˜¯ä¼šç»“æŸã€‚</strong></p>
<h3 id="æ³¨æ„ç‚¹"><a href="#æ³¨æ„ç‚¹" class="headerlink" title="æ³¨æ„ç‚¹"></a>æ³¨æ„ç‚¹</h3><p>1.æˆ‘ä»¬çš„è·¯ç”±@route(â€˜/payloadâ€™, method=[â€˜GETâ€™,â€™POSTâ€™])æ˜¯å¿…å¡«çš„ï¼Œå¦‚æœä¸¢å¤±method,æˆ‘ä»¬å°†ä¸èƒ½å—åˆ°è¯·æ±‚ã€‚åŒæ—¶payloadï¼Œè¦ä¸Payload URLä¸­è®¾ç½®çš„åä¸€æ ·ã€‚</p>
<p>2.requests</p>
<p>print(r):&lt;Response [200]&gt;<br>print(r.json):{â€˜idâ€™: 132968, â€˜iidâ€™: 2182437, â€˜project_idâ€™: 15509,<br>print(r.text):{â€œidâ€:132968,â€iidâ€:2182437,â€project_idâ€:15509,<br>json.dumps(r.json())</p>
<p>3.can only concatenate str (not â€œintâ€) to str</p>
<p>print(â€˜payloadâ€”-projectid:%dâ€™ % projectid)</p>
<h2 id="MRæ–¹æ¡ˆ"><a href="#MRæ–¹æ¡ˆ" class="headerlink" title="MRæ–¹æ¡ˆ"></a>MRæ–¹æ¡ˆ</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/21/é€šè¿‡ngrokæ­å»ºgithubçš„webhook/automr.png" alt="MRæµç¨‹å›¾" title class>
                <p>MRæµç¨‹å›¾</p>
            </figure>
<h2 id="é‡åˆ°é—®é¢˜"><a href="#é‡åˆ°é—®é¢˜" class="headerlink" title="é‡åˆ°é—®é¢˜"></a>é‡åˆ°é—®é¢˜</h2><p>1.Could not fetch URL <a href="https://pypi.python.org/simple/requests/" target="_blank" rel="noopener">https://pypi.python.org/simple/requests/</a>: There was a problem confirming the ssl certificate: [SSL: CERTIFICATE_VERIFY_FAILED] certificate verify failed (_ssl.c:777) - skipping<br>  Could not find a version that satisfies the requirement requests (from versions: )<br>No matching distribution found for requests</p>
<p>è§£å†³æ–¹æ³•ï¼špip3 install requests  -i  <a href="http://pypi.douban.com/simple" target="_blank" rel="noopener">http://pypi.douban.com/simple</a> â€“trusted-host=pypi.douban.com</p>
<p>2.å‡çº§pip</p>
<p>è§£å†³æ–¹æ³•ï¼šå°è¯•ä½¿ç”¨å¦‚ä¸‹æŒ‡ä»¤</p>
<p>pip install -U pip</p>
<p>sudo easy_install â€“upgrade pip</p>
<p>3.405 Method Not Allowed</p>
<p>è·¯ç”±åä¸å¯¹ä¸Payload URLä¸­è®¾ç½®çš„åä¸ä¸€æ ·ï¼Œæˆ–è€…methodä¸¢å¤±ã€‚</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.jianshu.com/p/55209f1031e8" target="_blank" rel="noopener">webhookå°è¯•æ°´(æ— éœ€å¤–ç½‘æœåŠ¡å™¨)</a></p>
<p><a href="https://forge.autodesk.com/blog/how-fix-ngrok-reconnecting-x509-certificate-signed-unknown-authority" target="_blank" rel="noopener">x509 certificate signed by unknown authority</a></p>
<p><a href="https://github.com/inconshreveable/ngrok" target="_blank" rel="noopener">ngrok git</a></p>
<p><a href="https://ngrok.com/download" target="_blank" rel="noopener">ngrokå®˜ç½‘</a></p>
<p><a href="https://docs.github.com/en/free-pro-team@latest/developers" target="_blank" rel="noopener">webhooks developers</a></p>
<p><a href="https://www.cnblogs.com/handsome1013/p/7390849.html" target="_blank" rel="noopener">åå‘ä»£ç†</a></p>
<p><a href="https://www.jianshu.com/p/b11d70d9dd52" target="_blank" rel="noopener">æ˜ å°„å…¬ç½‘èŠ±ç”Ÿå£³ã€PubYunã€NoIPã€DynDNSã€Ngrokã€Tunnelã€localtunnelã€pagekite</a></p>
]]></content>
      
        <categories>
            
            <category> WebHook </category>
            
            <category> ngrok </category>
            
        </categories>
        
        
        <tags>
            
            <tag> ngrok </tag>
            
            <tag> WebHook </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Charlesè®¾ç½®]]></title>
      <url>/2019/08/16/charles%E4%BF%AE%E6%94%B9%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0/</url>
      <content type="html"><![CDATA[<h2 id="ä¿®æ”¹è¯·æ±‚å‚æ•°"><a href="#ä¿®æ”¹è¯·æ±‚å‚æ•°" class="headerlink" title="ä¿®æ”¹è¯·æ±‚å‚æ•°"></a>ä¿®æ”¹è¯·æ±‚å‚æ•°</h2><p>å…ˆç‚¹å‡»é€‰å®šè‡ªå·±æƒ³è¦ä¿®æ”¹çš„è¯¥æ¡è¯·æ±‚ï¼Œç„¶åå³å‡»è¯¥æ¡è¯·æ±‚é€‰æ‹©Composeï¼Œåˆ™ä¼šå‡ºç°ä»¥ä¸‹ç•Œé¢ï¼Œä¾¿å¯ä»¥å¼€å§‹ä¿®æ”¹è¯¥è¯·æ±‚äº†.</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/16/charlesä¿®æ”¹è¯·æ±‚å‚æ•°/charles.png" alt="charles" title class>
                <p>charles</p>
            </figure>
<h2 id="å¼±ç½‘è®¾ç½®"><a href="#å¼±ç½‘è®¾ç½®" class="headerlink" title="å¼±ç½‘è®¾ç½®"></a>å¼±ç½‘è®¾ç½®</h2><p>æˆ‘ä»¬åœ¨æµ‹è¯•è¿‡ç¨‹ä¸­ï¼Œéœ€è¦æµ‹è¯•ä¸€äº›ç½‘ç»œä¸å¥½æ—¶å€™çš„å¼‚å¸¸åœºæ™¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è®¾ç½®Charlesï¼Œæ¨¡æ‹Ÿ2Gã€3Gçš„ç½‘ç»œæƒ…å†µï¼Œè®¾ç½®ä¸€äº›ä¸Šä¸‹è¡Œé€Ÿç‡ï¼Œè®¾ç½®ä¸€äº›ä¸¢åŒ…ç‡ã€‚è¿™äº›è®¾ç½®æœ‰è¡Œä¸šæ ‡å‡†ï¼Œå¯ä»¥å‚è€ƒè¡Œä¸šæ ‡å‡†ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/16/charlesä¿®æ”¹è¯·æ±‚å‚æ•°/throttle_set.png" alt="throttle_set" title class>
                <p>throttle_set</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/16/charlesä¿®æ”¹è¯·æ±‚å‚æ•°/throttle_input.png" alt="throttle_input" title class>
                <p>throttle_input</p>
            </figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/weixin_40669017/article/details/81975000" target="_blank" rel="noopener">CharlesæŠ“åŒ…ã€ä¿®æ”¹è¯·æ±‚ã€ä¿®æ”¹è¿”å›ã€å¼±ç½‘è®¾ç½®</a></p>
]]></content>
      
        <categories>
            
            <category> Charles </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Charles </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Fragmentå’ŒActivityç”Ÿå‘½å‘¨æœŸ]]></title>
      <url>/2019/08/08/Fragment%E5%92%8CActivity%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F/</url>
      <content type="html"><![CDATA[<h2 id="Fragmentç”Ÿå‘½å‘¨æœŸ"><a href="#Fragmentç”Ÿå‘½å‘¨æœŸ" class="headerlink" title="Fragmentç”Ÿå‘½å‘¨æœŸ"></a>Fragmentç”Ÿå‘½å‘¨æœŸ</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/08/Fragmentå’ŒActivityç”Ÿå‘½å‘¨æœŸ/fragment.png" alt="fragment" title class>
                <p>fragment</p>
            </figure>
<h2 id="Fragmentä¸Activityç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒ"><a href="#Fragmentä¸Activityç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒ" class="headerlink" title="Fragmentä¸Activityç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒ"></a>Fragmentä¸Activityç”Ÿå‘½å‘¨æœŸæ¯”è¾ƒ</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2019/08/08/Fragmentå’ŒActivityç”Ÿå‘½å‘¨æœŸ/activity.png" alt="activity" title class>
                <p>activity</p>
            </figure>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://blog.csdn.net/asdf717/article/details/51383750" target="_blank" rel="noopener">Android Fragment ç”Ÿå‘½å‘¨æœŸonCreatViewã€onViewCreated</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[aarä¾èµ–å¼•ç”¨å…³ç³»]]></title>
      <url>/2019/07/23/aar%E4%BE%9D%E8%B5%96%E5%BC%95%E7%94%A8%E5%85%B3%E7%B3%BB/</url>
      <content type="html"><![CDATA[<h2 id="ä¾èµ–å…³ç³»æŸ¥çœ‹"><a href="#ä¾èµ–å…³ç³»æŸ¥çœ‹" class="headerlink" title="ä¾èµ–å…³ç³»æŸ¥çœ‹"></a>ä¾èµ–å…³ç³»æŸ¥çœ‹</h2><h3 id="Gradle-View"><a href="#Gradle-View" class="headerlink" title="Gradle View"></a>Gradle View</h3><p>åœ¨ASä¸­å®‰è£…Gradle Viewæ’ä»¶ï¼Œå®‰è£…å®Œé‡å¯ã€‚</p>
<p>åœ¨ASé¢æ¿ä¸­-&gt;View-&gt;Tool Windows-&gt;Gradle ViewæŸ¥çœ‹ã€‚</p>
<h3 id="å‘½ä»¤"><a href="#å‘½ä»¤" class="headerlink" title="å‘½ä»¤"></a>å‘½ä»¤</h3><h4 id="æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–"><a href="#æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–" class="headerlink" title="æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–"></a>æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–</h4><p>./gradlew -q :app:dependencies</p>
<h4 id="æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–-1"><a href="#æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–-1" class="headerlink" title="æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–"></a>æŸ¥çœ‹appæ¨¡å—æ‰€æœ‰ä¾èµ–ï¼ŒåŒ…å«ä¾èµ–çš„ä¾èµ–</h4><p> ./gradlew : app:dependencies â€“configuration implementation</p>
<h4 id="æŸ¥çœ‹æŒ‡å®šé¡¹ç›®appæ¨¡å—çš„ä¾èµ–ï¼Œå¹¶è¾“å‡ºåˆ°æ–‡ä»¶"><a href="#æŸ¥çœ‹æŒ‡å®šé¡¹ç›®appæ¨¡å—çš„ä¾èµ–ï¼Œå¹¶è¾“å‡ºåˆ°æ–‡ä»¶" class="headerlink" title="æŸ¥çœ‹æŒ‡å®šé¡¹ç›®appæ¨¡å—çš„ä¾èµ–ï¼Œå¹¶è¾“å‡ºåˆ°æ–‡ä»¶"></a>æŸ¥çœ‹æŒ‡å®šé¡¹ç›®appæ¨¡å—çš„ä¾èµ–ï¼Œå¹¶è¾“å‡ºåˆ°æ–‡ä»¶</h4><p> ./gradlew -q :app:dependencies &gt; tree.txt</p>
<h2 id="å¤šç‰ˆæœ¬ä¾èµ–"><a href="#å¤šç‰ˆæœ¬ä¾èµ–" class="headerlink" title="å¤šç‰ˆæœ¬ä¾èµ–"></a>å¤šç‰ˆæœ¬ä¾èµ–</h2><blockquote>
<p>ä¾èµ–åº“æœ‰ç‰ˆæœ¬å†²çªæ—¶ï¼Œé»˜è®¤ä½¿ç”¨é«˜ç‰ˆæœ¬ä¸­çš„ä¾èµ–ï¼ˆæ³¨æ„ï¼šæ˜¯å¼•ç”¨åº“çš„é«˜ç‰ˆæœ¬ä¸­çš„ä¾èµ–ï¼‰ï¼Œå¦‚æœé¡¹ç›®ä¸­æŒ‡å®šç‰ˆæœ¬é«˜äºä¾èµ–ä¸­ï¼Œä¼˜å…ˆç”¨é¡¹ç›®ä¸­æŒ‡å®šçš„ç‰ˆæœ¬<br>å¦‚æœæƒ³æŒ‡å®šä½¿ç”¨å¼•å…¥åº“ä¸­ç‰ˆæœ¬ï¼Œä½¿ç”¨forceå‚æ•°</p>
<blockquote>
<p>æ€»ç»“ï¼š</p>
<p>1.a = å¼•ç”¨åº“ä¾èµ–ï¼ˆé«˜ï¼‰&gt;å¼•ç”¨åº“ä¾èµ–ï¼ˆä½ï¼‰;</p>
<p>2.force = true ä½¿ç”¨æŒ‡å®š;</p>
<p>3.å¼•ç”¨&gt; a ä½¿ç”¨å¼•ç”¨ï¼Œå¦åˆ™ä½¿ç”¨a</p>
</blockquote>
</blockquote>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/23/aarä¾èµ–å¼•ç”¨å…³ç³»/aar.jpg" alt="aar" title class>
                <p>aar</p>
            </figure>
<h2 id="å‚è€ƒ"><a href="#å‚è€ƒ" class="headerlink" title="å‚è€ƒ"></a>å‚è€ƒ</h2><p><a href="https://blog.csdn.net/weixin_33714884/article/details/90770965" target="_blank" rel="noopener">aarä¾èµ–å…³ç³»è§£æ</a></p>
<p><a href="https://www.jianshu.com/p/3b29f6890eac" target="_blank" rel="noopener">Android StudioæŸ¥çœ‹ç¬¬ä¸‰æ–¹åº“ä¾èµ–æ ‘</a></p>
<p><a href="https://blog.csdn.net/jifenglie/article/details/81390517" target="_blank" rel="noopener">GradleæŸ¥çœ‹ç¬¬ä¸‰æ–¹ä¾èµ–å…³ç³»å›¾</a></p>
]]></content>
      
        <categories>
            
            <category> Gradle </category>
            
        </categories>
        
        
        <tags>
            
            <tag> aar </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Flutter é…ç½®]]></title>
      <url>/2019/07/12/Flutter-%E9%85%8D%E7%BD%AE/</url>
      <content type="html"><![CDATA[<h2 id="ä¸‹è½½SDK"><a href="#ä¸‹è½½SDK" class="headerlink" title="ä¸‹è½½SDK"></a>ä¸‹è½½SDK</h2><p><a href="https://flutter.dev/docs/development/tools/sdk/releases?tab=macos#macos" target="_blank" rel="noopener">SDKä¸‹è½½åœ°å€</a><br>å¯¹åº”ä¸‹è½½åˆé€‚çš„å¹³å°å³å¯ï¼Œå¯èƒ½ç”±äºç½‘é€Ÿç­‰åŸå› ï¼Œä¸‹è½½è¯¦ç»†æœªæ˜¾ç¤ºï¼Œæ‰€ä»¥æˆ‘ç”¨çš„æ˜¯ç›´æ¥git cloneã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git clone -b master https://github.com/flutter/flutter.git</span><br></pre></td></tr></table></figure>

<h2 id="é…ç½®ç¯å¢ƒå˜é‡"><a href="#é…ç½®ç¯å¢ƒå˜é‡" class="headerlink" title="é…ç½®ç¯å¢ƒå˜é‡"></a>é…ç½®ç¯å¢ƒå˜é‡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ open .bash_profile</span><br></pre></td></tr></table></figure>

<p>åœ¨.bash_profileä¸­æ·»åŠ flutterçš„path</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">#flutter</span><br><span class="line">export PATH=/Users/xxxxxxx/flutter/bin:$PATH</span><br></pre></td></tr></table></figure>

<p>æ›´æ–°ç¯å¢ƒé…ç½®</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ source .bash_profile</span><br><span class="line">$ echo $PATH</span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œflutter doctoræˆ–flutter â€“versionå‘½ä»¤æ¥æŸ¥çœ‹æ˜¯å¦è¿˜éœ€è¦å®‰è£…å…¶å®ƒä¾èµ–ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">Downloading Dart SDK from Flutter engine d1dcd1848633c5764e23313823445cbcba451a59...</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">  0     0    0     0    0     0      0      0 --:--:--  0:00:39 --:--:--     0</span><br><span class="line">curl: (56) SSLRead() return error -9806</span><br><span class="line"></span><br><span class="line">Failed to retrieve the Dart SDK from: https://storage.googleapis.com/flutter_infra/flutter/d1dcd1848633c5764e23313823445cbcba451a59/dart-sdk-darwin-x64.zip</span><br><span class="line">If you&apos;re located in China, please see this page:</span><br><span class="line">  https://flutter.dev/community/china</span><br></pre></td></tr></table></figure>

<p><strong>è§£å†³æ–¹å¼</strong>:ç”±äºåœ¨å›½å†…è®¿é—®Flutteræœ‰æ—¶å¯èƒ½ä¼šå—åˆ°é™åˆ¶ï¼ŒFlutterå®˜æ–¹ä¸ºä¸­å›½å¼€å‘è€…æ­å»ºäº†ä¸´æ—¶é•œåƒï¼Œå¤§å®¶å¯ä»¥å°†å¦‚ä¸‹ç¯å¢ƒå˜é‡åŠ å…¥åˆ°ç”¨æˆ·ç¯å¢ƒå˜é‡ä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">export PUB_HOSTED_URL=https://pub.flutter-io.cn</span><br><span class="line">export FLUTTER_STORAGE_BASE_URL=https://storage.flutter-io.cn</span><br></pre></td></tr></table></figure>

<p>æ­£å¸¸ä¸‹è½½å¦‚ä¸‹ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line">chenyulong01deMacBook-Pro:flutter chenyulong01$ flutter doctor</span><br><span class="line">Downloading Dart SDK from Flutter engine d1dcd1848633c5764e23313823445cbcba451a59...</span><br><span class="line">  % Total    % Received % Xferd  Average Speed   Time    Time     Time  Current</span><br><span class="line">                                 Dload  Upload   Total   Spent    Left  Speed</span><br><span class="line">100  120M  100  120M    0     0   655k      0  0:03:07  0:03:07 --:--:--  656k</span><br><span class="line">Building flutter tool...</span><br><span class="line"></span><br><span class="line">  â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—</span><br><span class="line">  â•‘                 Welcome to Flutter! - https://flutter.dev                  â•‘</span><br><span class="line">  â•‘                                                                            â•‘</span><br><span class="line">  â•‘ The Flutter tool anonymously reports feature usage statistics and crash    â•‘</span><br><span class="line">  â•‘ reports to Google in order to help Google contribute improvements to       â•‘</span><br><span class="line">  â•‘ Flutter over time.                                                         â•‘</span><br><span class="line">  â•‘                                                                            â•‘</span><br><span class="line">  â•‘ Read about data we send with crash reports:                                â•‘</span><br><span class="line">  â•‘ https://github.com/flutter/flutter/wiki/Flutter-CLI-crash-reporting        â•‘</span><br><span class="line">  â•‘                                                                            â•‘</span><br><span class="line">  â•‘ See Google&apos;s privacy policy:                                               â•‘</span><br><span class="line">  â•‘ https://www.google.com/intl/en/policies/privacy/                           â•‘</span><br><span class="line">  â•‘                                                                            â•‘</span><br><span class="line">  â•‘ Use &quot;flutter config --no-analytics&quot; to disable analytics and crash         â•‘</span><br><span class="line">  â•‘ reporting.                                                                 â•‘</span><br><span class="line">  â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">Flutter assets will be downloaded from https://storage.flutter-io.cn. Make sure</span><br><span class="line">you trust this source!</span><br><span class="line">Downloading Material fonts...                                       2.8s</span><br><span class="line">Downloading android-arm-profile/darwin-x64 tools...                 4.5s</span><br><span class="line">Downloading android-arm-release/darwin-x64 tools...                 3.6s</span><br><span class="line">Downloading android-arm64-profile/darwin-x64 tools...               4.6s</span><br><span class="line">Downloading android-arm64-release/darwin-x64 tools...               3.8s</span><br><span class="line">Downloading android-x86 tools...                                   24.8s</span><br><span class="line">Downloading android-x64 tools...                                   25.9s</span><br><span class="line">Downloading android-arm tools...                                   11.6s</span><br><span class="line">Download failed -- attempting retry 1 in 1 second...                    </span><br><span class="line">Downloading android-arm-profile tools...                            9.1s</span><br><span class="line">Downloading android-arm-release tools...                            6.0s</span><br><span class="line">Downloading android-arm64 tools...                                 12.3s</span><br><span class="line">Downloading android-arm64-profile tools...                          7.8s</span><br><span class="line">Downloading android-arm64-release tools...                          6.1s</span><br><span class="line">Downloading Gradle Wrapper...                                       0.2s</span><br><span class="line">Downloading package sky_engine...                                   1.4s</span><br><span class="line">Downloading common tools...                                        15.0s</span><br><span class="line">Downloading common tools...                                        15.1s</span><br><span class="line">Downloading darwin-x64 tools...                                    49.2s</span><br><span class="line">Doctor summary (to see all details, run flutter doctor -v):</span><br><span class="line">[âœ“] Flutter (Channel master, v1.8.2-pre.56, on Mac OS X 10.12.6 16G29, locale</span><br><span class="line">    zh-Hans-CN)</span><br><span class="line"> </span><br><span class="line">[âœ“] Android toolchain - develop for Android devices (Android SDK version 28.0.3)</span><br><span class="line">[âœ—] Xcode - develop for iOS and macOS</span><br><span class="line">    âœ— Xcode installation is incomplete; a full installation is necessary for iOS</span><br><span class="line">      development.</span><br><span class="line">      Download at: https://developer.apple.com/xcode/download/</span><br><span class="line">      Or install Xcode via the App Store.</span><br><span class="line">      Once installed, run:</span><br><span class="line">        sudo xcode-select --switch /Applications/Xcode.app/Contents/Developer</span><br><span class="line">    âœ— CocoaPods not installed.</span><br><span class="line">        CocoaPods is used to retrieve the iOS and macOS platform side&apos;s plugin</span><br><span class="line">        code that responds to your plugin usage on the Dart side.</span><br><span class="line">        Without CocoaPods, plugins will not work on iOS or macOS.</span><br><span class="line">        For more info, see https://flutter.dev/platform-plugins</span><br><span class="line">      To install:</span><br><span class="line">        brew install cocoapods</span><br><span class="line">        pod setup</span><br><span class="line">[âœ—] iOS tools - develop for iOS devices</span><br><span class="line">    âœ— libimobiledevice and ideviceinstaller are not installed. To install with</span><br><span class="line">      Brew, run:</span><br><span class="line">        brew update</span><br><span class="line">        brew install --HEAD usbmuxd</span><br><span class="line">        brew link usbmuxd</span><br><span class="line">        brew install --HEAD libimobiledevice</span><br><span class="line">        brew install ideviceinstaller</span><br><span class="line">    âœ— ios-deploy not installed. To install:</span><br><span class="line">        brew install ios-deploy</span><br><span class="line">[âœ“] Chrome - develop for the web</span><br><span class="line">[!] Android Studio (version 3.3)</span><br><span class="line">    âœ— Flutter plugin not installed; this adds Flutter specific functionality.</span><br><span class="line">    âœ— Dart plugin not installed; this adds Dart specific functionality.</span><br><span class="line">[âœ“] Connected device (3 available)</span><br><span class="line"></span><br><span class="line">! Doctor found issues in 3 categories.</span><br><span class="line">chenyulong01deMacBook-Pro:flutter chenyulong01$</span><br></pre></td></tr></table></figure>

<h2 id="æ›´æ–°flutteråŠå…¶ä¾èµ–"><a href="#æ›´æ–°flutteråŠå…¶ä¾èµ–" class="headerlink" title="æ›´æ–°flutteråŠå…¶ä¾èµ–"></a>æ›´æ–°flutteråŠå…¶ä¾èµ–</h2><h3 id="æ›´æ–°Flutter"><a href="#æ›´æ–°Flutter" class="headerlink" title="æ›´æ–°Flutter"></a>æ›´æ–°Flutter</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/12/Flutter-é…ç½®/fu.jpg" alt title class>
                <p></p>
            </figure>

<h3 id="æ›´æ–°DartåŠå…¶ä»–ä¾èµ–"><a href="#æ›´æ–°DartåŠå…¶ä»–ä¾èµ–" class="headerlink" title="æ›´æ–°DartåŠå…¶ä»–ä¾èµ–"></a>æ›´æ–°DartåŠå…¶ä»–ä¾èµ–</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/12/Flutter-é…ç½®/fdu.jpg" alt title class>
                <p></p>
            </figure>

<h2 id="AS-Flutteræ’ä»¶å®‰è£…é…ç½®"><a href="#AS-Flutteræ’ä»¶å®‰è£…é…ç½®" class="headerlink" title="AS Flutteræ’ä»¶å®‰è£…é…ç½®"></a>AS Flutteræ’ä»¶å®‰è£…é…ç½®</h2><h3 id="å®‰è£…"><a href="#å®‰è£…" class="headerlink" title="å®‰è£…"></a>å®‰è£…</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/12/Flutter-é…ç½®/af.jpg" alt title class>
                <p></p>
            </figure>
<h3 id="é…ç½®SDK"><a href="#é…ç½®SDK" class="headerlink" title="é…ç½®SDK"></a>é…ç½®SDK</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/12/Flutter-é…ç½®/afd.jpg" alt title class>
                <p></p>
            </figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://book.flutterchina.club/" target="_blank" rel="noopener">Flutterä¸­æ–‡ç½‘</a><br><a href="https://flutter.dev/docs/get-started/codelab" target="_blank" rel="noopener">Flutterå®˜æ–¹äº‹ä¾‹</a></p>
]]></content>
      
        <categories>
            
            <category> Flutter </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Flutter </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Android API Levelå¯¹åº”Androidç‰ˆæœ¬ä¸€è§ˆè¡¨]]></title>
      <url>/2019/07/05/Android-API-Level%E5%AF%B9%E5%BA%94Android%E7%89%88%E6%9C%AC%E4%B8%80%E8%A7%88%E8%A1%A8/</url>
      <content type="html"><![CDATA[<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/05/Android-API-Levelå¯¹åº”Androidç‰ˆæœ¬ä¸€è§ˆè¡¨/api1.jpg" alt="api-1" title class>
                <p>api-1</p>
            </figure>
<a id="more"></a>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/05/Android-API-Levelå¯¹åº”Androidç‰ˆæœ¬ä¸€è§ˆè¡¨/api2.jpg" alt="api-2" title class>
                <p>api-2</p>
            </figure>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[è…¾è®¯åŠ å›ºè„±å£³ä½¿ç”¨äº‹ä¾‹]]></title>
      <url>/2019/07/03/tencentfdex/</url>
      <content type="html"><![CDATA[<h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æœ¬æ–‡åªä»‹ç»å…·ä½“çš„åŸç†å’Œå®ç°ï¼Œä¸æ¶‰åŠXposedç›¸å…³æŠ€æœ¯ç‚¹ã€‚æƒ³è¦äº†è§£Xposedå…·ä½“é…ç½®å’Œå®ç°çš„è¯·å‚è€ƒ<a href="http://nunu03.github.io/2019/07/02/xposed/">Xposedçš„é…ç½®ä¸ç®€å•ä½¿ç”¨</a></p>
<a id="more"></a>

<h3 id="ç›´æ¥åç¼–è¯‘apk"><a href="#ç›´æ¥åç¼–è¯‘apk" class="headerlink" title="ç›´æ¥åç¼–è¯‘apk"></a>ç›´æ¥åç¼–è¯‘apk</h3><figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/03/tencentfdex/apkjadx.jpg" alt="apk-jadx" title class>
                <p>apk-jadx</p>
            </figure>


<h2 id="è„±å£³å·¥å…·FDex2"><a href="#è„±å£³å·¥å…·FDex2" class="headerlink" title="è„±å£³å·¥å…·FDex2"></a>è„±å£³å·¥å…·FDex2</h2><figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/03/tencentfdex/fdex2.jpeg" alt="fdex2" title class>
                <p>fdex2</p>
            </figure>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/03/tencentfdex/dexpath.jpeg" alt="dexpath" title class>
                <p>dexpath</p>
            </figure>
<h3 id="è„±å£³æµç¨‹"><a href="#è„±å£³æµç¨‹" class="headerlink" title="è„±å£³æµç¨‹"></a>è„±å£³æµç¨‹</h3><h4 id="ç¬¬ä¸€æ­¥ã€æ¿€æ´»"><a href="#ç¬¬ä¸€æ­¥ã€æ¿€æ´»" class="headerlink" title="ç¬¬ä¸€æ­¥ã€æ¿€æ´»"></a>ç¬¬ä¸€æ­¥ã€æ¿€æ´»</h4><p>FDex2å’Œéœ€è¦è„±å£³çš„åº”ç”¨éƒ½å®‰è£…åˆ°æ‰‹æœºä¸Šã€‚åœ¨Xposed installæ¨¡å—ä¸­å‹¾é€‰FDex2ï¼Œé‡å¯æ‰‹æœºã€‚</p>
<h4 id="ç¬¬äºŒæ­¥ã€é€‰æ‹©è½¯ä»¶"><a href="#ç¬¬äºŒæ­¥ã€é€‰æ‹©è½¯ä»¶" class="headerlink" title="ç¬¬äºŒæ­¥ã€é€‰æ‹©è½¯ä»¶"></a>ç¬¬äºŒæ­¥ã€é€‰æ‹©è½¯ä»¶</h4><p>ç„¶åæ‰“å¼€FDex2åº”ç”¨ï¼Œåœ¨åº”ç”¨åˆ—è¡¨ä¸­é€‰æ‹©éœ€è¦è„±å£³çš„åº”ç”¨ï¼Œä¿å­˜dexå³å¯ã€‚</p>
<h4 id="ç¬¬ä¸‰æ­¥ã€è¿è¡Œè½¯ä»¶"><a href="#ç¬¬ä¸‰æ­¥ã€è¿è¡Œè½¯ä»¶" class="headerlink" title="ç¬¬ä¸‰æ­¥ã€è¿è¡Œè½¯ä»¶"></a>ç¬¬ä¸‰æ­¥ã€è¿è¡Œè½¯ä»¶</h4><p>è¿è¡Œè¦è„±å£³çš„è½¯ä»¶ï¼Œä¸æ‰“å¼€è¿è¡Œè½¯ä»¶æ˜¯æ— æ³•è„±å‡ºå£³çš„</p>
<h4 id="ç¬¬å››æ­¥ã€dexç›®å½•"><a href="#ç¬¬å››æ­¥ã€dexç›®å½•" class="headerlink" title="ç¬¬å››æ­¥ã€dexç›®å½•"></a>ç¬¬å››æ­¥ã€dexç›®å½•</h4><p>æ‰¾åˆ°dexç›®å½•ï¼Œè¿™é‡Œçš„dexå°±æ˜¯è„±å£³åçš„dexæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æˆ‘å³å°†hookçš„dexæ–‡ä»¶ã€‚ç›®å½•ä¸€èˆ¬æ˜¯/data/user/0/com.luhu.package.xxxã€‚</p>
<h2 id="hookè¿‡ç¨‹"><a href="#hookè¿‡ç¨‹" class="headerlink" title="hookè¿‡ç¨‹"></a>hookè¿‡ç¨‹</h2><p>ç”±äºè¢«è…¾è®¯åŠ å›ºï¼Œæ‰€ä»¥ç¬¬ä¸€æ­¥æ˜¯éœ€è¦è·å–å¯¹åº”ClassLoaderï¼›åœ¨ä¹‹åçš„é€†å‘è¿‡ç¨‹ä¸­ä½¿ç”¨çš„ClassLoaderéƒ½æ˜¯è¿™ä¸ªClassLoaderã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">if(lpparam.packageName.startsWith(&quot;com.luhu.livexiuwu&quot;))&#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">                        //è…¾è®¯åŠ å›ºï¼Œéœ€è¦è·å–å¯¹åº”classloader</span><br><span class="line">                        XposedHelpers.findAndHookMethod(&quot;com.tencent.StubShell.TxAppEntry&quot;, lpparam.classLoader,</span><br><span class="line">                                &quot;attachBaseContext&quot;, Context.class, new XC_MethodHook() &#123;</span><br><span class="line">                                    @Override</span><br><span class="line">                                    protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                                        super.afterHookedMethod(param);</span><br><span class="line">                                        //è·å–åˆ°Contextå¯¹è±¡ï¼Œé€šè¿‡è¿™ä¸ªå¯¹è±¡æ¥è·å–classloader</span><br><span class="line">                                        Context context = (Context) param.args[0];</span><br><span class="line">                                        //è·å–classloaderï¼Œä¹‹åhookåŠ å›ºåçš„å°±ä½¿ç”¨è¿™ä¸ªclassloader</span><br><span class="line">                                        SecApp.hookLuhu(lpparam,context.getClassLoader());                                </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                                    &#125;</span><br><span class="line"></span><br><span class="line">                                &#125;);</span><br><span class="line">                    &#125;catch (Exception e)&#123;</span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">            &#125;</span><br></pre></td></tr></table></figure>

<h2 id="è„±å£³åŸç†"><a href="#è„±å£³åŸç†" class="headerlink" title="è„±å£³åŸç†"></a>è„±å£³åŸç†</h2><p>é€šè¿‡Hook ClassLoaderçš„loadClassæ–¹æ³•ï¼Œåå°„è°ƒç”¨getDexæ–¹æ³•å–å¾—Dex(com.android.dex.Dexç±»å¯¹è±¡)ï¼Œåœ¨å°†é‡Œé¢çš„dexå†™å‡ºã€‚<br>è„±å£³è·å–dexçš„å…³é”®ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br></pre></td><td class="code"><pre><span class="line">private static  void fDex(XC_LoadPackage.LoadPackageParam loadPackageParam2)&#123;</span><br><span class="line"></span><br><span class="line">        if(loadPackageParam2.packageName.equals(&quot;com.luhu.livexiuwu&quot;))&#123;</span><br><span class="line"></span><br><span class="line">            try &#123;</span><br><span class="line">                Class Dex=Class.forName(&quot;com.android.dex.Dex&quot;);</span><br><span class="line">                Method Dex_getBytes=Dex.getDeclaredMethod(&quot;getBytes&quot;, new Class[0]);</span><br><span class="line">                Method getDex = Class.forName(&quot;java.lang.Class&quot;).getDeclaredMethod(&quot;getDex&quot;, new Class[0]);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                XposedHelpers.findAndHookMethod(&quot;java.lang.ClassLoader&quot;, loadPackageParam2.classLoader, &quot;loadClass&quot;, String.class,boolean.class,new XC_MethodHook()&#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line"></span><br><span class="line">                        Class cls = (Class) param.getResult();</span><br><span class="line">                     </span><br><span class="line"></span><br><span class="line">                        if (cls != null) &#123;</span><br><span class="line"></span><br><span class="line">                                try &#123;</span><br><span class="line">                                    byte[] bArr = (byte[]) Dex_getBytes.invoke(getDex.invoke(cls, new Object[0]), new Object[0]);</span><br><span class="line">                                   </span><br><span class="line"></span><br><span class="line">                                    if (bArr != null) &#123;</span><br><span class="line"></span><br><span class="line">                                        File apkFileDir = new File(CompatUtil.getSdcardSharedDir(), &quot;lulu&quot;);</span><br><span class="line"></span><br><span class="line">                                        if (!apkFileDir.exists()) &#123;</span><br><span class="line">                                            apkFileDir.mkdirs();</span><br><span class="line">                                        &#125;</span><br><span class="line"></span><br><span class="line">                                        String name = &quot;com.luhu.livexiuwu&quot;+bArr.length+&quot;.dex&quot;;</span><br><span class="line">                                        File file2 = new File(apkFileDir, name);</span><br><span class="line">                                       </span><br><span class="line">                                        if (!file2.exists()) &#123;</span><br><span class="line">                                            FileUtil.writeToFileBy(bArr, file2);</span><br><span class="line">                                        &#125;</span><br><span class="line">                                    &#125;</span><br><span class="line">                                &#125; catch (Exception e3) &#123;</span><br><span class="line">                                    </span><br><span class="line">                                &#125;</span><br><span class="line"></span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125; catch (Throwable e) &#123;</span><br><span class="line">                XposedBridge.log(e);</span><br><span class="line"></span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://mp.weixin.qq.com/s/C44M4XNIlZ43iwI7dl95jw" target="_blank" rel="noopener">java and android æ¶æ„</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Xposed </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Xposedçš„é…ç½®ä¸ç®€å•ä½¿ç”¨]]></title>
      <url>/2019/07/02/xposed/</url>
      <content type="html"><![CDATA[<h2 id="Xposedæ˜¯ä»€ä¹ˆ"><a href="#Xposedæ˜¯ä»€ä¹ˆ" class="headerlink" title="Xposedæ˜¯ä»€ä¹ˆ"></a>Xposedæ˜¯ä»€ä¹ˆ</h2><p>å®˜æ–¹å¯¹æ­¤çš„è§£é‡Šæ˜¯è¿™æ ·çš„ï¼š<br>â€œXposedæ˜¯ä¸€ä¸ªé€‚ç”¨äºAndroidçš„æ¡†æ¶ã€‚åŸºäºè¿™ä¸ªæ¡†æ¶å¼€å‘çš„æ¨¡å—å¯ä»¥æ”¹å˜ç³»ç»Ÿå’Œappåº”ç”¨çš„è¡Œä¸ºï¼Œè€Œä¸éœ€è¦ä¿®æ”¹APKã€‚è¿™æ˜¯ä¸€ä¸ªå¾ˆæ£’çš„ç‰¹æ€§ï¼Œæ„å‘³ç€Xposedæ¨¡å—å¯ä»¥ä¸ç»è¿‡ä»»ä½•ä¿®æ”¹ï¼Œå®‰è£…åœ¨å„ç§ä¸åŒçš„ROMä¸Šã€‚Xposedæ¨¡å—å¯ä»¥å¾ˆå®¹æ˜“çš„å¼€å¯å’Œå…³é—­ã€‚ä½ åªéœ€è¦æ¿€æ´»æˆ–è€…ç¦ç”¨Xposedæ¨¡å—ï¼Œç„¶åé‡å¯æ‰‹æœºå³å¯ã€‚â€</p>
<a id="more"></a>
<h2 id="Hookæ˜¯ä»€ä¹ˆ"><a href="#Hookæ˜¯ä»€ä¹ˆ" class="headerlink" title="Hookæ˜¯ä»€ä¹ˆ"></a>Hookæ˜¯ä»€ä¹ˆ</h2><p>Hook è‹±æ–‡å°±æ˜¯ã€ŒæŒ‚é’©ã€çš„æ„æ€.é‚£æˆ‘ä»¬å¦‚ä½•ä½¿ç”¨è¿™ä¸ªã€ŒæŒ‚é’©ã€å‘¢ï¼Ÿåœ¨æˆ‘ä»¬çš„åº”ç”¨ç¨‹åºç§ï¼ŒåŒ…æ‹¬åº”ç”¨è§¦å‘äº‹ä»¶å’Œåå°é€»è¾‘å¤„ç†ï¼Œéƒ½æ˜¯æ˜¯æ ¹æ®äº‹ä»¶æµç¨‹ä¸€æ­¥æ­¥åœ°å‘ä¸‹æ‰§è¡Œã€‚è€Œã€ŒæŒ‚é’©ã€çš„æ„æ€ï¼Œå°±æ˜¯åœ¨äº‹ä»¶ä¼ é€åˆ°ç»ˆç‚¹å‰æˆªè·å¹¶ç›‘æ§äº‹ä»¶çš„ä¼ è¾“ï¼Œåƒä¸ªé’©å­é’©ä¸Šäº‹ä»¶ä¸€æ ·ï¼Œå¹¶ä¸”èƒ½å¤Ÿåœ¨é’©ä¸Šäº‹ä»¶æ—¶ï¼Œå¤„ç†ä¸€äº›è‡ªå·±ç‰¹å®šçš„äº‹ä»¶ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/02/xposed/hook.png" alt="hook" title class>
                <p>hook</p>
            </figure>
<p>å¦‚ä½•ç†è§£ï¼Œä¾‹å¦‚æˆ‘ä»¬æœ‰ä¸€ä¸ªæ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">private int getResult(int i, int i2) &#123;</span><br><span class="line">    return i+i2; </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æ­£å¸¸æƒ…å†µä¸‹ï¼Œi=1ï¼Œi2=1ï¼Œæˆ‘ä»¬èƒ½å¾—åˆ°2ï¼Œä½†æ˜¯æ ¹æ®ä¸Šå›¾ï¼Œç°åœ¨æˆ‘ä»¬çŸ¥é“åˆ©ç”¨Hookç°åœ¨èƒ½åšäº›ä»€ä¹ˆäº†ï¼Œé€šè¿‡Hookæˆ‘ä»¬å¯ä»¥å¯¹å‚æ•°iï¼Œi2è¿›è¡Œä¿®æ”¹ï¼Œi=1ï¼Œi2=2ï¼Œæœ€ç»ˆæˆ‘ä»¬å¾—åˆ°çš„ç»“æœæ˜¯3.è¿™å°±æ˜¯æŒ‚é’©çš„ä½œç”¨ã€‚</p>
<p>å…³äºAndroidä¸­çš„Hookæœºåˆ¶ï¼Œå¤§è‡´æœ‰ä¸¤ä¸ªæ–¹å¼ï¼š</p>
<p>è¦ root æƒé™ï¼Œç›´æ¥Hookç³»ç»Ÿï¼Œå¯ä»¥å¹²æ‰æ‰€æœ‰çš„Appã€‚</p>
<p>å…rootæƒé™ï¼Œä½†æ˜¯åªèƒ½ Hook è‡ªèº«ï¼Œå¯¹ç³»ç»Ÿå…¶å®ƒ App æ— èƒ½ä¸ºåŠ›ã€‚</p>
<h2 id="Xposedæ¥å…¥"><a href="#Xposedæ¥å…¥" class="headerlink" title="Xposedæ¥å…¥"></a>Xposedæ¥å…¥</h2><h3 id="åˆ›å»ºå·¥ç¨‹"><a href="#åˆ›å»ºå·¥ç¨‹" class="headerlink" title="åˆ›å»ºå·¥ç¨‹"></a>åˆ›å»ºå·¥ç¨‹</h3><p>è¿™ä¸ªå·¥ç¨‹å°±æ˜¯æˆ‘ä»¬çš„æ’ä»¶å·¥ç¨‹ï¼Œä¹Ÿæ˜¯æˆ‘ä»¬éœ€è¦æ¿€æ´»çš„Xposedæ¨¡å—å·¥ç¨‹ã€‚åœ¨æˆ‘ä»¬çš„ç¾¤æ§é¡¹ç›®ä¸­ï¼Œæˆ‘ä»¬çš„hotBå°±æ˜¯æˆ‘ä»¬çš„æ¨¡å—å·¥ç¨‹ã€‚ä»€ä¹ˆæ˜¯æ¨¡å—å·¥ç¨‹ï¼Œå¯ä»¥ç†è§£æˆ‘ä»¬ä½¿ç”¨HookæŒ‚é’©è‡ªå®šä¹‰æ¶ˆæ¯ä½“çš„å·¥ç¨‹ã€‚è¿™ä¸ªappå®‰è£…åå¯ä»¥åœ¨Xposed appçš„æ¨¡å—ä¸­æ‰¾åˆ°ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/02/xposed/mokuai.png" alt="set" title class>
                <p>set</p>
            </figure>
<h3 id="å¯¼å…¥api"><a href="#å¯¼å…¥api" class="headerlink" title="å¯¼å…¥api"></a>å¯¼å…¥api</h3><p>å€’å…¥apiæ¯”è¾ƒç®€å•ï¼šç›´æ¥åœ¨build.gradleä¸­æ·»åŠ ä¾èµ–å³å¯ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/* Xposed */</span><br><span class="line">    provided &apos;de.robv.android.xposed:api:82&apos;</span><br><span class="line">    provided &apos;de.robv.android.xposed:api:82:sources&apos;</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨æ„ï¼šè¿™é‡Œæ˜¯providedï¼Œå› ä¸ºXposedé‡Œå·²æœ‰è¯¥jaråŒ…å†…å®¹ï¼Œå†æ¬¡æ‰“åŒ…è¿›å»ä¼šå†²çªï¼Œå¹¶å¯¼è‡´handleLoadPackageæ²¡æœ‰å›è°ƒ</strong></p>
<h3 id="ä¿®æ”¹AndroidManifest-xmlæ–‡ä»¶"><a href="#ä¿®æ”¹AndroidManifest-xmlæ–‡ä»¶" class="headerlink" title="ä¿®æ”¹AndroidManifest.xmlæ–‡ä»¶"></a>ä¿®æ”¹AndroidManifest.xmlæ–‡ä»¶</h3><p>åœ¨æ ‡ç­¾é‡Œé¢åŠ ä¸‰ä¸ªmeta-data</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;!-- ä½œä¸ºxposedæ¨¡å— --&gt;</span><br><span class="line">&lt;meta-data android:name=&quot;xposedmodule&quot; android:value=&quot;true&quot; /&gt;</span><br><span class="line">&lt;!-- Xposedçš„æ¨¡å—æè¿° æ˜¾ç¤ºåœ¨xposedæ¨¡å—åˆ—è¡¨é‚£é‡Œç¬¬äºŒè¡Œ--&gt;</span><br><span class="line">&lt;meta-data android:name=&quot;xposeddescription&quot; android:value=&quot;HotAX&quot; /&gt;</span><br><span class="line">&lt;!-- XposedBridgeApiçš„æœ€ä½ç‰ˆæœ¬å· --&gt;</span><br><span class="line">&lt;meta-data android:name=&quot;xposedminversion&quot; android:value=&quot;53&quot; /&gt;</span><br></pre></td></tr></table></figure>

<h3 id="ç¼–å†™hookç±»"><a href="#ç¼–å†™hookç±»" class="headerlink" title="ç¼–å†™hookç±»"></a>ç¼–å†™hookç±»</h3><p>åˆ›å»ºä¸€ä¸ªç±»ï¼Œå®ç°IXposedHookLoadPackageæ¥å£ï¼Œé‡å†™handleLoadPackageæ–¹æ³•ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">public class XposedModule implements IXposedHookLoadPackage &#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void handleLoadPackage(final XC_LoadPackage.LoadPackageParam loadPackageParam) throws Throwable &#123;</span><br><span class="line">        if (!loadPackageParam.packageName.startsWith(&quot;com.hotax.autowechat&quot;)) &#123;</span><br><span class="line">            if (loadPackageParam.packageName.startsWith(&quot;com.tencent.mm&quot;)) &#123;</span><br><span class="line">                XposedHelpers.findAndHookMethod(Application.class, &quot;attach&quot;, Context.class, new XC_MethodHook() &#123;</span><br><span class="line">                    @Override</span><br><span class="line">                    protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line"></span><br><span class="line">                    &#125;</span><br><span class="line"></span><br><span class="line">                    @Override</span><br><span class="line">                    protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                        </span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="åˆ›å»ºxposed-initæ–‡ä»¶"><a href="#åˆ›å»ºxposed-initæ–‡ä»¶" class="headerlink" title="åˆ›å»ºxposed_initæ–‡ä»¶"></a>åˆ›å»ºxposed_initæ–‡ä»¶</h3><p>åœ¨main/assetsç›®å½•ä¸‹åˆ›å»ºxposed_initæ–‡ä»¶ï¼Œä¸è¦åç¼€åã€‚è¿™ä¸ªå°±æ˜¯æ¨¡å—çš„å…¥å£ï¼Œåªæœ‰ä¸€è¡Œä»£ç ï¼Œå°±æ˜¯è¯´æ˜å…¥å£ç±»,è¿™ä¸ªç±»å°±æ˜¯æˆ‘ä»¬ä¸Šè¾¹çš„ç±»ï¼Œåœ¨è¿™é‡Œæˆ‘ä»¬èƒ½æ‰“å°å‡ºæ‰€æœ‰packageã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">com.hotax.autowechat.xposed.XposedModuleã€‚</span><br></pre></td></tr></table></figure>

<p>è‡³æ­¤ï¼ŒXposedæ¨¡å—å¼€å‘çš„æ¥å…¥å°±å…¨éƒ¨å®Œæˆäº†ã€‚</p>
<h2 id="Hookå®ç°"><a href="#Hookå®ç°" class="headerlink" title="Hookå®ç°"></a>Hookå®ç°</h2><h3 id="hookå˜é‡"><a href="#hookå˜é‡" class="headerlink" title="hookå˜é‡"></a>hookå˜é‡</h3><p>hookå‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">private static  int staticPrivateInt = 100;</span><br><span class="line">public static  int staticPublicInt = 100;</span><br><span class="line">private static  String staticPrivateString = &quot;staticPrivateString&quot;;</span><br><span class="line">private static  String staticPublicString = &quot;staticPublicString&quot;;</span><br><span class="line"></span><br><span class="line">public  int publicInt = 200;</span><br><span class="line">private int privateInt = 300;</span><br><span class="line">private String privateString = &quot;privateString&quot;;</span><br><span class="line">private String publicString = &quot;publicString&quot;;</span><br></pre></td></tr></table></figure>

<p>hook</p>
<p>è·å–Classï¼š</p>
<p>final Class&lt;?&gt; clazz = XposedHelpers.findClass(â€œå…¨è·¯å¾„ç±»åâ€, loadPackageParam.classLoader);</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">XposedHelpers.setStaticIntField(clazz, &quot;staticPrivateInt&quot;, 99);</span><br><span class="line">XposedHelpers.setStaticIntField(clazz, &quot;staticPublicInt&quot;, 99);</span><br><span class="line">XposedHelpers.setStaticObjectField(clazz, &quot;staticPrivateString&quot;, &quot;hook_staticPrivateString&quot;);</span><br><span class="line">XposedHelpers.setStaticObjectField(clazz, &quot;staticPublicString&quot;, &quot;hook_staticPublicString&quot;);</span><br><span class="line"></span><br><span class="line">XposedHelpers.setStaticIntField(clazz, &quot;publicInt&quot;, 99);</span><br></pre></td></tr></table></figure>

<p>hookåç»“æœæ‰“å°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">D/HookDemo: staticPrivateInt = 99</span><br><span class="line">D/HookDemo: staticPublicInt = 99</span><br><span class="line">D/HookDemo: staticPrivateString = hook_staticPrivateString</span><br><span class="line">D/HookDemo: staticPublicString = hook_staticPublicString</span><br><span class="line">D/HookDemo: publicInt = 200</span><br><span class="line">D/HookDemo: privateInt = 300</span><br><span class="line">D/HookDemo: privateString = privateString</span><br><span class="line">D/HookDemo: publicString = publicString</span><br></pre></td></tr></table></figure>

<p><strong>ç»“è®ºï¼šXposedHelpers.setStaticObjectFieldæ–¹æ³•åªèƒ½ä¿®æ”¹é™æ€å˜é‡ï¼Œéé™æ€å˜é‡ä¸èƒ½ä½¿ç”¨æ­¤æ–¹å¼ä¿®æ”¹ã€‚å¦åˆ™ä¼šæŠ¥java.lang.NullPointerException:å¼‚å¸¸ï¼›</strong>é‚£éé™æ€å˜é‡å¦‚ä½•ä¿®æ”¹å‘¢ï¼šä¾‹å¦‚æˆ‘ä»¬ç›®æ ‡ç¨‹åºé‡Œæœ‰ä¸¤ä¸ªæ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">public void publicMethod(String value)&#123;    </span><br><span class="line">   Log.d(Tag, &quot;å‚æ•°æ‰“å°-publicMethodï¼š&quot; + value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">private void privateMethod(String value)&#123;</span><br><span class="line">   Log.d(Tag, &quot;å‚æ•°æ‰“å°-privateMethodï¼š&quot; + value);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>hookéé™æ€å˜é‡</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">XposedHelpers.findAndHookMethod(clazz, &quot;publicFunc&quot;, String.class, new XC_MethodHook() &#123;</span><br><span class="line">               @Override</span><br><span class="line">               protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                   param.args[0] = &quot;before--------------publicMethod&quot;;</span><br><span class="line">                   XposedHelpers.setIntField(param.thisObject, &quot;publicInt&quot;, 199);</span><br><span class="line">                   XposedHelpers.setIntField(param.thisObject, &quot;privateInt&quot;, 199);</span><br><span class="line">                   XposedHelpers.setObjectField(param.thisObject, &quot;privateString&quot;, &quot;hook_privateString&quot;);</span><br><span class="line">                   XposedHelpers.setObjectField(param.thisObject, &quot;publicString&quot;, &quot;hook_publicString&quot;);</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">                   XposedHelpers.setIntField(param.thisObject, &quot;staticPrivateInt&quot;, 199);</span><br><span class="line">                   XposedHelpers.setIntField(param.thisObject, &quot;staticPublicInt&quot;, 199);</span><br><span class="line">                   XposedHelpers.setObjectField(param.thisObject, &quot;staticPrivateString&quot;, &quot;hook_-setObjectField-staticPrivateString&quot;);</span><br><span class="line">                   XposedHelpers.setObjectField(param.thisObject, &quot;staticPublicString&quot;, &quot;hook_-setObjectField-staticPublicString&quot;);</span><br><span class="line"></span><br><span class="line">               &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<p>hookåç»“æœæ‰“å°</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">å‚æ•°æ‰“å°-publicMethodï¼šbefore--------------publicMethod</span><br><span class="line">D/HookDemo: staticPrivateInt = 199</span><br><span class="line">D/HookDemo: staticPublicInt = 199</span><br><span class="line">D/HookDemo: staticPrivateString = hook_-setObjectField-staticPrivateString</span><br><span class="line">D/HookDemo: staticPublicString = hook_-setObjectField-staticPublicString</span><br><span class="line">D/HookDemo: publicInt = 199</span><br><span class="line">D/HookDemo: privateInt = 199</span><br><span class="line">D/HookDemo: privateString = hook_privateString</span><br><span class="line">D/HookDemo: publicString = hook_publicString</span><br></pre></td></tr></table></figure>

<p><strong>ç»“è®ºï¼šéé™æ€å˜é‡çš„ä¿®æ”¹åªèƒ½é€šè¿‡åå°„æŸç±»ä¸­çš„æŸä¸ªæ–¹æ³•ï¼ˆæ–¹æ³•ç±»å‹ä¸é™ï¼‰ä¸­ä¿®æ”¹ï¼Œä¸”é™æ€å˜é‡ä¹Ÿå¯ä»¥è¿™ä¹ˆä¿®æ”¹ã€‚</strong></p>
<h3 id="hookæ–¹æ³•"><a href="#hookæ–¹æ³•" class="headerlink" title="hookæ–¹æ³•"></a>hookæ–¹æ³•</h3><h5 id="hookæ„é€ æ–¹æ³•"><a href="#hookæ„é€ æ–¹æ³•" class="headerlink" title="hookæ„é€ æ–¹æ³•"></a>hookæ„é€ æ–¹æ³•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">public HookDemo(String value)&#123;</span><br><span class="line">    Log.d(Tag, &quot;å‚æ•°æ‰“å°-å¸¦å‚æ„é€ æ–¹æ³•ï¼š&quot; + value);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">//Hookæœ‰å‚æ„é€ å‡½æ•°ï¼Œä¿®æ”¹å‚æ•°</span><br><span class="line"> XposedHelpers.findAndHookConstructor(clazz, String.class,  new XC_MethodHook() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    param.args[0] = &quot;å‚æ•°æ‰“å°-å¸¦å‚æ„é€ æ–¹æ³•ï¼šæˆ‘æ˜¯ä¿®æ”¹åçš„å‚æ•°&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">                @Override</span><br><span class="line">                protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    XposedBridge.log(&quot;HOOK-Afterï¼š&quot; +param.args[0]);</span><br><span class="line">                &#125;</span><br><span class="line">  &#125;);</span><br><span class="line">  </span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">D/HookDemo: å‚æ•°æ‰“å°-å¸¦å‚æ„é€ æ–¹æ³•ï¼šæˆ‘æ˜¯ä¿®æ”¹åçš„å‚æ•°</span><br><span class="line">D/HookDemo: HOOK-Afterï¼šå‚æ•°æ‰“å°-å¸¦å‚æ„é€ æ–¹æ³•ï¼šæˆ‘æ˜¯ä¿®æ”¹åçš„å‚æ•°</span><br></pre></td></tr></table></figure>

<h5 id="hookå¸¦è¿”å›å€¼çš„æ–¹æ³•"><a href="#hookå¸¦è¿”å›å€¼çš„æ–¹æ³•" class="headerlink" title="hookå¸¦è¿”å›å€¼çš„æ–¹æ³•"></a>hookå¸¦è¿”å›å€¼çš„æ–¹æ³•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line">public String getHook(String value)&#123;</span><br><span class="line">   return value;</span><br><span class="line">&#125;</span><br><span class="line"> </span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">1ã€</span><br><span class="line">XposedHelpers.findAndHookMethod(clazz, &quot;getHook&quot;, String.class, new XC_MethodHook() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    param.args[0] = &quot;è¿”å›å€¼ï¼šbefore--------------gethook&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">&#125;);</span><br><span class="line"> </span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">D/HookDemo: getHook è¿”å›å€¼ = è¿”å›å€¼ï¼šbefore--------------gethook</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">2ã€</span><br><span class="line">   XposedHelpers.findAndHookMethod(clazz, &quot;getHook&quot;, String.class, new XC_MethodHook() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">//                    param.args[0] = &quot;è¿”å›å€¼ï¼šbefore--------------gethook&quot;;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    param.setResult(&quot;è¿”å›å€¼ï¼šafter--------------gethook&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line"> æ‰§è¡Œç»“æœï¼š</span><br><span class="line">D/HookDemo: getHook è¿”å›å€¼ = è¿”å›å€¼ï¼šafter--------------gethook</span><br></pre></td></tr></table></figure>

<h5 id="hooké™æ€æ–¹æ³•"><a href="#hooké™æ€æ–¹æ³•" class="headerlink" title="hooké™æ€æ–¹æ³•"></a>hooké™æ€æ–¹æ³•</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line">private static String staticPrivateMethod(String value)&#123;</span><br><span class="line">    Log.d(&quot;HookDemo&quot;, &quot;é™æ€å‡½æ•°--&quot; + value);</span><br><span class="line">    return &quot;é™æ€å‡½æ•°--è¿”å›ï¼š&quot;+value;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"></span><br><span class="line">1ã€</span><br><span class="line">XposedHelpers.findAndHookMethod(clazz, &quot;staticPrivateMethod&quot;, String.class, new XC_MethodHook() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    param.args[0] = &quot;before---&quot;;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">    </span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">D/HookDemo: é™æ€å‡½æ•°--before---</span><br><span class="line">D/HookDemo: é™æ€å‡½æ•°--è¿”å›ï¼šbefore---</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">2ã€</span><br><span class="line">XposedHelpers.findAndHookMethod(clazz, &quot;staticPrivateMethod&quot;, String.class, new XC_MethodHook() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    param.args[0] = &quot;before---&quot;;</span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">                @Override</span><br><span class="line">                protected void afterHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                    param.setResult(&quot;é™æ€å‡½æ•°--è¿”å›ï¼šafter---&quot;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">D/HookDemo: é™æ€å‡½æ•°--before---</span><br><span class="line">D/HookDemo: é™æ€å‡½æ•°--è¿”å›ï¼šafter---</span><br><span class="line"></span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">3ã€</span><br><span class="line">Object object = XposedHelpers.callStaticMethod(clazz, &quot;staticPrivateMethod&quot;, &quot;callStaticMethod é™æ€å‡½æ•°è°ƒç”¨&quot;);</span><br><span class="line">Log.d(&quot;HookDemo&quot;, &quot;xposed-:staticPrivateFunc:&quot;+object);</span><br><span class="line"></span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">D/HookDemo: é™æ€å‡½æ•°--callStaticMethod é™æ€å‡½æ•°è°ƒç”¨</span><br><span class="line">D/HookDemo: xposed-:staticPrivateFunc:é™æ€å‡½æ•°--è¿”å›ï¼šcallStaticMethod é™æ€å‡½æ•°è°ƒç”¨</span><br></pre></td></tr></table></figure>

<p><strong>ç»“è®ºï¼šé™æ€æ–¹æ³•çš„ä¿®æ”¹å’Œå…¶ä»–æ–¹æ³•hookæ–¹å¼ä¸€æ ·ï¼Œä½†æ˜¯é™æ€æ–¹æ³•å¯ä»¥ç›´æ¥é€šè¿‡callStaticMethodè¿›è¡Œå‚æ•°çš„ä¿®æ”¹ã€‚</strong></p>
<h5 id="Hookå¤æ‚çš„å‚æ•°"><a href="#Hookå¤æ‚çš„å‚æ•°" class="headerlink" title="Hookå¤æ‚çš„å‚æ•°"></a>Hookå¤æ‚çš„å‚æ•°</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">public void paramsClass(ClasName cn, String value,Intent intent,int key,Map map,List list)&#123;  </span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">Class cnClazz  = loadPackageParam.classLoader.loadClass(&quot;com.xxxx. ClasName&quot;);</span><br><span class="line">Class cnMap = XposedHelpers.findClass(&quot;java.util.Map&quot;, loadPackageParam.classLoader);</span><br><span class="line">Class cnArrayList = XposedHelpers.findClass(&quot;java.util.ArrayList&quot;, loadPackageParam.classLoader);</span><br><span class="line"></span><br><span class="line">XposedHelpers.findAndHookMethod(clazz, &quot;paramsClass&quot;, cnClazz, String.class, Intent.class,int.class,Map.class,ArrayList.class new XC_MethodHook() &#123;</span><br><span class="line">    @Override</span><br><span class="line">    protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;);</span><br></pre></td></tr></table></figure>

<h5 id="Hookå†…éƒ¨ç±»ä¸­çš„å‡½æ•°"><a href="#Hookå†…éƒ¨ç±»ä¸­çš„å‡½æ•°" class="headerlink" title="Hookå†…éƒ¨ç±»ä¸­çš„å‡½æ•°"></a>Hookå†…éƒ¨ç±»ä¸­çš„å‡½æ•°</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">public class HookDemo &#123;</span><br><span class="line">    private String Tag = &quot;HookDemo&quot;;</span><br><span class="line">    class InnerClass&#123;</span><br><span class="line">        public int innerPublicInt = 10;</span><br><span class="line">        private int innerPrivateInt = 20;</span><br><span class="line">        public InnerClass()&#123;</span><br><span class="line">        &#125;</span><br><span class="line">        public void InnerFunc(String value)&#123;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">final Class&lt;?&gt; clazz1 = XposedHelpers.findClass(&quot;com.xxxxxx.HookDemo$InnerClass&quot;, loadPackageParam.classLoader);</span><br><span class="line">XposedHelpers.findAndHookMethod(clazz1, &quot;InnerMethod&quot;, String.class, new XC_MethodHook() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br></pre></td></tr></table></figure>

<p><strong>æ³¨ï¼šhookå†…éƒ¨ç±»ä¸­çš„å‡½æ•°å’Œå˜é‡ï¼Œè·Ÿä»¥ä¸Šçš„hookæ–¹å¼æ²¡æœ‰åŒºåˆ«ï¼Œå”¯ä¸€çš„åŒºåˆ«æ˜¯ï¼ŒXposedHelpers.findClassä¸­çš„è·¯å¾„åä¸åŒã€‚</strong></p>
<h5 id="HookåŒ¿åå†…éƒ¨ç±»ä¸­çš„å‡½æ•°"><a href="#HookåŒ¿åå†…éƒ¨ç±»ä¸­çš„å‡½æ•°" class="headerlink" title="HookåŒ¿åå†…éƒ¨ç±»ä¸­çš„å‡½æ•°"></a>HookåŒ¿åå†…éƒ¨ç±»ä¸­çš„å‡½æ•°</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">anonymousInner(new ClasName() &#123;</span><br><span class="line">            @Override</span><br><span class="line">            public void clasNameMethod(String value) &#123;</span><br><span class="line">        		Log.d(Tag, &quot;åŒ¿åç±»å‚æ•°ä¿®æ”¹ï¼šgetï¼š&quot; + value);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;);</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">XposedHelpers.findAndHookMethod(&quot;com.xxxxxx.HookDemo$1&quot;, clazz.getClassLoader(),</span><br><span class="line">                    &quot;clasNameMethod&quot;,String.class, new XC_MethodHook() &#123;</span><br><span class="line">                        @Override</span><br><span class="line">                        protected void beforeHookedMethod(MethodHookParam param) throws Throwable &#123;</span><br><span class="line">                             param.args[0] = &quot;åŒ¿åç±»-å‚æ•°ä¿®æ”¹&quot;;                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line">æ‰§è¡Œç»“æœï¼š</span><br><span class="line">D/HookDemo: åŒ¿åç±»å‚æ•°ä¿®æ”¹ï¼šgetï¼šåŒ¿åç±»-å‚æ•°ä¿®æ”¹</span><br></pre></td></tr></table></figure>

<h5 id="Hookæ›¿æ¢å‡½æ•°"><a href="#Hookæ›¿æ¢å‡½æ•°" class="headerlink" title="Hookæ›¿æ¢å‡½æ•°"></a>Hookæ›¿æ¢å‡½æ•°</h5><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">private void repleaceMethod()&#123;</span><br><span class="line">    getHook(&quot;sfdsfs-afsafsf&quot;);</span><br><span class="line">&#125;</span><br><span class="line">-------------------------------------------------------------------</span><br><span class="line"> XposedHelpers.findAndHookMethod(clazz, &quot;repleaceMethod&quot;, new XC_MethodReplacement() &#123;</span><br><span class="line">                @Override</span><br><span class="line">                protected Object replaceHookedMethod(MethodHookParam methodHookParam) throws Throwable &#123;</span><br><span class="line">                    try &#123;</span><br><span class="line">	            			// ç›´æ¥æ›¿æ¢åŸæ¥è¦æ‰§è¡Œçš„é€»è¾‘ä»£ç ,ç›®æ ‡æ–¹æ³•å°±ä¸åœ¨æ‰§è¡Œäº†</span><br><span class="line">			        &#125; catch (Throwable t) &#123;</span><br><span class="line">			            XposedBridge.log(t);</span><br><span class="line">			        &#125;                    </span><br><span class="line">		       </span><br><span class="line">                &#125;</span><br><span class="line">            &#125;);</span><br></pre></td></tr></table></figure>

<h3 id="æ›¿æ¢èµ„æº"><a href="#æ›¿æ¢èµ„æº" class="headerlink" title="æ›¿æ¢èµ„æº"></a>æ›¿æ¢èµ„æº</h3><h4 id="IXposedHookZygoteInit"><a href="#IXposedHookZygoteInit" class="headerlink" title="IXposedHookZygoteInit"></a>IXposedHookZygoteInit</h4><p>Hook the initialization of Zygote process(es), from which all the apps are forked.</p>
<p>Implement this interface in your moduleâ€™s main class in order to be notified when Android is starting up. In IXposedHookZygoteInit, you can modify objects and place hooks that should be applied for every app. Only the Android framework/system classes are available at that point in time. Use null as class loader for XposedHelpers.findAndHookMethod(String, ClassLoader, String, Objectâ€¦) and its variants.</p>
<p>If you want to hook one/multiple specific apps, use IXposedHookLoadPackage instead.</p>
<p>æ›¿æ¢ç³»ç»Ÿæ¡†æ¶èµ„æºï¼ˆå¯¹æ‰€æœ‰app èµ·ä½œç”¨ï¼‰éœ€è¦å®ç° IXposedHookZygoteInitæ¥å£çš„ initZygote æ–¹æ³•ï¼Œå¹¶åœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨Resources.setSystemWideReplacement(â€¦) æ–¹æ³•æ›¿æ¢èµ„æºï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">public class Tutorial2  implements IXposedHookZygoteInit&#123;</span><br><span class="line"></span><br><span class="line">    @Override</span><br><span class="line">    public void initZygote(StartupParam arg0) throws Throwable &#123;</span><br><span class="line">        XResources.setSystemWideReplacement(&quot;android&quot;, &quot;bool&quot;, &quot;config_unplugTurnsOnScreen&quot;, false);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="IXposedHookInitPackageResources"><a href="#IXposedHookInitPackageResources" class="headerlink" title="IXposedHookInitPackageResources"></a>IXposedHookInitPackageResources</h4><p>æ›¿æ¢appåº”ç”¨èµ„æºéœ€è¦å®ç° IXposedHookInitPackageResources ç±»çš„<br>andleInitPackageResourcesæ–¹æ³•ï¼Œå¹¶åœ¨è¯¥æ–¹æ³•ä¸­è°ƒç”¨res.setReplacement(â€¦)æ–¹æ³•æ›¿æ¢èµ„æºï¼Œæ³¨æ„åœ¨è¯¥æ–¹æ³•ä¸­ä¸è¦ä½¿ç”¨XResources.setSystemWideReplacement æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line"> public void handleInitPackageResources(XC_InitPackageResources.InitPackageResourcesParam resparam) throws Throwable &#123;</span><br><span class="line"></span><br><span class="line">     if (resparam.packageName.equals(&quot;com.example.xposedhooktarget&quot;)) &#123;</span><br><span class="line">         //getClassInfo(clazz);</span><br><span class="line">         resparam.res.setReplacement(&quot;com.xxxxxx.xposedhooktarget&quot;, &quot;string&quot;, &quot;action_test&quot;, &quot;HkTargetTest&quot;);</span><br><span class="line">         resparam.res.setReplacement(&quot;com.example.xposedhooktarget&quot;, &quot;color&quot;, &quot;colorAccent&quot;, R.color.colorPrimary);</span><br><span class="line">resparam.res.setReplacement(&quot;2131165219&quot;, &quot;HkTargetTest-action_text&quot;);</span><br><span class="line">         resparam.res.setReplacement(&quot;com.xxxxxxx.xposedhooktarget&quot;, &quot;mipmap&quot;, &quot;test_icon&quot;, new XResources.DrawableLoader() &#123;</span><br><span class="line">             @Override</span><br><span class="line">             public Drawable newDrawable(XResources res, int id) throws Throwable &#123;</span><br><span class="line">                 Drawable dg = res.getDrawable(R.mipmap.ic_launcher);</span><br><span class="line">                 return dg;</span><br><span class="line">             &#125;</span><br><span class="line">         &#125;);</span><br><span class="line"></span><br><span class="line">     &#125;</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>

<p>è¿˜å¯ä»¥æ›¿æ¢åŠ¨ç”»æ–‡ä»¶ç­‰ç­‰ã€‚</p>
<h3 id="ä¿®æ”¹å¸ƒå±€"><a href="#ä¿®æ”¹å¸ƒå±€" class="headerlink" title="ä¿®æ”¹å¸ƒå±€"></a>ä¿®æ”¹å¸ƒå±€</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">resparam.res.hookLayout(&quot;com.xxxxxx.xposedhooktarget&quot;, &quot;layout&quot;, &quot;activity_main&quot;, new XC_LayoutInflated() &#123;</span><br><span class="line">               @Override</span><br><span class="line">               public void handleLayoutInflated(LayoutInflatedParam liparam) throws Throwable &#123;</span><br><span class="line">                   //å¢åŠ ä¸€ä¸ªTextView</span><br><span class="line">                   FrameLayout contentview = (FrameLayout) liparam.view;</span><br><span class="line">                   if (contentview != null) &#123;</span><br><span class="line">                       TextView textView = new TextView(contentview.getContext());</span><br><span class="line">                       textView.setText(&quot;ä¿®æ”¹å¸ƒå±€&quot;);</span><br><span class="line">                       contentview.addView(textView);</span><br><span class="line">                   &#125;</span><br><span class="line">                   //ä¿®æ”¹@+id= bt_text1 çš„TextViewçš„æ–‡æ¡ˆ</span><br><span class="line">                   TextView bt_text1 = (TextView) liparam.view.findViewById(</span><br><span class="line">                           liparam.res.getIdentifier(&quot;bt_text1&quot;, &quot;id&quot;, &quot;com.xxxxxx.xposedhooktarget&quot;));</span><br><span class="line">                   bt_text1.setText(&quot;ä¿®æ”¹å¸ƒå±€æ–‡æœ¬&quot;);</span><br><span class="line">               &#125;</span><br><span class="line">           &#125;);</span><br></pre></td></tr></table></figure>

<h2 id="ç¾¤æ§"><a href="#ç¾¤æ§" class="headerlink" title="ç¾¤æ§"></a>ç¾¤æ§</h2><p>éœ€æ±‚ï¼šè¢«åŠ¨æ·»åŠ å¥½å‹ã€‚</p>
<p>è¦æ±‚ï¼šé‡‡ç”¨é™é»˜çš„æ— æ„ŸçŸ¥æ¨¡å¼ã€‚</p>
<p>å®ç°ï¼šæ€è·¯ï¼Œé‡‡ç”¨hookæ·»åŠ å¥½å‹åè®®çš„æ¨¡å¼ï¼Œå…¥å£åœ¨dbçš„hookåŸºç¡€ä¸Šè¿›è¡Œç›‘å¬éªŒè¯å¥½å‹çš„è¯·æ±‚ï¼Œå› ä¸ºä¸è®ºä»€ä¹ˆä¿¡æ¯ï¼Œéƒ½ä¼šé¦–å…ˆä¼šå­˜å‚¨ä¸å¾®ä¿¡çš„dbä¸­ã€‚</p>
<p>å‰æï¼šå·²ç»hookäº†ç•Œé¢çš„è·³è½¬ï¼Œå’Œæ‰“å¼€äº†å¾®ä¿¡çš„logä¿¡æ¯ã€‚<a href="http://wxc.58corp.com/pages/viewpage.action?pageId=25070673" target="_blank" rel="noopener">è¯¦ç»†ç‚¹å‡»</a>.</p>
<p>è¿‡ç¨‹ï¼šåœ¨å‰æä¸‹ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°äº†ä¸‰ä¸ªå…³äºè¢«åŠ¨æ·»åŠ å¥½å‹çš„ä¿¡æ¯ï¼š</p>
<p>1ã€å¥½å‹é€šè¿‡éªŒè¯çš„ç•Œé¢åç§°å’Œä¼ é€’çš„å‚æ•°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">E/hotWeixinHook: ActivityHook; activity=com.tencent.mm.plugin.profile.ui.SayHiWithSnsPermissionUI@a3b6b62, onCreate; getIntent()=Intent</span><br><span class="line">        &#123; cmp=com.tencent.mm/.plugin.profile.ui.SayHiWithSnsPermissionUI (has extras), extra=bundle&#123;</span><br><span class="line">            sayhi_with_sns_perm_send_verify=true,</span><br><span class="line">        room_name=null,</span><br><span class="line">        source_from_user_name=null,</span><br><span class="line">        sayhi_with_sns_perm_add_remark=true,</span><br><span class="line">        source_from_nick_name=null,</span><br><span class="line">        Contact_Nick=å¤§ç‹,</span><br><span class="line">        Contact_User=v1_841761d9ad2fee00bafee3e6c65ec45aef0c541d5c3bacfc2d24acd30fe184f31cd28a41808180cfff4ebd0325d4a1a1@stranger,</span><br><span class="line">        Contact_Scene=15,</span><br><span class="line">        Contact_RemarkName=,</span><br><span class="line">        =false,</span><br><span class="line">        AntispamTicket=v2_6e521f51ae39720c3154a79ba26c689efab115f39b314795f803a2889d76a013e05b3569cdd1f5328da35803ed134968@stranger</span><br><span class="line"></span><br><span class="line">        &#125; &#125;, bundle=bundle&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>2ã€éªŒè¯çš„è¯¦ç»†ä¿¡æ¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">MicroMsg.FMessageProvider; setDigest, </span><br><span class="line">fmsgType = 1, fmsgScene = 30, </span><br><span class="line">fmsgContent = </span><br><span class="line">&lt;msg </span><br><span class="line">fromusername=&quot;aibhyi1314521&quot; encryptusername=&quot;v1_4bb4022da882fa9b480543b3a0e48fcc76b5530d371c9defe34a653497843e38@stranger&quot; </span><br><span class="line">fromnickname=&quot;å¿˜è®°ä¸€åˆ‡&quot; </span><br><span class="line">content=&quot;æˆ‘æ˜¯å¿˜è®°ä¸€åˆ‡&quot; </span><br><span class="line">fullpy=&quot;wangjiyiqie&quot; </span><br><span class="line">shortpy=&quot;WJYQ&quot; </span><br><span class="line">imagestatus=&quot;3&quot; </span><br><span class="line">scene=&quot;30&quot; country=&quot;CN&quot; province=&quot;Hebei&quot; city=&quot;Baoding&quot; </span><br><span class="line">sign=&quot;å¸¦èµ°ä¸€ç›æ¸”ç«ï¼Œè®©ä»–æ¸©æš–æˆ‘çš„åŒçœ¼ã€‚ç•™ä¸‹ä¸€æ®µçœŸæƒ…è®©ä»–åœæ³Šåœ¨æ«æ¡¥è¾¹&quot; percard=&quot;1&quot; sex=&quot;1&quot; alias=&quot;wuluqi0606&quot; weibo=&quot;&quot; albumflag=&quot;0&quot; albumstyle=&quot;0&quot; albumbgimgid=&quot;&quot; snsflag=&quot;17&quot; </span><br><span class="line">snsbgimgid=&quot;http://shmmsns.qpic.cn/mmsns/CttmTaYSYkS6fvUyDJs0icQ6oRUqibtDIuUylCkHeRHfk4jF7nToTbSYAm5H0z84qh9fHACkovW1c/0&quot; </span><br><span class="line">snsbgobjectid=&quot;12854304281324228767&quot; mhash=&quot;3140af8c3cd25f8db0eaa8815cc2cd95&quot; mfullhash=&quot;3140af8c3cd25f8db0eaa8815cc2cd95&quot; </span><br><span class="line">bigheadimgurl=&quot;http://wx.qlogo.cn/mmhead/ver_1/qKwkYHXZa7iahrsJ2DV7NhuZnrWft9icLTiculKSTJiaJVQvpMPV1dyKH9HuqM3F9picnfZ6dd1ujxxCADH0tHburXhYQBsSP0ZQbD8USaqzXh7c/0&quot; smallheadimgurl=&quot;http://wx.qlogo.cn/mmhead/ver_1/qKwkYHXZa7iahrsJ2DV7NhuZnrWft9icLTiculKSTJiaJVQvpMPV1dyKH9HuqM3F9picnfZ6dd1ujxxCADH0tHburXhYQBsSP0ZQbD8USaqzXh7c/96&quot; ticket=&quot;v2_e57f9519b15cab7743fe81feced778340c7cb4a2c6cbbb361fdd606bbf815478db4e967568ece4fbf27519726dda64492f68992a4e750ef8e4e6e72724f075e8@stranger&quot; </span><br><span class="line">opcode=&quot;2&quot; googlecontact=&quot;&quot; qrticket=&quot;&quot; chatroomusername=&quot;&quot; sourceusername=&quot;&quot; sourcenickname=&quot;&quot;&gt;</span><br><span class="line">&lt;brandlist count=&quot;0&quot; ver=&quot;685330891&quot;&gt;&lt;/brandlist&gt;</span><br><span class="line">&lt;/msg&gt;, </span><br><span class="line">isSend = false</span><br></pre></td></tr></table></figure>

<p>3ã€å­˜å‚¨æ•°æ®åº“åç§°ã€‚</p>
<p>MicroMsg.SDK.MAutoStorage; <strong>fmessage_conversation</strong>:get with primary key</p>
<p>4ã€æ ¹æ®1å¾—åˆ°çš„ç•Œé¢ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹å¾®ä¿¡çš„é€†å‘ä»£ç ã€‚æˆ‘æ˜¯ç”¨çš„jadx-0.7.2ï¼Œä¸è¦ç”¨jadxä½ç‰ˆæœ¬ï¼Œå› ä¸ºä½ç‰ˆæœ¬çš„é€†å‘ç»“æœçš„ä»£ç ä¸­ï¼Œä¸å«æœ‰æˆ‘ä»¬éœ€è¦hookçš„å…·ä½“ç±»åå’Œæ–¹æ³•åã€‚å› ä¸ºå¾®ä¿¡çš„åŒ…æ¯”è¾ƒå¤§ï¼Œæˆ‘ä»¬æœ€å¥½æŠŠé€†å‘ä»£ç å¯¼å‡ºæ¥ï¼Œä½¿ç”¨çš„æ—¶å€™ç”¨ASæ‰“å¼€å³å¯ã€‚</p>
<p>5ã€<br>æˆ‘ä»¬çœ‹ä¸‹ç‚¹å‡»å‘é€æŒ‰é’®ç­‰æºä»£ç ï¼šï¼ˆæ¯”è¾ƒé•¿ï¼Œä½†æ˜¯ä¸è´´ä¸€ä¸‹ï¼Œæ²¡æ³•è¯´å•Šï¼‰</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br></pre></td><td class="code"><pre><span class="line">class C305316 implements OnMenuItemClickListener &#123;</span><br><span class="line">        C305316() &#123;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        public final boolean onMenuItemClick(MenuItem menuItem) &#123;</span><br><span class="line">            final C1138k c8233f;</span><br><span class="line">            SayHiWithSnsPermissionUI sayHiWithSnsPermissionUI;</span><br><span class="line">            Context context;</span><br><span class="line">            if (SayHiWithSnsPermissionUI.this.f97358pqM) &#123;</span><br><span class="line">                int i;</span><br><span class="line">                List linkedList = new LinkedList();</span><br><span class="line">                linkedList.add(SayHiWithSnsPermissionUI.this.userName);</span><br><span class="line">                List linkedList2 = new LinkedList();</span><br><span class="line">                linkedList2.add(Integer.valueOf(SayHiWithSnsPermissionUI.this.f97352pnn));</span><br><span class="line">                String g = SayHiWithSnsPermissionUI.m63520g(SayHiWithSnsPermissionUI.this);</span><br><span class="line">                Map hashMap = new HashMap();</span><br><span class="line">                if (SayHiWithSnsPermissionUI.this.f97357pqL.f28645zEk) &#123;</span><br><span class="line">                    i = 1;</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    i = 0;</span><br><span class="line">                &#125;</span><br><span class="line">                hashMap.put(SayHiWithSnsPermissionUI.this.userName, Integer.valueOf(i));</span><br><span class="line">                C6159x.m11666d(&quot;MicroMsg.SayHiWithSnsPermissionUI&quot;, &quot;select sns permission, %s&quot;, Integer.valueOf(i));</span><br><span class="line">                if (C10044x.m20844Xg(SayHiWithSnsPermissionUI.this.userName)) &#123;</span><br><span class="line">                    c8233f = new C8233f(SayHiWithSnsPermissionUI.this.userName, g, SayHiWithSnsPermissionUI.this.getIntent().getStringExtra(C32536a.f104548xML));</span><br><span class="line">                    C32688as.m69428CN().mo13442a(c8233f, 0);</span><br><span class="line">                    sayHiWithSnsPermissionUI = SayHiWithSnsPermissionUI.this;</span><br><span class="line">                    context = SayHiWithSnsPermissionUI.this.mController.f28409xRr;</span><br><span class="line">                    SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f8616dGZ);</span><br><span class="line">                    sayHiWithSnsPermissionUI.f97348inI = C36199h.m82220a(context, SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f10212eKs), true, new OnCancelListener() &#123;</span><br><span class="line">                        public final void onCancel(DialogInterface dialogInterface) &#123;</span><br><span class="line">                            C32688as.m69428CN().mo13446c(c8233f);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    final C1138k c31589o = new C31589o(2, linkedList, linkedList2, g, &quot;&quot;, hashMap, SayHiWithSnsPermissionUI.this.chatroomName);</span><br><span class="line">                    String stringExtra = SayHiWithSnsPermissionUI.this.getIntent().getStringExtra(&quot;source_from_user_name&quot;);</span><br><span class="line">                    String stringExtra2 = SayHiWithSnsPermissionUI.this.getIntent().getStringExtra(&quot;source_from_nick_name&quot;);</span><br><span class="line">                    if (!C6135bi.m11498oN(stringExtra)) &#123;</span><br><span class="line">                        c31589o.mo40569fj(stringExtra, stringExtra2);</span><br><span class="line">                    &#125;</span><br><span class="line">                    C32688as.m69428CN().mo13442a(c31589o, 0);</span><br><span class="line">                    SayHiWithSnsPermissionUI sayHiWithSnsPermissionUI2 = SayHiWithSnsPermissionUI.this;</span><br><span class="line">                    context = SayHiWithSnsPermissionUI.this.mController.f28409xRr;</span><br><span class="line">                    SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f8616dGZ);</span><br><span class="line">                    sayHiWithSnsPermissionUI2.f97348inI = C36199h.m82220a(context, SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f10212eKs), true, new OnCancelListener() &#123;</span><br><span class="line">                        public final void onCancel(DialogInterface dialogInterface) &#123;</span><br><span class="line">                            C32688as.m69428CN().mo13446c(c31589o);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125; else if (SayHiWithSnsPermissionUI.this.f97359pqN) &#123;</span><br><span class="line">                String stringExtra3 = SayHiWithSnsPermissionUI.this.getIntent().getStringExtra(&quot;Verify_ticket&quot;);</span><br><span class="line">                if (C10044x.m20844Xg(SayHiWithSnsPermissionUI.this.userName)) &#123;</span><br><span class="line">                    c8233f = new C8234g(SayHiWithSnsPermissionUI.this.userName, stringExtra3);</span><br><span class="line">                    C32688as.m69428CN().mo13442a(c8233f, 0);</span><br><span class="line">                    sayHiWithSnsPermissionUI = SayHiWithSnsPermissionUI.this;</span><br><span class="line">                    context = SayHiWithSnsPermissionUI.this.mController.f28409xRr;</span><br><span class="line">                    SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f8616dGZ);</span><br><span class="line">                    sayHiWithSnsPermissionUI.f97348inI = C36199h.m82220a(context, SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f9343dUY), true, new OnCancelListener() &#123;</span><br><span class="line">                        public final void onCancel(DialogInterface dialogInterface) &#123;</span><br><span class="line">                            C32688as.m69428CN().mo13446c(c8233f);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125; else &#123;</span><br><span class="line">                    c8233f = new C31589o(SayHiWithSnsPermissionUI.this.userName, stringExtra3, SayHiWithSnsPermissionUI.this.f97352pnn);</span><br><span class="line">                    C32688as.m69428CN().mo13442a(c8233f, 0);</span><br><span class="line">                    sayHiWithSnsPermissionUI = SayHiWithSnsPermissionUI.this;</span><br><span class="line">                    context = SayHiWithSnsPermissionUI.this.mController.f28409xRr;</span><br><span class="line">                    SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f8616dGZ);</span><br><span class="line">                    sayHiWithSnsPermissionUI.f97348inI = C36199h.m82220a(context, SayHiWithSnsPermissionUI.this.getString(C1085R.C1081l.f9343dUY), true, new OnCancelListener() &#123;</span><br><span class="line">                        public final void onCancel(DialogInterface dialogInterface) &#123;</span><br><span class="line">                            C32688as.m69428CN().mo13446c(c8233f);</span><br><span class="line">                        &#125;</span><br><span class="line">                    &#125;);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>ç»è¿‡ä¸€ç³»åˆ—åˆ¤æ–­ï¼Œæˆ‘ä»¬æœ€ç»ˆæœ€åå®šä½åˆ°é€šè¿‡åè®®çš„ä»£ç C32688as.m69428CN().mo13442a(c8233f, 0);ä¸ºå•¥å•Šï¼Œå› ä¸ºä¸ç®¡æ˜¯ifå’Œelse ifçš„çš„æ¡ä»¶æˆ‘ä»¬éƒ½èƒ½å¤Ÿæ‹¿åˆ°ï¼Œæ€ä¹ˆæ‹¿åˆ°ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡XposedHelpers.getObjectField(param.thisObject, â€œæ–¹æ³•å˜é‡â€);è·å¾—åˆ°f97359pqNå’Œf97358pqMçš„å€¼ï¼›ç„¶åæˆ‘ä»¬çœ‹C32688asè¿™ä¸ªç±»ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">/* renamed from: com.tencent.mm.y.as */</span><br><span class="line">public final class C32688as &#123;</span><br><span class="line">	/* renamed from: CN */</span><br><span class="line">    public static C7656n m69428CN() &#123;</span><br><span class="line">        C1693g.m4270Dr();</span><br><span class="line">        return C1693g.m4268Dp().f13865gRu;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†çœ‹C7656nè°ƒç”¨ç±»ï¼šå¥½å§åªçœ‹mo13442aè¿™ä¸€ä¸ªæ–¹æ³•å°±è¡Œäº†ï¼Œè¿™ä¸ªå°±æ˜¯é€šè¿‡å¥½å‹çš„å¼€å§‹æ–¹æ³•äº†ï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">/* renamed from: com.tencent.mm.ad.n */</span><br><span class="line">public final class C7656n implements C1125e &#123;</span><br><span class="line">	/* renamed from: a */</span><br><span class="line">    public final boolean mo13442a(C1138k c1138k, int i) &#123;</span><br><span class="line">        boolean z = c1138k != null || i &gt;= 0;</span><br><span class="line">        Assert.assertTrue(z);</span><br><span class="line">        String str = &quot;worker thread has not been set&quot;;</span><br><span class="line">        if (this.f30978hoG != null) &#123;</span><br><span class="line">            z = true;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            z = false;</span><br><span class="line">        &#125;</span><br><span class="line">        Assert.assertTrue(str, z);</span><br><span class="line">        if (!m15236e(c1138k)) &#123;</span><br><span class="line">            return false;</span><br><span class="line">        &#125;</span><br><span class="line">        m15231b(c1138k, i);</span><br><span class="line">        return true;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æˆ‘ä»¬åœ¨çœ‹è¯·æ±‚çš„å‚æ•°ï¼šä¸€ä¸ªç±»C31589oï¼Œå¥½å§ï¼Œçœ‹å‡ºæ¥äº†ï¼Œå°±æ˜¯ä¸€ä¸ªmodelç±»ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">/* renamed from: com.tencent.mm.pluginsdk.model.o */</span><br><span class="line">public class C31589o extends C1138k implements C1865k &#123;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç»¼ä¸Šï¼šæˆ‘ä»¬å¯ä»¥å¾—åˆ°æœ€ç»ˆçš„é™é»˜å®ç°å¥½å‹éªŒè¯è¯·æ±‚é€šè¿‡äº†ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">    public void onUpdate(Object database, String path, String table, ContentValues values, String whereClause, String[] whereArgs, int conflictAlgorithm) &#123;</span><br><span class="line">        if (DBConstants.MicroMsg.Fmessage_Conversation.TABLE_NAME.equals(table)) &#123;</span><br><span class="line"></span><br><span class="line">            Integer isNew = values.getAsInteger(DBConstants.MicroMsg.Fmessage_Conversation.COLUMN_isNew);</span><br><span class="line">            String talker = values.getAsString(DBConstants.MicroMsg.Fmessage_Conversation.COLUMN_talker);</span><br><span class="line">            Log.e(WeixinHook.TAG, &quot;DBEventReceiveFriendsVerify; parseRequestContent;isNew.&quot;+isNew);</span><br><span class="line"></span><br><span class="line">            // isNew == 1:æ–°å¥½å‹è¯·æ±‚</span><br><span class="line">            if (isNew != null &amp;&amp; isNew == 1) &#123;</span><br><span class="line">                try &#123;</span><br><span class="line">                    String fmsgContent = values.getAsString(DBConstants.MicroMsg.Fmessage_Conversation.COLUMN_fmsgContent);</span><br><span class="line">                    Log.e(WeixinHook.TAG, &quot;DBEventReceiveFriendsVerify; parseRequestContent;fmsgContent.&quot;+fmsgContent);</span><br><span class="line"></span><br><span class="line">                    JSONObject jsonObject = new XmlToJson.Builder(fmsgContent).build().toJson();</span><br><span class="line">                    JSONObject appMsg = jsonObject.getJSONObject(&quot;msg&quot;);</span><br><span class="line">                    if (fmsgContent == null) &#123;</span><br><span class="line">                        Log.e(WeixinHook.TAG, &quot;DBEventReceiveFriendsVerify; parseRequestContent; appMsg is null, just return.&quot;);</span><br><span class="line">                        return;</span><br><span class="line">                    &#125;</span><br><span class="line">                    Log.e(WeixinHook.TAG, &quot;DBEventReceiveFriendsVerify; &amp;wxid:=&quot; + appMsg.getString(&quot;fromusername&quot;) + &quot;&amp;ticket:&quot; + appMsg.getString(&quot;ticket&quot;) + &quot;&amp;scene:&quot; + appMsg.getInt(&quot;scene&quot;));</span><br><span class="line">                    int state  = Utils.getFCState(talker);</span><br><span class="line">                    Log.e(WeixinHook.TAG, &quot;DBEventReceiveFriendsVerify; state1:&quot;+state);</span><br><span class="line">                    if(state == 1)&#123;</span><br><span class="line">                        report(appMsg.getString(&quot;fromusername&quot;).toString(),</span><br><span class="line">                                appMsg.getString(&quot;fromnickname&quot;).toString(),</span><br><span class="line">                                appMsg.getString(&quot;content&quot;).toString()</span><br><span class="line">                        );</span><br><span class="line">                    &#125;else&#123;</span><br><span class="line">                        final Object instance_y_as_cn = XposedHelpers.callStaticMethod(</span><br><span class="line">                                XposedHelpers.findClass(&quot;com.tencent.mm.y.as&quot;, mWeixinHook.getClassLoader()),</span><br><span class="line">                                &quot;CN&quot;</span><br><span class="line">                        );</span><br><span class="line"></span><br><span class="line">                        String username = appMsg.getString(&quot;fromusername&quot;).toString();</span><br><span class="line">                        String ticket = appMsg.getString(&quot;ticket&quot;).toString();</span><br><span class="line">                        int scene = appMsg.getInt(&quot;scene&quot;);</span><br><span class="line">                        Class&lt;?&gt; class_model_o = XposedHelpers.findClass(&quot;com.tencent.mm.pluginsdk.model.o&quot;, mWeixinHook.getClassLoader());</span><br><span class="line">                        Object request = XposedHelpers.newInstance(class_model_o, username, ticket, scene);</span><br><span class="line"></span><br><span class="line">                        Object result = XposedHelpers.callMethod(instance_y_as_cn, &quot;a&quot;, request, 0);</span><br><span class="line">                        Log.e(WeixinHook.TAG, &quot;DBEventReceiveFriendsVerify; result; &quot; + result);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125; catch (Exception e) &#123;</span><br><span class="line">                    e.printStackTrace();</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•ä¸€ä¸‹ï¼Œæå®šã€‚</p>
<h2 id="å‚è€ƒèµ„æº"><a href="#å‚è€ƒèµ„æº" class="headerlink" title="å‚è€ƒèµ„æº"></a>å‚è€ƒèµ„æº</h2><p><a href="https://api.xposed.info/reference/packages.html" target="_blank" rel="noopener">https://api.xposed.info/reference/packages.html</a></p>
<p><a href="https://bintray.com/rovo89/de.robv.android.xposed/api" target="_blank" rel="noopener">https://bintray.com/rovo89/de.robv.android.xposed/api</a></p>
<p><a href="http://www.infoq.com/cn/articles/android-in-depth-xposed" target="_blank" rel="noopener">http://www.infoq.com/cn/articles/android-in-depth-xposed</a></p>
<p><a href="https://blog.csdn.net/u012417380/article/details/55254369?locationNum=13&amp;fps=1" target="_blank" rel="noopener">https://blog.csdn.net/u012417380/article/details/55254369?locationNum=13&amp;fps=1</a></p>
<p><a href="https://www.cnblogs.com/gordon0918/p/6732100.html" target="_blank" rel="noopener">https://www.cnblogs.com/gordon0918/p/6732100.html</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Xposed </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[MIUIæƒé™æ£€æµ‹ä¹‹è·¯]]></title>
      <url>/2019/07/02/permissioncheck/</url>
      <content type="html"><![CDATA[<h2 id="é—®é¢˜ä¸éœ€æ±‚"><a href="#é—®é¢˜ä¸éœ€æ±‚" class="headerlink" title="é—®é¢˜ä¸éœ€æ±‚"></a>é—®é¢˜ä¸éœ€æ±‚</h2><p>åœ¨ä¸šåŠ¡çº¿åœ¨ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿäº†ä¸€äº›æƒé™çŠ¶æ€ä¸¢å¤±çš„æƒ…å†µã€‚è€Œåœ¨æˆ‘ä»¬çš„ç¾¤æ§å¹³å°ä¸­ï¼Œå¦‚æœæŸäº›æƒé™çš„è®¾ç½®çŠ¶æ€ä¸¢å¤±ï¼Œåˆ™ç¾¤æ§å¹³å°ç»å¤§å¤šæ•°åŠŸèƒ½ä¸èƒ½æ‰§è¡Œã€‚å°¤å…¶æ˜¯HRGä¸šåŠ¡äººå‘˜ï¼Œå®ƒä»¬ä¸ä»…éœ€è¦ç¾¤æ§è‡ªåŠ¨æ‰§è¡ŒåŠŸèƒ½æŒ‡ä»¤ï¼Œè¿˜ä¸èƒ½å½±å“æ‰‹åŠ¨æ“ä½œã€‚æ‰€ä»¥åœ¨æƒé™çŠ¶æ€ä¸¢å¤±åï¼Œäº§å“æå‡ºäº†ä¸€ä¸ªæƒé™æ£€æµ‹çš„éœ€æ±‚ã€‚è¿™ä¸ªéœ€æ±‚å°±æ˜¯åœ¨æˆ‘ä»¬çš„å¹³å°ä¸­æ£€æµ‹åº”ç”¨çš„æƒé™åˆ—è¡¨ï¼Œè·å–æƒé™çš„å½“å‰çŠ¶æ€ã€‚ç”¨äºæç¤ºä½¿ç”¨è€…ï¼Œå½“å‰çš„ç¾¤æ§åœ¨æƒé™è®¾ç½®ä¸Šæ˜¯å¦å·²ç»è¢«å…è®¸ã€‚</p>
<a id="more"></a>
<h2 id="æƒé™ä»‹ç»"><a href="#æƒé™ä»‹ç»" class="headerlink" title="æƒé™ä»‹ç»"></a>æƒé™ä»‹ç»</h2><p>ä¸€ä¸ªAndroidåº”ç”¨é»˜è®¤æƒ…å†µä¸‹æ˜¯ä¸æ‹¥æœ‰ä»»ä½•æƒé™çš„,  åœ¨é»˜è®¤æƒ…å†µä¸‹, ä¸€ä¸ªåº”ç”¨æ˜¯æ²¡æœ‰æƒåˆ©å»è¿›è¡Œä¸€äº›å¯èƒ½ä¼šé€ æˆä¸å¥½å½±å“çš„æ“ä½œçš„. è¿™äº›ä¸å¥½çš„å½±å“å¯èƒ½æ˜¯å¯¹å…¶å®ƒåº”ç”¨,æ“ä½œç³»ç»Ÿ,æˆ–è€…æ˜¯ç”¨æˆ·.<br>å¦‚æœåº”ç”¨éœ€è¦æŸäº›é¢å¤–çš„èƒ½åŠ›,åˆ™éœ€è¦åœ¨AndroidManifest.xmlä¸­é™æ€åœ°å£°æ˜ç›¸åº”çš„æƒé™.<br>ä¹Ÿå°±æ˜¯æˆ‘ä»¬åœ¨AndroidManifest.xmlæ³¨å†Œäº†ä¸€ç³»åˆ—uses-permissionï¼Œè¿™äº›permissionå°±æ˜¯æˆ‘ä»¬éœ€è¦ç”³è¯·çš„æƒé™ã€‚</p>
<p>åœ¨Android 6.0å‘å¸ƒä¹‹å‰, æ‰€æœ‰çš„æƒé™éƒ½åœ¨å®‰è£…åº”ç”¨çš„æ—¶å€™æ˜¾ç¤ºç»™ç”¨æˆ·,ç”¨æˆ·é€‰æ‹©å®‰è£…åˆ™è¡¨ç¤ºå…¨éƒ¨æ¥å—è¿™äº›æƒé™, ä¹‹åæ— æ³•æ’¤é”€å¯¹è¿™äº›æƒé™çš„æˆæƒ.<br>ä½†æ˜¯ä»Android 6.0å¼€å§‹, ä¸€éƒ¨åˆ†æ¯”è¾ƒå±é™©çš„æƒé™éœ€è¦åœ¨ç¨‹åºè¿è¡Œè¯·æ±‚ç”¨æˆ·æˆæƒ.<br>è‡³äºä»€ä¹ˆæ—¶å€™éœ€è¦æˆæƒ,ç”±åº”ç”¨ç¨‹åºè‡ªå·±å†³å®š.è€Œè¿™äº›æƒé™ï¼Œå°±æ˜¯æˆ‘ä»¬æ‰€è¯´çš„è¿è¡Œæ—¶æƒé™ã€‚<br>è€Œå¯¹äºå…¶ä»–æƒé™,è®¤ä¸ºä¸æ˜¯å¾ˆå±é™©,æ‰€ä»¥ä»ç„¶ä¿æŒåŸæ¥çš„åšæ³•,åœ¨ç”¨æˆ·å®‰è£…åº”ç”¨ç¨‹åºæ—¶å°±äºˆä»¥æˆæƒ.<br>éœ€è¦æ³¨æ„çš„æ˜¯,åœ¨è®¾ç½®ä¸­,å¯¹äºåº”ç”¨çš„å±é™©æƒé™,ç”¨æˆ·å¯ä»¥é€‰æ‹©æ€§åœ°è¿›è¡Œæˆæƒæˆ–è€…å…³é—­.</p>
<p>Dangerous Permissionsä¸»è¦æœ‰ï¼š</p>
<table style="margin-left: auto; margin-right: auto;">
<tbody>
<tr><th>Permission Group</th><th>Permissions</th></tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#CALENDAR" target="_blank" rel="noopener">CALENDAR</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#READ_CALENDAR" target="_blank" rel="noopener">READ_CALENDAR</a></code></li>
</ul>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#WRITE_CALENDAR" target="_blank" rel="noopener">WRITE_CALENDAR</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#CAMERA" target="_blank" rel="noopener">CAMERA</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#CAMERA" target="_blank" rel="noopener">CAMERA</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#CONTACTS" target="_blank" rel="noopener">CONTACTS</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#READ_CONTACTS" target="_blank" rel="noopener">READ_CONTACTS</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#WRITE_CONTACTS" target="_blank" rel="noopener">WRITE_CONTACTS</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#GET_ACCOUNTS" target="_blank" rel="noopener">GET_ACCOUNTS</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#LOCATION" target="_blank" rel="noopener">LOCATION</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#ACCESS_FINE_LOCATION" target="_blank" rel="noopener">ACCESS_FINE_LOCATION</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#ACCESS_COARSE_LOCATION" target="_blank" rel="noopener">ACCESS_COARSE_LOCATION</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#MICROPHONE" target="_blank" rel="noopener">MICROPHONE</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#RECORD_AUDIO" target="_blank" rel="noopener">RECORD_AUDIO</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#PHONE" target="_blank" rel="noopener">PHONE</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#READ_PHONE_STATE" target="_blank" rel="noopener">READ_PHONE_STATE</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#CALL_PHONE" target="_blank" rel="noopener">CALL_PHONE</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#READ_CALL_LOG" target="_blank" rel="noopener">READ_CALL_LOG</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#WRITE_CALL_LOG" target="_blank" rel="noopener">WRITE_CALL_LOG</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#ADD_VOICEMAIL" target="_blank" rel="noopener">ADD_VOICEMAIL</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#USE_SIP" target="_blank" rel="noopener">USE_SIP</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#PROCESS_OUTGOING_CALLS" target="_blank" rel="noopener">PROCESS_OUTGOING_CALLS</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#SENSORS" target="_blank" rel="noopener">SENSORS</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#BODY_SENSORS" target="_blank" rel="noopener">BODY_SENSORS</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#SMS" target="_blank" rel="noopener">SMS</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#SEND_SMS" target="_blank" rel="noopener">SEND_SMS</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#RECEIVE_SMS" target="_blank" rel="noopener">RECEIVE_SMS</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#READ_SMS" target="_blank" rel="noopener">READ_SMS</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#RECEIVE_WAP_PUSH" target="_blank" rel="noopener">RECEIVE_WAP_PUSH</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#RECEIVE_MMS" target="_blank" rel="noopener">RECEIVE_MMS</a></code></li>
</ul>
</td>
</tr>
<tr>
<td><code><a href="https://developer.android.com/reference/android/Manifest.permission_group.html#STORAGE" target="_blank" rel="noopener">STORAGE</a></code></td>
<td>
<ul>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#READ_EXTERNAL_STORAGE" target="_blank" rel="noopener">READ_EXTERNAL_STORAGE</a></code></li>
<li><code><a href="https://developer.android.com/reference/android/Manifest.permission.html#WRITE_EXTERNAL_STORAGE" target="_blank" rel="noopener">WRITE_EXTERNAL_STORAGE</a></code></li>
</ul>
</td>
</tr>
</tbody>
</table>        

<p>è€Œé€šè¿‡ä¸Šè¿°å±é™©æƒé™æ¥çœ‹ï¼Œæ˜¯æœ‰äº†ç»„çš„æ¦‚å¿µï¼Œåªè¦æˆ‘ä»¬æˆæƒäº†å…¶ä¸­ä¸€ä¸ªæƒé™ï¼Œé‚£å°±æˆæƒå½“å‰ç»„çš„æ‰€æœ‰å…¨æ–°å•Šã€‚è€Œæˆ‘ä»¬å¯ä»¥é€šè¿‡ä¸‹é¢çš„æ–¹æ³•è·å–åˆ°æ‰€æœ‰çš„ç”³è¯·æƒé™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">PackageManager packageManager = this.getPackageManager();</span><br><span class="line">PackageInfo packageInfo =packageManager.getPackageInfo(packageName, PackageManager.GET_PERMISSIONS);</span><br><span class="line">String[] usesPermissionsArray = packageInfo.requestedPermissions;</span><br></pre></td></tr></table></figure>

<h2 id="å®ç°å†ç¨‹"><a href="#å®ç°å†ç¨‹" class="headerlink" title="å®ç°å†ç¨‹"></a>å®ç°å†ç¨‹</h2><h3 id="App-Ops"><a href="#App-Ops" class="headerlink" title="App Ops"></a>App Ops</h3><p>Googleåœ¨SDK19ä¸­å¼•å…¥äº†AppOpsçš„æƒé™ç®¡ç†æ–¹å¼ï¼ŒAppOpsManageræ˜¯å¯¹å¤–çš„ç®¡ç†æ¥å£ï¼ŒçœŸæ­£å®ç°åŠŸèƒ½çš„æ˜¯AppOpsServiceã€‚AppOpsManageré‡Œé¢æœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æ–¹æ³•:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">AppOpsManager::checkOp(int op ,int uid ,String packageName) ï¼ˆhideæ–¹æ³•)</span><br><span class="line">AppOpsManager::checkOp(String op,int uid ,String packageName)ï¼ˆpublicæ–¹æ³•ï¼‰</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ç¬¬äºŒä¸ªæ–¹å¼æ£€æµ‹æƒé™çš„çŠ¶æ€ï¼Œuidå’ŒpackageNameæˆ‘ä»¬å¯ä»¥æ‹¿åˆ°ï¼Œä½†æ˜¯opæ˜¯ä»€ä¹ˆå‘¢ï¼Œé€šè¿‡æŸ¥æ‰¾æˆ‘ä»¬å‘ç°AppOpsManageræä¾›äº†ä¸€ä¸ªå‡½æ•°permissionToOpï¼Œé€šè¿‡è¿™ä¸ªå‡½æ•°æˆ‘ä»¬å¯ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥æŠŠæ ‡é¢˜1ä¸­è·å–åˆ°çš„uses-permissionè½¬æ¢æˆopï¼Œç„¶åæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨checkOpè·å–åˆ°æƒé™çš„çŠ¶æ€ç»“æœäº†ã€‚<br>ä½†æ˜¯åœ¨å®é™…çš„æ“ä½œä¸­æˆ‘ä»¬å‘ç°ã€‚å‘ç”Ÿäº†ä¸€ä¸ªSecurityExceptionå¼‚å¸¸ã€‚è¿™ä¸ªæ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Œæˆ‘ä»¬é€šè¿‡æŸ¥çœ‹æºç å‘ç°ã€‚permissionToOpå¯èƒ½ä¸ºç©ºï¼Œè¿™ä¸ªæ˜¯å› ä¸ºï¼Œæˆ‘ä»¬æ ‡é¢˜1ä¸­è·å–åˆ°çš„permissionï¼Œä¸ä¸€å®šæœ‰å¯¹åº”çš„opå€¼ã€‚éƒ¨åˆ†å±•ç¤ºå¦‚ä¸‹æ‰€ç¤ºï¼šæˆ‘ä»¬å‘ç°å…¶ä¸­æœ‰å¥½å¤šnullå€¼ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * This maps each operation to the public string constant for it.</span><br><span class="line"> * If it doesn&apos;t have a public string constant, it maps to null.</span><br><span class="line"> */</span><br><span class="line">private static String[] sOpToString = new String[] &#123;</span><br><span class="line">        OPSTR_COARSE_LOCATION,</span><br><span class="line">        OPSTR_FINE_LOCATION,</span><br><span class="line">        null,</span><br><span class="line">        null,</span><br><span class="line">        OPSTR_READ_CONTACTS,</span><br><span class="line">        OPSTR_WRITE_CONTACTS,</span><br><span class="line">        OPSTR_READ_CALL_LOG,</span><br><span class="line">        ......,</span><br><span class="line">        ......,</span><br><span class="line">        ......,</span><br><span class="line">        ......,</span><br><span class="line">        ......,</span><br><span class="line">        null,</span><br><span class="line">        OPSTR_USE_FINGERPRINT,</span><br><span class="line">        OPSTR_BODY_SENSORS,</span><br><span class="line">        OPSTR_READ_CELL_BROADCASTS,</span><br><span class="line">        OPSTR_MOCK_LOCATION,</span><br><span class="line">        OPSTR_READ_EXTERNAL_STORAGE,</span><br><span class="line">        OPSTR_WRITE_EXTERNAL_STORAGE,</span><br><span class="line">        null,</span><br><span class="line">        OPSTR_GET_ACCOUNTS,</span><br><span class="line">        null,</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

<p>ç»“è®ºï¼š</p>
<p>1ã€é€šè¿‡permissionToOpå’ŒcheckOpå°†ä¸èƒ½æ»¡è¶³æˆ‘ä»¬çš„éœ€æ±‚ã€‚</p>
<p>2ã€æˆ‘ä»¬å‘ç°AndroidManifest.xmlä¸­çš„æƒé™è¦æ¯”å°ç±³æ‰‹æœºæƒé™åˆ—è¡¨ä¸­çš„è¦å¤šã€‚</p>
<h3 id="SecurityCenter"><a href="#SecurityCenter" class="headerlink" title="SecurityCenter"></a>SecurityCenter</h3><p>SecurityCenteræ˜¯ä»€ä¹ˆï¼Œå®ƒæ˜¯å°ç±³æ‰‹æœºæƒé™ç®¡ç†çš„apkï¼Œé€šè¿‡åç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥ä¸€æ­¥æ­¥çš„å‘ç°å°ç±³æ‰‹æœºè·å–æƒé™åˆ—è¡¨çŠ¶æ€çš„å®ç°æ–¹å¼ã€‚ç²˜ä¸€ä¸‹å°ç±³çš„å®ç°æ ¸å¿ƒä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br></pre></td><td class="code"><pre><span class="line">public PermissionList loadInBackground() &#123;</span><br><span class="line">        PermissionList permissionList = new PermissionList();</span><br><span class="line">        permissionList.isEnabled = isEnabled();</span><br><span class="line">        HashMap cB = packagePermisson(this.mContext, packageName);</span><br><span class="line"></span><br><span class="line">        ArrayList&lt;PermissionBean&gt; arrayList = new ArrayList();</span><br><span class="line">        permissionList.hashMap = cB;</span><br><span class="line">        permissionList.PermissionBeanList = arrayList;</span><br><span class="line">        if (cB != null) &#123;</span><br><span class="line">            Iterable&lt;PermissionGroupInfo&gt; boo = mo5980boo(0);</span><br><span class="line">            Iterable&lt;PermissionInfo&gt; bop = mo5981bop(0);</span><br><span class="line">            Set keySet = cB.keySet();</span><br><span class="line">            HashMap hashMap = new HashMap();</span><br><span class="line">            for (PermissionGroupInfo permissionGroupInfo : boo) &#123;</span><br><span class="line">                PermissionBean permissionBean = new PermissionBean();</span><br><span class="line">                permissionBean.permissionGroupInfo = permissionGroupInfo;</span><br><span class="line">                hashMap.put(Integer.valueOf(permissionGroupInfo.getId()), permissionBean);</span><br><span class="line">                arrayList.add(permissionBean);</span><br><span class="line">            &#125;</span><br><span class="line">            for (PermissionInfo permissionInfo : bop) &#123;</span><br><span class="line">                if (keySet.contains(Long.valueOf(permissionInfo.getId()))) &#123;</span><br><span class="line">                    PermissionBean permissionBean2 = (PermissionBean) hashMap.get(Integer.valueOf(permissionInfo.getGroup()));</span><br><span class="line">                    if (permissionBean2 != null) &#123;</span><br><span class="line">                        permissionBean2.permissionInfoArrayList.add(permissionInfo);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            ArrayList&lt;PermissionBean&gt; arrayList2 = new ArrayList();</span><br><span class="line">            for (PermissionBean permissionBean3 : arrayList) &#123;</span><br><span class="line">                if (permissionBean3.permissionInfoArrayList.size() == 0) &#123;</span><br><span class="line">                    arrayList2.add(permissionBean3);</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">            for (PermissionBean permissionBean32 : arrayList2) &#123;</span><br><span class="line">                arrayList.remove(permissionBean32);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        return permissionList;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­ï¼ŒpackagePermissonï¼Œmo5980booï¼Œmo5981bopï¼Œéƒ½æ˜¯é€šè¿‡ContentResolverè·¨è¿›ç¨‹è·å–åˆ°çš„ï¼Œç„¶åæŠŠè·å–åˆ°çš„æƒé™åˆ†ç»„æ‹¼è£…å³å¯ã€‚æ‰€ä»¥ï¼Œé€šè¿‡è¿™ç§æ–¹å¼ï¼Œæˆ‘ä»¬è·å–åˆ°çš„æƒé™çŠ¶æ€å’Œå°ç±³æ‰‹æœºçš„æƒé™åˆ—è¡¨æ˜¯ä¸€è‡´çš„ã€‚</p>
<p>ç»“è®ºï¼š</p>
<p>å› ä¸ºä¸Šè¿°å®ç°æ˜¯åŸºäºnote 4xæ‰‹æœºçš„å®‰å…¨ä¸­å¿ƒè·å–çš„ï¼Œæ‰€ä»¥æ²¡æœ‰é—®é¢˜ã€‚ä½†æ˜¯æˆ‘ä»¬çš„æ‰‹æœºå‹å·ä¸æ­¢æ˜¯4xæ‰‹æœºï¼Œè¿˜æœ‰å…¶ä»–å°ç±³æ‰‹æœºï¼Œä½†æˆ‘åœ¨å…¶ä»–æ‰‹æœºä¸Šè¿è¡Œçš„æ—¶å€™ï¼Œå‘ç°æŠ¥é”™ï¼Œå‡ºç°æ²¡æœ‰miui.permission.READ_AND_WIRTE_PERMISSION_MANAGERçš„å¼‚å¸¸ã€‚æ‰€ä»¥ï¼Œè¿™ç§å®ç°æ–¹å¼ï¼Œä¸èƒ½æ”¯æ’‘æ‰€æœ‰æ‰‹æœºã€‚</p>
<h3 id="AppOpsX"><a href="#AppOpsX" class="headerlink" title="AppOpsX"></a>AppOpsX</h3><p>æ˜¯ä¸€ä¸ªç¬¬ä¸‰æ–¹æƒé™ç®¡ç†çš„å®ç°ï¼Œé€šè¿‡è°ƒç”¨appopsçš„æƒé™ç®¡ç†å™¨ï¼Œæ§åˆ¶æƒé™ç®¡ç†ã€‚<br>[Github:<a href="https://github.com/8enet/AppOpsX]" target="_blank" rel="noopener">https://github.com/8enet/AppOpsX]</a> (<a href="https://github.com/8enet/AppOpsX),æ¥å…¥AppOpsXåï¼Œå¯ä»¥æ”¯æ’‘æ‰€æœ‰å°ç±³æ‰‹æœºï¼Œä½†æ˜¯è·å–åˆ°çš„æƒé™åˆ—è¡¨ä¸èƒ½å’Œå°ç±³æ‰‹æœºçš„æƒé™ä¸­å¿ƒä¸€è‡´ï¼Œè¿™ä¸ªä¼šå¯¼è‡´äº§å“å’Œè¿è¥æœ‰ä¸€å®šçš„è¯¯è§£ï¼Œå¹¶ä¸”æ¥å…¥æ¯”è¾ƒå›°éš¾ï¼Œå¯èƒ½å¯¹ä»Šå¤©ç‰ˆæœ¬çš„å…¼å®¹ä¹Ÿä¼šæœ‰é—®é¢˜ã€‚" target="_blank" rel="noopener">https://github.com/8enet/AppOpsX),æ¥å…¥AppOpsXåï¼Œå¯ä»¥æ”¯æ’‘æ‰€æœ‰å°ç±³æ‰‹æœºï¼Œä½†æ˜¯è·å–åˆ°çš„æƒé™åˆ—è¡¨ä¸èƒ½å’Œå°ç±³æ‰‹æœºçš„æƒé™ä¸­å¿ƒä¸€è‡´ï¼Œè¿™ä¸ªä¼šå¯¼è‡´äº§å“å’Œè¿è¥æœ‰ä¸€å®šçš„è¯¯è§£ï¼Œå¹¶ä¸”æ¥å…¥æ¯”è¾ƒå›°éš¾ï¼Œå¯èƒ½å¯¹ä»Šå¤©ç‰ˆæœ¬çš„å…¼å®¹ä¹Ÿä¼šæœ‰é—®é¢˜ã€‚</a></p>
<h3 id="checkSelfPermission"><a href="#checkSelfPermission" class="headerlink" title="checkSelfPermission"></a>checkSelfPermission</h3><h4 id="ContextCompat"><a href="#ContextCompat" class="headerlink" title="ContextCompat"></a>ContextCompat</h4><p>Android 6.0 å˜æ›´:<br>æ­¤ç‰ˆæœ¬å¼•å…¥äº†ä¸€ç§æ–°çš„æƒé™æ¨¡å¼ï¼Œå¦‚ä»Šï¼Œç”¨æˆ·å¯ç›´æ¥åœ¨è¿è¡Œæ—¶ç®¡ç†åº”ç”¨æƒé™ã€‚è¿™ç§æ¨¡å¼è®©ç”¨æˆ·èƒ½å¤Ÿæ›´å¥½åœ°äº†è§£å’Œæ§åˆ¶æƒé™ï¼ŒåŒæ—¶ä¸ºåº”ç”¨å¼€å‘è€…ç²¾ç®€äº†å®‰è£…å’Œè‡ªåŠ¨æ›´æ–°è¿‡ç¨‹ã€‚ç”¨æˆ·å¯ä¸ºæ‰€å®‰è£…çš„å„ä¸ªåº”ç”¨åˆ†åˆ«æˆäºˆæˆ–æ’¤é”€æƒé™ã€‚</p>
<p>å¯¹äºä»¥ Android 6.0ï¼ˆAPI çº§åˆ« 23ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ä¸ºç›®æ ‡å¹³å°çš„åº”ç”¨ï¼Œè¯·åŠ¡å¿…åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œè¯·æ±‚æƒé™ã€‚è¦ç¡®å®šæ‚¨çš„åº”ç”¨æ˜¯å¦å·²è¢«æˆäºˆæƒé™ï¼Œè¯·è°ƒç”¨æ–°å¢çš„ checkSelfPermission() æ–¹æ³•ã€‚è¦è¯·æ±‚æƒé™ï¼Œè¯·è°ƒç”¨æ–°å¢çš„ requestPermissions() æ–¹æ³•ã€‚å³ä½¿æ‚¨çš„åº”ç”¨å¹¶ä¸ä»¥ Android 6.0ï¼ˆAPI çº§åˆ« 23ï¼‰ä¸ºç›®æ ‡å¹³å°ï¼Œæ‚¨ä¹Ÿåº”è¯¥åœ¨æ–°æƒé™æ¨¡å¼ä¸‹æµ‹è¯•æ‚¨çš„åº”ç”¨ã€‚</p>
<p>å¦‚éœ€äº†è§£æœ‰å…³åœ¨æ‚¨çš„åº”ç”¨ä¸­æ”¯æŒæ–°æƒé™æ¨¡å¼çš„è¯¦æƒ…ï¼Œè¯·å‚é˜…ä½¿ç”¨ç³»ç»Ÿæƒé™ã€‚å¦‚éœ€äº†è§£æœ‰å…³å¦‚ä½•è¯„ä¼°æ–°æ¨¡å¼å¯¹åº”ç”¨çš„å½±å“çš„æç¤ºï¼Œè¯·å‚é˜…æƒé™æœ€ä½³åšæ³•ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/02/permissioncheck/checkSelfPermission.png" alt="checkSelfPermission" title class>
                <p>checkSelfPermission</p>
            </figure>
<p>ä»ä¸Šå›¾å¯çŸ¥ï¼Œæœ€ç»ˆçš„checkä¼šåˆ°PackageManagerService. checkComponentPermission,è€ŒcheckComponentPermissionæœ€ç»ˆè°ƒç”¨äº†</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">@Override</span><br><span class="line">public int checkUidPermission(String permName, int uid) &#123;</span><br><span class="line">    final int userId = UserHandle.getUserId(uid);</span><br><span class="line"></span><br><span class="line">    if (!sUserManager.exists(userId)) &#123;</span><br><span class="line">        return PackageManager.PERMISSION_DENIED;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    synchronized (mPackages) &#123;</span><br><span class="line">        Object obj = mSettings.getUserIdLPr(UserHandle.getAppId(uid));</span><br><span class="line">        if (obj != null) &#123;</span><br><span class="line">            final SettingBase ps = (SettingBase) obj;</span><br><span class="line">            final PermissionsState permissionsState = ps.getPermissionsState();</span><br><span class="line">            if (permissionsState.hasPermission(permName, userId)) &#123;</span><br><span class="line">                return PackageManager.PERMISSION_GRANTED;</span><br><span class="line">            &#125;</span><br><span class="line">            // Special case: ACCESS_FINE_LOCATION permission includes ACCESS_COARSE_LOCATION</span><br><span class="line"> if (Manifest.permission.ACCESS_COARSE_LOCATION.equals(permName) &amp;&amp; permissionsState</span><br><span class="line">                    .hasPermission(Manifest.permission.ACCESS_FINE_LOCATION, userId)) &#123;</span><br><span class="line">                return PackageManager.PERMISSION_GRANTED;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125; else &#123;</span><br><span class="line">            ArraySet&lt;String&gt; perms = mSystemPermissions.get(uid);</span><br><span class="line">            if (perms != null) &#123;</span><br><span class="line">                if (perms.contains(permName)) &#123;</span><br><span class="line">                    return PackageManager.PERMISSION_GRANTED;</span><br><span class="line">                &#125;</span><br><span class="line">                if (Manifest.permission.ACCESS_COARSE_LOCATION.equals(permName) &amp;&amp; perms</span><br><span class="line">                        .contains(Manifest.permission.ACCESS_FINE_LOCATION)) &#123;</span><br><span class="line">                    return PackageManager.PERMISSION_GRANTED;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return PackageManager.PERMISSION_DENIED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ€é‡è¦çš„å°±æ˜¯mSettingsï¼Œæ‰€æœ‰çš„æƒé™ä¿¡æ¯éƒ½é€šè¿‡mSettingsæ¥è·å–ï¼Œä½†æ˜¯mSettingsæ˜¯éƒ½åšäº†ä»€ä¹ˆæ“ä½œå‘¢ï¼Ÿçœ‹ä¸‹è¾¹çš„å›¾ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/02/permissioncheck/setting.png" alt="setting" title class>
                <p>setting</p>
            </figure>
<p>Android6.0ä¹‹å‰ä¼šå§æ‰€æœ‰çš„æƒé™éƒ½æ”¾ç½®åœ¨data/system/packages.xmlæ–‡ä»¶ä¸­ã€‚Android6.0ä¹‹åï¼Œåˆ†ä¸ºè¿è¡Œæ—¶æƒé™è·Ÿæ™®é€šæƒé™ï¼Œæ™®é€šæƒé™è¿˜æ˜¯æ”¾åœ¨data/system/packages.xmlä¸­ï¼Œè¿è¡Œæ—¶æƒé™é˜²æ­¢åœ¨data/system/users/0/runtime-permissions.xmlæ–‡ä»¶ä¸­ã€‚æ ¹æ®è¿è¡Œæ—¶æ˜¯å¦åŠ¨æ€ç”³è¯·å»æ›´æ–°æƒé™ã€‚è€Œå¯¹äºæ™®é€šæƒé™ï¼Œä¸€ç›´éƒ½ä¸ºtrueã€‚<br>å…·ä½“çš„å®ä¾‹ä¿¡æ¯å¦‚ä¸‹ï¼š</p>
<p><strong><em>packages.xml</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">&lt;package name=&quot;com.permisison.naga&quot; codePath=&quot;/data/app/com.wuba.tinyhand-2&quot; nativeLibraryPath=&quot;/data/app/com.wuba.tinyhand-2/lib&quot; primaryCpuAbi=&quot;armeabi&quot; publicFlags=&quot;944291398&quot; privateFlags=&quot;0&quot; ft=&quot;166817e48c8&quot; it=&quot;16615425c49&quot; ut=&quot;166817e51fc&quot; version=&quot;2540&quot; userId=&quot;10141&quot;&gt;</span><br><span class="line">        &lt;sigs count=&quot;1&quot;&gt;</span><br><span class="line">            &lt;cert index=&quot;11&quot; /&gt;</span><br><span class="line">        &lt;/sigs&gt;</span><br><span class="line">        &lt;perms&gt;</span><br><span class="line">            &lt;item name=&quot;android.permission.WRITE_SETTINGS&quot; granted=&quot;true&quot; flags=&quot;0&quot; /&gt;</span><br><span class="line">            &lt;item name=&quot;android.permission.RESTART_PACKAGES&quot; granted=&quot;true&quot; flags=&quot;0&quot; /&gt;</span><br><span class="line">            &lt;item name=&quot;android.permission.SYSTEM_ALERT_WINDOW&quot; granted=&quot;true&quot; flags=&quot;0&quot; /&gt;</span><br><span class="line">        &lt;/perms&gt;</span><br><span class="line">        &lt;proper-signing-keyset identifier=&quot;28&quot; /&gt;</span><br><span class="line">    &lt;/package&gt;</span><br></pre></td></tr></table></figure>

<p><strong><em>runtime-permissions.xml</em></strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;pkg name=&quot;com.permisison.naga&quot;&gt;</span><br><span class="line">    &lt;item name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; granted=&quot;true&quot; flags=&quot;2&quot; /&gt;</span><br><span class="line">    &lt;item name=&quot;android.permission.READ_PHONE_STATE&quot; granted=&quot;true&quot; flags=&quot;2&quot; /&gt;</span><br><span class="line">    &lt;item name=&quot;android.permission.SEND_SMS&quot; granted=&quot;false&quot; flags=&quot;2&quot; /&gt;</span><br><span class="line">    &lt;item name=&quot;android.permission.PROCESS_OUTGOING_CALLS&quot; granted=&quot;true&quot; flags=&quot;2&quot; /&gt;</span><br><span class="line">    &lt;item name=&quot;android.permission.GET_ACCOUNTS&quot; granted=&quot;true&quot; flags=&quot;2&quot; /&gt;</span><br><span class="line">    &lt;item name=&quot;android.permission.WRITE_EXTERNAL_STORAGE&quot; granted=&quot;true&quot; flags=&quot;2&quot; /&gt;</span><br><span class="line">  &lt;/pkg&gt;</span><br></pre></td></tr></table></figure>

<p>ç»“è®ºï¼š</p>
<p>1ã€checkSelfPermissionä¼šåˆ†åˆ«åˆ¤æ–­ä¸¤ä¸ªxmlæ–‡ä»¶ï¼Œpackages.xmlæ˜¯æ™®é€šæƒé™ï¼Œå¹¶ä¸”ä¸€ç›´è¿”å›trueï¼Œruntime-permissions.xmlè¿”å›çš„æ˜¯åŠ¨æ€æƒé™çš„çŠ¶æ€ï¼Œä¼šæ ¹æ®å½“å‰è®¾ç½®è¿”å›0å’Œ-1ï¼Œ0æ˜¯æˆäºˆï¼Œ-1æ˜¯æœªè¢«æˆäºˆæƒé™ã€‚</p>
<p>2ã€å›½å†…æ‰‹æœºå‚å•†çš„roméƒ½æ˜¯ä¿®æ”¹è¿‡äº†ï¼Œå¹¶ä¸”å¢åŠ äº†ä¸å°‘è‡ªå®šä¹‰çš„æƒé™ï¼Œæ‰€ä»¥è¿™ä¸ªæ–¹æ³•è·å–çš„ç»“æœæ˜¯ä¸å…¨çš„ã€‚</p>
<h4 id="PermissionChecker"><a href="#PermissionChecker" class="headerlink" title="PermissionChecker"></a>PermissionChecker</h4><p>ç›´æ¥çœ‹ä¸‹å…³é”®ä»£ç ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line">public static int checkPermission(@NonNull Context context, @NonNull String permission,</span><br><span class="line">        int pid, int uid, String packageName) &#123;</span><br><span class="line">    if (context.checkPermission(permission, pid, uid) == PackageManager.PERMISSION_DENIED) &#123;</span><br><span class="line">        return PERMISSION_DENIED;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    String op = AppOpsManagerCompat.permissionToOp(permission);</span><br><span class="line">    if (op == null) &#123;</span><br><span class="line">        return PERMISSION_GRANTED;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (packageName == null) &#123;</span><br><span class="line">        String[] packageNames = context.getPackageManager().getPackagesForUid(uid);</span><br><span class="line">        if (packageNames == null || packageNames.length &lt;= 0) &#123;</span><br><span class="line">            return PERMISSION_DENIED;</span><br><span class="line">        &#125;</span><br><span class="line">        packageName = packageNames[0];</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    if (AppOpsManagerCompat.noteProxyOp(context, op, packageName)</span><br><span class="line">            != AppOpsManagerCompat.MODE_ALLOWED) &#123;</span><br><span class="line">        return PERMISSION_DENIED_APP_OP;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    return PERMISSION_GRANTED;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡Œé¢æœ‰è¿™ä¹ˆä¸€å¥åˆ¤æ–­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">String op = AppOpsManagerCompat.permissionToOp(permission);</span><br><span class="line">if (op == null) &#123;</span><br><span class="line">        return PERMISSION_GRANTED;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p> AppOpsManagerè¿”å›ä¸ºnullçš„permissionï¼Œéƒ½è¿”å›PERMISSION_GRANTED=0ï¼›è¿™ä¸ªåˆ¤æ–­å°±ä¸å‡†ç¡®äº†ï¼Œå¦‚æœä¸€ä¸ªè¿è¡Œæ—¶æƒé™ï¼Œæ²¡æœ‰åœ¨è¿™ä¸ªé‡Œé¢ï¼Œé‚£å°±æ°¸è¿œä¸ºoäº†ã€‚å³ä½¿è®¾ç½®äº†æ‹’ç»ï¼Œä¹Ÿè·å–ä¸åˆ°PERMISSION_DENIED=1ã€‚å¹¶ä¸”ï¼Œå°ç±³æ‰‹æœºè®¾ç½®å¥½å¤š10000ä»¥ä¸Šéƒ½opè‡ªå®šä¹‰æƒé™ï¼Œè‚¯å®šæ˜¯è·å–ä¸åˆ°ï¼Œå¹¶ä¸”æœ‰äº›æƒé™è¿˜æ²¡æœ‰permissionã€‚</p>
<p>ç»“è®ºï¼šå®Œå…¨ä¸å¯ç”¨ã€‚ç»§ç»­å°è¯•</p>
<h3 id="AuthManager"><a href="#AuthManager" class="headerlink" title="AuthManager"></a>AuthManager</h3><p>é€šè¿‡ä¸Šè¿°ä¸€äº›åˆ—çš„éªŒè¯ï¼Œéƒ½æ˜¯ä¸å¯ä»¥é‡‡ç”¨çš„ç»“è®ºã€‚æœ€ç»ˆæˆ‘ä»¬å†æ¬¡å›åˆ°note 4xçš„å®ç°æ–¹æ¡ˆä¸Šæ¥ã€‚ç”±äºå†æ ‡é¢˜2çš„æ—¶å€™ï¼Œæˆ‘ä»¬åªæ˜¯è°ƒç ”äº†è·å–æƒé™çŠ¶æ€çš„æ–¹å¼ï¼Œä½†æ˜¯æ²¡æœ‰æ·±å…¥çš„è°ƒç ”åº•å±‚å®ç°ã€‚æ‰€ä»¥æˆ‘ä»¬é€šè¿‡ä¸€äº›åˆ—è·Ÿè¸ªï¼Œæœ€ç»ˆæ‰¾åˆ°å…·ä½“çš„å®ç°åœ°æ–¹åœ¨AuthManagerè¿™ä¸ªappä¸‹ã€‚</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/02/permissioncheck/authmanager.png" alt="authmanager" title class>
                <p>authmanager</p>
            </figure>
<p>ç»“è®ºï¼š</p>
<p>1ã€ç”±ä¸Šå›¾å¯ä»¥çœ‹å‡ºï¼Œå°ç±³æ‰‹æœºå®Œå…¨è‡ªå·±å°è£…äº†ä¸€å±‚æƒé™ç®¡ç†ï¼Œå®ƒçš„æƒé™çŠ¶æ€éƒ½å­˜å‚¨åœ¨äº†miui_ngen.dbæ•°æ®åº“é‡Œï¼Œå¹¶ä¸”é€šè¿‡PermissionManagerç®¡ç†å¹¶å®šä¹‰äº†æƒé™çš„opå’Œandroid.permissionå€¼ã€‚</p>
<p>2ã€æ—¢ç„¶updateæ—¶å®Œå…¨æ“ä½œäº†dbå’Œxmlä¸‰ä¸ªæ–‡ä»¶ã€‚é‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥ç”¨åå°„çš„æ–¹æ³•å®ç°å‘¢ï¼Ÿç»è¿‡å®ç°ï¼Œåˆ©ç”¨åå°„checkOpNoThrowè™½ç„¶å¯ä»¥è·å–åˆ°å…·ä½“çŠ¶æ€å€¼ï¼Œä½†æ˜¯æˆ‘ä»¬åªèƒ½è·å–åˆ°å½“å‰çš„æƒé™ï¼Œä¸èƒ½è·å–åˆ°ç¬¬ä¸‰æ–¹appçš„æƒé™ï¼ŒæŠ¥<br>java.lang.SecurityException: uid 10141 does not have android.permission.UPDATE_APP_OPS_STATSå¼‚å¸¸ã€‚</p>
<p>3ã€å¼€å‘è¿‡ç¨‹ä¸­ï¼Œå‘ç°æŸäº›è¿è¡Œæƒé™op=59çš„æƒé™ä¸èƒ½æ”¹å˜ï¼Œä¸€è‡´è·å–åˆ°çš„æ˜¯0.å³æˆæƒçš„çŠ¶æ€ã€‚<br>æ‰€ä»¥åˆ©ç”¨åå°„æˆ‘ä»¬ä¹Ÿä¸èƒ½å®ç°æˆ‘ä»¬çš„éœ€æ±‚ï¼Œç»§ç»­ã€‚</p>
<h3 id="runtime-permissions-xmlä¸appops-xml"><a href="#runtime-permissions-xmlä¸appops-xml" class="headerlink" title="runtime-permissions.xmlä¸appops.xml"></a>runtime-permissions.xmlä¸appops.xml</h3><p>ç»è¿‡è°ƒç ”åå‘ç°ï¼Œå½“æˆ‘ä»¬åœ¨ä¿®æ”¹æƒé™çš„çŠ¶æ€å€¼æ—¶ï¼Œä¸ä»…appops.xmlé‡Œé¢çš„çŠ¶æ€å€¼åœ¨è¯¥æ¯”é‚£ï¼Œè€Œä¸”è¿è¡Œæƒé™runtime-permissions.xmlçš„å€¼ä¹Ÿåœ¨æ”¹å˜ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯å¯ä»¥æ¯”è¾ƒä¸¤ä¸ªæ–‡ä»¶çš„å†…å®¹è¿›è¡Œè·å–çŠ¶æ€å€¼å‘¢ã€‚ é¦–å…ˆï¼Œæˆ‘ä»¬éœ€è¦è¯»å–æ–‡ä»¶ï¼Œä½†æ˜¯æˆ‘ä»¬æ²¡æœ‰è¯»å–æ–‡ä»¶æƒé™ï¼Œæˆ‘ä»¬éœ€è¦copyåˆ°sdcardè¿›è¡Œè§£æã€‚è§£æè¿‡ç¨‹å¦‚ä¸‹å›¾ï¼š</p>
<figure class="image-box">
                <img src="http://nunu03.github.io/2019/07/02/permissioncheck/verify.png" alt="verify" title class>
                <p>verify</p>
            </figure>

<h3 id="miui-ngen-db"><a href="#miui-ngen-db" class="headerlink" title="miui_ngen.db"></a>miui_ngen.db</h3><p>miui_ngen.dbæ˜¯ä»€ä¹ˆï¼Ÿæˆ‘ä»¬éƒ½çŸ¥é“æ˜¯ä¸€ä¸ªæ•°æ®åº“æ–‡ä»¶ï¼Œè€Œä¸”è¿™ä¸ªæ˜¯miuiçš„æƒé™çŠ¶æ€ç®¡ç†æ–‡ä»¶ã€‚ä»»ä½•çš„Appæƒé™çŠ¶æ€éƒ½ä¸€ä¸€å¯¹åº”çš„å­˜åœ¨äº†è¿™ä¸ªæ–‡ä»¶é‡Œã€‚ä»è€Œç”±ä¸Šè¿°6ç§çš„æ“ä½œï¼Œæˆ‘ä»¬å—åˆ°äº†ä¸€å®šçš„å¯å‘ï¼Œæ—¢ç„¶èƒ½å¤Ÿæ‹¿åˆ°xmlæ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬æ˜¯ä¸æ˜¯ä¹Ÿå¯ä»¥ç›´æ¥æ‹¿åˆ°è¿™ä¸ªdbæ–‡ä»¶ï¼Œç„¶åç›´æ¥è¯»å–dbï¼Œè·å–çŠ¶æ€ä¿¡æ¯å‘¢ï¼Ÿç»è¿‡å°è¯•ï¼Œå¥½å§ï¼Œæƒé™æ£€æµ‹çš„æœ€ç»ˆæ–¹æ¡ˆå†³å®šä¸‹æ¥äº†ï¼Œæˆ‘ä»¬å®Œå…¨å¯ä»¥ç›´æ¥è¯»å–è¿™ä¸ªdbæ–‡ä»¶ï¼Œè·å–åˆ°å‡†ç¡®çš„ï¼Œå’Œmiuiæƒé™ç®¡ç†ä¸­å¿ƒä¸€ä¸€å¯¹åº”ï¼Œå®Œå…¨åŒ¹é…çš„æƒé™çŠ¶æ€ã€‚</p>
<p><strong>æ€»ç»“ï¼šé€šè¿‡ä»¥ä¸Šæ­¥éª¤çš„å®ç°è¿‡ç¨‹ï¼Œæˆ‘ä»¬å‘ç°ç”±äºå›½å†…å‚å•†å¯¹romçš„å®šåˆ¶ï¼Œå¯èƒ½å®Œå…¨ä¿®æ”¹æˆ–è€…å°è£…äº†æƒé™çš„å®ç°å’Œæ£€æµ‹æœºåˆ¶ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€æ­¥æ­¥çš„æµ‹è¯•å’Œæ·»å‘ï¼Œæœ€ç»ˆè¿˜æ˜¯å›åˆ°äº†æ‰‹æœºåŸæœ¬è‡ªèº«çš„æ£€æµ‹æœºåˆ¶ä¸Šæ¥ï¼Œå¹¶ä¸”è¿™ç§æ–¹å¼æ˜¯æœ€å‡†ç¡®çš„æ–¹å¼ã€‚</strong></p>
<h2 id="å¯¹æƒé™çš„å¤„ç†åœºæ™¯"><a href="#å¯¹æƒé™çš„å¤„ç†åœºæ™¯" class="headerlink" title="å¯¹æƒé™çš„å¤„ç†åœºæ™¯"></a>å¯¹æƒé™çš„å¤„ç†åœºæ™¯</h2><p>å¦‚æœè®¾å¤‡è¿è¡Œçš„æ˜¯ Android 6.0ï¼ˆAPI çº§åˆ« 23ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶ä¸”åº”ç”¨çš„ targetSdkVersion æ˜¯ 23 æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œåˆ™åº”ç”¨åœ¨è¿è¡Œæ—¶å‘ç”¨æˆ·è¯·æ±‚æƒé™ã€‚ç”¨æˆ·å¯éšæ—¶è°ƒç”¨æƒé™ï¼Œå› æ­¤åº”ç”¨åœ¨æ¯æ¬¡è¿è¡Œæ—¶å‡éœ€æ£€æŸ¥è‡ªèº«æ˜¯å¦å…·å¤‡æ‰€éœ€çš„æƒé™ã€‚</p>
<p>å¦‚æœè®¾å¤‡è¿è¡Œçš„æ˜¯ Android 5.1ï¼ˆAPI çº§åˆ« 22ï¼‰æˆ–æ›´ä½ç‰ˆæœ¬ï¼Œå¹¶ä¸”åº”ç”¨çš„ targetSdkVersion æ˜¯ 22 æˆ–æ›´ä½ç‰ˆæœ¬ï¼Œåˆ™ç³»ç»Ÿä¼šåœ¨ç”¨æˆ·å®‰è£…åº”ç”¨æ—¶è¦æ±‚ç”¨æˆ·æˆäºˆæƒé™ã€‚å¦‚æœå°†æ–°æƒé™æ·»åŠ åˆ°æ›´æ–°çš„åº”ç”¨ç‰ˆæœ¬ï¼Œç³»ç»Ÿä¼šåœ¨ç”¨æˆ·æ›´æ–°åº”ç”¨æ—¶è¦æ±‚æˆäºˆè¯¥æƒé™ã€‚ç”¨æˆ·ä¸€æ—¦å®‰è£…åº”ç”¨ï¼Œä»–ä»¬æ’¤é”€æƒé™çš„å”¯ä¸€æ–¹å¼æ˜¯å¸è½½åº”ç”¨ã€‚</p>
<p>å¦‚æœè®¾å¤‡è¿è¡Œçš„æ˜¯ Android 6.0ï¼ˆAPI çº§åˆ« 23ï¼‰æˆ–æ›´é«˜ç‰ˆæœ¬ï¼Œå¹¶ä¸”åº”ç”¨çš„ targetSdkVersion æ˜¯ 22 æˆ–æ›´ä½ç‰ˆæœ¬ï¼Œ æ­¤æ—¶Androidç³»ç»Ÿä¼šæŠŠä½ ç”³è¯·çš„å…¨éƒ¨æƒé™éƒ½ç»™ä½  ã€‚ ç”¨æˆ·ä¾ç„¶å¯ä»¥è¿›å…¥Appçš„è®¾ç½®ç•Œé¢æŠŠæƒé™å…³é—­ ï¼</p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://developer.android.com/about/versions/marshmallow/android-6.0-changes?hl=zh-cn#behavior-runtime-permissions" target="_blank" rel="noopener">https://developer.android.com/about/versions/marshmallow/android-6.0-changes?hl=zh-cn#behavior-runtime-permissions</a><br><a href="https://blog.csdn.net/lewif/article/details/49124757" target="_blank" rel="noopener">https://blog.csdn.net/lewif/article/details/49124757</a><br><a href="https://blog.csdn.net/happylishang/article/details/53813779" target="_blank" rel="noopener">https://blog.csdn.net/happylishang/article/details/53813779</a><br><a href="https://mp.weixin.qq.com/s/OQRHEufCUXBA3d3DMZXMKQ" target="_blank" rel="noopener">https://mp.weixin.qq.com/s/OQRHEufCUXBA3d3DMZXMKQ</a><br><a href="https://developer.android.com/reference/android/support/v4/content/ContextCompat#checkSelfPermission(android.content.Context,%20java.lang.String)" target="_blank" rel="noopener">https://developer.android.com/reference/android/support/v4/content/ContextCompat#checkSelfPermission(android.content.Context,%20java.lang.String)</a><br><a href="https://developer.android.com/reference/android/content/pm/PackageManager#PERMISSION_DENIED" target="_blank" rel="noopener">https://developer.android.com/reference/android/content/pm/PackageManager#PERMISSION_DENIED</a><br><a href="https://www.jianshu.com/p/0ddd129dd32b" target="_blank" rel="noopener">https://www.jianshu.com/p/0ddd129dd32b</a><br><a href="https://blog.csdn.net/happylishang/article/details/78222788" target="_blank" rel="noopener">https://blog.csdn.net/happylishang/article/details/78222788</a><br><a href="https://www.cnblogs.com/neo-java/p/7117482.html" target="_blank" rel="noopener">https://www.cnblogs.com/neo-java/p/7117482.html</a></p>
]]></content>
      
        <categories>
            
            <category> Android </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Kotlinæ–°æ‰‹ä½¿ç”¨ç¬”è®°]]></title>
      <url>/2019/07/02/kotlinnotes/</url>
      <content type="html"><![CDATA[<h2 id="constå…³é”®å­—"><a href="#constå…³é”®å­—" class="headerlink" title="constå…³é”®å­—"></a>constå…³é”®å­—</h2><p>åªè¯»å±æ€§ä½¿ç”¨constå…³é”®å­—ä¹‹åå°†æ²¡æœ‰getæ–¹æ³•ï¼Œä¸¾ä¸ªä¾‹å­<br>åœ¨kotlinæ–‡ä»¶ä¸­ï¼Œå†™ä¸¤ä¸ªåŒ…çº§å±æ€§ï¼Œä¸€ä¸ªæ˜¯constï¼Œä¸€ä¸ªä¸æ˜¯const</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">const val i = 1</span><br><span class="line">val j = &quot;A&quot;</span><br></pre></td></tr></table></figure>

<a id="more"></a>
<p>ä½¿ç”¨javaä»£ç è®¿é—®ï¼Œè®¿é—®æ–¹å¼æ˜¯ä¸åŒçš„</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">public class TestConst &#123;</span><br><span class="line">    public static void main(String[] args) &#123;</span><br><span class="line">        int i = ConstKt.i;</span><br><span class="line">        ConstKt.getJ();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸€ç§æ˜¯ä½¿ç”¨getæ–¹æ³•è®¿é—®ï¼Œä¸€ç§æ˜¯ç›´æ¥ä½¿ç”¨ç±»è®¿é—®ã€‚è¯´æ˜constå…³é”®å­—å®é™…ä¸Šç›¸å½“äºjavaçš„static finalã€‚<br>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒConståªèƒ½æ˜¯kotlinçš„stringå’ŒåŸºæœ¬ç±»å‹ã€‚<br>å…¶å®åœ¨objectä¸­constç›¸å½“äº@JvmFieldæ³¨è§£ï¼Œæ¯”å¦‚ä¸‹é¢çš„ä»£ç </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">@JvmField</span><br><span class="line">val c = 3</span><br></pre></td></tr></table></figure>

<p>å°±å’Œ</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">const val c = 3</span><br></pre></td></tr></table></figure>

<p>æ•ˆæœä¸€æ ·</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">@JvmField</span><br><span class="line">val TAGS = WeixinHook.TAG + &quot;.Test&quot;</span><br><span class="line">const val TAGSG = WeixinHook.TAG + &quot;.Test&quot;</span><br><span class="line">    </span><br><span class="line">@NotNull</span><br><span class="line">@JvmField</span><br><span class="line">public static final String TAGS = &quot;hotB.wechat.Test&quot;;</span><br><span class="line">@NotNull</span><br><span class="line">public static final String TAGSG = &quot;hotB.wechat.Test&quot;;</span><br></pre></td></tr></table></figure>

<p>åœ¨classä¸­</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">private const val TAG = XLog.hotPanel + &quot;DeviceUtil&quot;</span><br><span class="line">class DeviceUtil&#123;&#125;</span><br><span class="line"></span><br><span class="line">ç”Ÿæˆäº†å¦ä¸€ä¸ªæ–‡ä»¶å­˜å‚¨const</span><br><span class="line">public final class DeviceUtilKt &#123;</span><br><span class="line">    /* renamed from: MB */</span><br><span class="line">    private static final long f14MB = 1048576;</span><br><span class="line">    private static final String TAG = &quot;hotPanel.DeviceUtil&quot;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™å°±æ˜¯kotlinä¸­constå…³é”®å­—çš„æœ¬è´¨ã€‚<br><a href="https://blog.csdn.net/ilovewqf/article/details/78826373" target="_blank" rel="noopener">åŸæ–‡ç‚¹å‡»</a></p>
<h2 id="é™æ€å†…éƒ¨ç±»ï¼Œå¸¸é‡ï¼Œä¸‰å…ƒè¿ç®—ç¬¦"><a href="#é™æ€å†…éƒ¨ç±»ï¼Œå¸¸é‡ï¼Œä¸‰å…ƒè¿ç®—ç¬¦" class="headerlink" title="é™æ€å†…éƒ¨ç±»ï¼Œå¸¸é‡ï¼Œä¸‰å…ƒè¿ç®—ç¬¦"></a>é™æ€å†…éƒ¨ç±»ï¼Œå¸¸é‡ï¼Œä¸‰å…ƒè¿ç®—ç¬¦</h2><p>é™æ€å†…éƒ¨å˜é‡å’Œå¸¸é‡å®šä¹‰æ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">companion object &#123;</span><br><span class="line">        private const val MSG_UPDATE_PROGRESS = 1</span><br><span class="line">        private const val MSG_UPDATE_TIME= 1000</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>


<p>é™æ€å†…éƒ¨ç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Parent&#123;</span><br><span class="line">    class Child //é»˜è®¤å°±æ˜¯ javaçš„ public static</span><br><span class="line">&#125;</span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    val inner = Parent.Child()</span><br><span class="line"> </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éé™æ€å†…éƒ¨ç±»</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">class Parent&#123;</span><br><span class="line">    //éé™æ€å†…éƒ¨ç±»å£°æ˜</span><br><span class="line">    inner class Child</span><br><span class="line">&#125;</span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    val inner = Parent().Child()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å†…éƒ¨ç±»è®¿é—®å¤–éƒ¨æŒæœ‰ç±»çš„this</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">class Parent&#123;</span><br><span class="line">    val a:Int = 0</span><br><span class="line">    inner class Child&#123;</span><br><span class="line">        val a:Int = 5</span><br><span class="line">        fun hello()&#123;</span><br><span class="line">            println(this@Parent.a)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    val inner = Parent().Child()</span><br><span class="line">    inner.hello()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä¸‰å…ƒè¿ç®—ç¬¦</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> //Javaå†™æ³•</span><br><span class="line">int size=list!=null?list.size:0</span><br><span class="line">//kotlinå†™æ³•</span><br><span class="line">val size=if(list!=null) list.size() else 0</span><br></pre></td></tr></table></figure>

<p><a href="https://blog.csdn.net/weixin_34032621/article/details/86817626" target="_blank" rel="noopener">åŸæ–‡ç‚¹å‡»</a></p>
<h2 id="readLineèµ‹å€¼ä¸ºç©º"><a href="#readLineèµ‹å€¼ä¸ºç©º" class="headerlink" title="readLineèµ‹å€¼ä¸ºç©º"></a>readLineèµ‹å€¼ä¸ºç©º</h2><p>Javaä¸­æœ‰ä¸€ä¸ªåˆ¤æ–­æ˜¯ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ifï¼ˆï¼ˆstr=bufferedReader.readLine()ï¼‰!= nullï¼‰</span><br></pre></td></tr></table></figure>

<p>è¿™å¥è¯åˆ°äº†kotlinè½¬ä¸è¿‡æ¥,javaç»è¿‡å¼ºåˆ¶è½¬æ¢æˆkotlinï¼Œå¯èƒ½æœ€åˆæˆ‘ä»¬æ˜¯è¿™ä¹ˆå†™çš„ </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">var str=bufferedReader.readLine() </span><br><span class="line">while(str != null)&#123; </span><br><span class="line">æ‰§è¡Œä»£ç  </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¯æ˜¯å‡ºoomäº†ï¼Œé—®é¢˜åœ¨å“ªå‘¢ï¼Ÿä¸è¯´äº†ã€‚æœ€å</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">var line: String</span><br><span class="line">while (true) &#123;</span><br><span class="line">    line = bufferedReader.readLine() ?: break</span><br><span class="line">    buffer.append(line)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å±æ€§"><a href="#å±æ€§" class="headerlink" title="å±æ€§"></a>å±æ€§</h2><p>val:valå±æ€§åªæä¾›getter</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val usbState: UsbState</span><br><span class="line">    get() = sUsbState.copy()</span><br><span class="line">ç¼–è¯‘åçš„ï¼š</span><br><span class="line">@NotNull</span><br><span class="line">public final UsbState getUsbState() &#123;</span><br><span class="line">    return UsbMonitor.sUsbState.copy();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>varï¼šé»˜è®¤ç”Ÿæˆgetterï¼Œsetteræ–¹æ³•</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">var usbConnected: Boolean = false</span><br><span class="line">public final boolean getUsbConnected() &#123;</span><br><span class="line">    return this.usbConnected;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public final void setUsbConnected(boolean &lt;set-?&gt;) &#123;</span><br><span class="line">    this.usbConnected = &lt;set-?&gt;;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¯¹è±¡è¡¨è¾¾å¼-amp-amp-å¯¹è±¡å£°æ˜-amp-amp-ä¼´ç”Ÿå¯¹è±¡"><a href="#å¯¹è±¡è¡¨è¾¾å¼-amp-amp-å¯¹è±¡å£°æ˜-amp-amp-ä¼´ç”Ÿå¯¹è±¡" class="headerlink" title="å¯¹è±¡è¡¨è¾¾å¼ &amp;&amp; å¯¹è±¡å£°æ˜ &amp;&amp; ä¼´ç”Ÿå¯¹è±¡"></a>å¯¹è±¡è¡¨è¾¾å¼ &amp;&amp; å¯¹è±¡å£°æ˜ &amp;&amp; ä¼´ç”Ÿå¯¹è±¡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line">var btn: Button = findViewById(R.id.btn)</span><br><span class="line">// å¯¹è±¡è¡¨è¾¾å¼å®ç°åŒ¿åå†…éƒ¨ç±»</span><br><span class="line">btn.setOnClickListener(object: View.OnClickListener &#123;</span><br><span class="line">    override fun onClick(v: View?) &#123;</span><br><span class="line">        text.setText(&quot;$&#123;text.text&#125; $&#123;++clickTime&#125;&quot;)</span><br><span class="line">    &#125;</span><br><span class="line">&#125;)</span><br><span class="line">// OnClickListeneræ˜¯å‡½æ•°å¼æ¥å£ï¼Œå¯ä½¿ç”¨Lambdaè¡¨è¾¾å¼</span><br><span class="line">btn.setOnClickListener &#123; view -&gt;</span><br><span class="line">    text.setText(&quot;$&#123;text.text&#125; $&#123;++clickTime&#125;&quot;)</span><br><span class="line">&#125;</span><br><span class="line">// å¯¹è±¡å£°æ˜---å•ä¾‹</span><br><span class="line">object FoodManager &#123;</span><br><span class="line">    var foods: MutableList&lt;String&gt;</span><br><span class="line">    init&#123;</span><br><span class="line">        foods = mutableListOf&lt;String&gt;()</span><br><span class="line">        // åˆå§‹åŒ–é£Ÿç‰©æ± </span><br><span class="line">        for (i in 1..9) &#123;</span><br><span class="line">            foods.add(&quot;food$&#123;i&#125;&quot;)</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">var foods = FoodManager.foods // ä½¿ç”¨å¯¹è±¡å£°æ˜</span><br><span class="line">// ä¼´ç”Ÿå¯¹è±¡---é™æ€æˆå‘˜</span><br><span class="line">interface Outputable&#123;</span><br><span class="line">    fun output(msg: String)</span><br><span class="line">&#125;</span><br><span class="line">class MyClass&#123;</span><br><span class="line">    // å®šä¹‰çš„MyClassçš„ä¼´ç”Ÿå¯¹è±¡</span><br><span class="line">    companion object: Outputable&#123;</span><br><span class="line">        val name = â€nameå±æ€§å€¼â€ </span><br><span class="line">        </span><br><span class="line">        //é‡å†™çˆ¶æ¥å£ä¸­çš„æŠ½è±¡æ–¹æ³•</span><br><span class="line">        override fun output(msg: String) &#123;</span><br><span class="line">            for(i in 1..6)&#123;</span><br><span class="line">                println (â€&lt;h$(i&#125;&gt;$&#123; msg&#125;&lt;/h$&#123;i&#125;&gt;â€)</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">fun main(args: Array&lt;String&gt;) &#123;</span><br><span class="line">    // è°ƒç”¨ä¼´ç”Ÿå¯¹è±¡é‡Œçš„æ–¹æ³•ä¸å±æ€§ï¼Œä¸è°ƒç”¨é™æ€æˆå‘˜ä¸€æ ·</span><br><span class="line">    MyClass.output(&quot;fkit.org&quot;)</span><br><span class="line">    println(MyClass.name)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="å¯¹è±¡å£°æ˜å®šä¹‰å¸¸é‡"><a href="#å¯¹è±¡å£°æ˜å®šä¹‰å¸¸é‡" class="headerlink" title="å¯¹è±¡å£°æ˜å®šä¹‰å¸¸é‡"></a>å¯¹è±¡å£°æ˜å®šä¹‰å¸¸é‡</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">object NetUtils &#123;</span><br><span class="line"> /**</span><br><span class="line">     * ç§»åŠ¨</span><br><span class="line">     */</span><br><span class="line">    const val PROVIDER_TYPE_MOVE = 1</span><br><span class="line">    /**</span><br><span class="line">     * è”é€š</span><br><span class="line">     */</span><br><span class="line">    const val PROVIDER_TYPE_UNICOM = 2</span><br><span class="line">    /**</span><br><span class="line">     * ç”µä¿¡</span><br><span class="line">     */</span><br><span class="line">    const val PROVIDER_TYPE_TELECOM = 3</span><br><span class="line"></span><br><span class="line">    val NET_TYPE_MOVE = &quot;10086&quot;</span><br><span class="line">    val NET_TYPE_UNICOM = &quot;10010&quot;</span><br><span class="line">    val NET_TYPE_TELECOM = &quot;10001&quot;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ç”±äºå¯¹è±¡å£°æ˜å®šä¹‰çš„æ•°æ®å•ä¾‹ï¼Œæ‰€ä»¥ä¸€èˆ¬è°ƒç”¨(.java)éƒ½ä¼šç”¨Class.INSTANCE.getXXXXï¼Œ(kotlin)ä¼šç”¨Class.XXXXï¼Œä½†æ˜¯å¦‚æœå¯¹è±¡ä¸­å£°æ˜çš„æ˜¯constå¸¸é‡ï¼Œåˆ™åªèƒ½ç”¨Class.XXXXè°ƒç”¨ã€‚<br>ä¸¾ä¾‹è¯´æ˜ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">switch (NetUtils.INSTANCE.providerType(WxVersions.CURRENT_APPLICATION)) &#123;</span><br><span class="line">            case NetUtils.PROVIDER_TYPE_MOVE:</span><br><span class="line">                destinationAddress = NetUtils.INSTANCE.getNET_TYPE_MOVE();</span><br><span class="line">                break;</span><br><span class="line">            case NetUtils.PROVIDER_TYPE_UNICOM:</span><br><span class="line">                destinationAddress = NetUtils.INSTANCE.getNET_TYPE_UNICOM();</span><br><span class="line">                break;</span><br><span class="line">            case NetUtils.PROVIDER_TYPE_TELECOM:</span><br><span class="line">                destinationAddress = NetUtils.INSTANCE.getNET_TYPE_TELECOM();</span><br><span class="line">                break;</span><br><span class="line">            default:</span><br><span class="line">                destinationAddress = null;</span><br><span class="line">                break;</span><br><span class="line">        &#125;</span><br></pre></td></tr></table></figure>

<p>åç¼–è¯‘åçš„NetUtils</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">public final class NetUtils &#123;</span><br><span class="line">    public static final NetUtils INSTANCE = new NetUtils();</span><br><span class="line">    @NotNull</span><br><span class="line">    private static final String NET_TYPE_MOVE = NET_TYPE_MOVE;</span><br><span class="line">    @NotNull</span><br><span class="line">    private static final String NET_TYPE_TELECOM = NET_TYPE_TELECOM;</span><br><span class="line">    @NotNull</span><br><span class="line">    private static final String NET_TYPE_UNICOM = NET_TYPE_UNICOM;</span><br><span class="line">    public static final int PROVIDER_TYPE_MOVE = 1;</span><br><span class="line">    public static final int PROVIDER_TYPE_TELECOM = 3;</span><br><span class="line">    public static final int PROVIDER_TYPE_UNICOM = 2;</span><br><span class="line"></span><br><span class="line">    private NetUtils() &#123;</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>å¦‚æœå®šä¹‰çš„å¸¸é‡æ²¡æœ‰åŠ constï¼Œåˆ™åœ¨è°ƒç”¨çš„æ—¶å€™è¦ç”¨Class.INSTANCE.getXXXXï¼Œä½†æ˜¯ï¼Œè¿™ä¸ªæ—¶å€™switchï¼Œä¼šæŠ¥constant expression requierdå¼‚å¸¸ã€‚</p>
<p><strong>æ³¨æ„ï¼šä¼´ç”Ÿå¯¹è±¡å¸¸é‡å®šä¹‰æ–¹å¼ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">class MicroMsg &#123;</span><br><span class="line">	companion object &#123;</span><br><span class="line">		val DB_NAME = &quot;EnMicroMsg.db&quot;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">è€Œä¸‹é¢è¿™æ ·å†™æ³•æ‹¿ä¸åˆ°DB_NAME</span><br><span class="line">class MicroMsg &#123;</span><br><span class="line">	val DB_NAME = &quot;EnMicroMsg.db&quot;</span><br><span class="line">	companion object &#123;</span><br><span class="line">		</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>ä¼´ç”Ÿå¯¹è±¡å¦‚ä½•ç”Ÿæˆpublic static final</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">class MicroMsg &#123;</span><br><span class="line">	companion object &#123;</span><br><span class="line">		 val TYPE_IMG = 1</span><br><span class="line">        val TYPE_FILE = 2</span><br><span class="line">        const val TYPE_VOICE = 3</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line">åç¼–è¯‘å</span><br><span class="line">private static final int TYPE_FILE = 2;</span><br><span class="line">private static final int TYPE_IMG = 1;</span><br><span class="line">public static final int TYPE_VOICE = 3;</span><br></pre></td></tr></table></figure>

<h2 id="constructoræ„é€ å™¨"><a href="#constructoræ„é€ å™¨" class="headerlink" title="constructoræ„é€ å™¨"></a>constructoræ„é€ å™¨</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">1.ä¸»æ„é€ å™¨</span><br><span class="line">class MultiTask&lt;TaskData, Result&gt; constructor(private val mTaskItem: TaskItem, private val mRequest: TaskData, private val mTaskCount: Int, private val mDelay: Long = 500) </span><br><span class="line"></span><br><span class="line">2.ä¸»æ„é€ å™¨å¯ä»¥çœç•¥constructor</span><br><span class="line">class MultiTask&lt;TaskData, Result&gt; (private val mTaskItem: TaskItem, private val mRequest: TaskData, private val mTaskCount: Int, private val mDelay: Long = 500) </span><br><span class="line"></span><br><span class="line">3.ä¸»æ„é€ å™¨å¦‚æœæœ‰@JvmOverloadsåˆ™ä¸å¯ä»¥çœç•¥constructor</span><br><span class="line">class MultiTask&lt;TaskData, Result&gt; @JvmOverloads constructor(private val mTaskItem: TaskItem, private val mRequest: TaskData, private val mTaskCount: Int, private val mDelay: Long = 500) </span><br><span class="line"></span><br><span class="line">4.ä½¿ç”¨@JvmOverloadsæ³¨è§£çš„ä¸»æ„é€ å™¨ï¼Œä¸å¯ä»¥å†æœ‰æ¬¡æ„é€ å™¨</span><br><span class="line">	constructor(taskItem: TaskItem,mRequest: TaskData,mTaskCount: Int): this(taskItem, mRequest,mTaskCount,300) &#123;</span><br><span class="line">&#125;</span><br><span class="line">å¼‚å¸¸ï¼Œhava the same JVM signature.</span><br></pre></td></tr></table></figure>

<p><strong>æ„é€ å™¨å‡ ç§ä½¿ç”¨ï¼š</strong></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line">ç©ºæ„é€ å™¨</span><br><span class="line">class OuterConstructor&#123;&#125;</span><br><span class="line"></span><br><span class="line">ç§æœ‰æ„é€ å™¨</span><br><span class="line">class OuterConstructor private constructor(str:String, ins:Int)&#123;&#125;</span><br><span class="line"></span><br><span class="line">ç§æœ‰æ„é€ å™¨+æ¬¡æ„é€ å™¨ï¼ˆå¯è°ƒï¼‰</span><br><span class="line">class OuterConstructor private constructor(str:String, ins:Int)&#123;</span><br><span class="line">    var s1 = &quot;123&quot;</span><br><span class="line">    init&#123;</span><br><span class="line">        this.s1 = str</span><br><span class="line">    &#125;</span><br><span class="line">    constructor(str:String):this(str,8)</span><br><span class="line">&#125;</span><br><span class="line">ä¸»æ„é€ å™¨</span><br><span class="line">class OuterConstructor constructor(str:String, ins:Int)&#123;</span><br><span class="line">    var s1 = &quot;123&quot;</span><br><span class="line">    init&#123;</span><br><span class="line">        this.s1 = str</span><br><span class="line">    &#125;</span><br><span class="line">    constructor(str:String):this(str,8)</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">ä¸»æ„é€ å™¨çœç•¥åˆå§‹åŒ–init</span><br><span class="line">class OuterConstructor &#123;</span><br><span class="line">    var s1 = &quot;123&quot;</span><br><span class="line">    init&#123;</span><br><span class="line">        this.s1 = &quot;qdf&quot;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line">ä¸»æ„é€ å™¨åˆå§‹åŒ–init</span><br><span class="line">class OuterConstructor constructor(str:String, ins:Int)&#123;</span><br><span class="line">    var s1 = &quot;123&quot;</span><br><span class="line">    init&#123;</span><br><span class="line">        this.s1 = str</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h3 id="JvmOverloadsä½œç”¨"><a href="#JvmOverloadsä½œç”¨" class="headerlink" title="@JvmOverloadsä½œç”¨"></a>@JvmOverloadsä½œç”¨</h3><p>åœ¨æœ‰é»˜è®¤å‚æ•°å€¼çš„æ–¹æ³•ä¸­ä½¿ç”¨@JvmOverloadsæ³¨è§£ï¼Œåˆ™Kotlinå°±ä¼šæš´éœ²å¤šä¸ªé‡è½½æ–¹æ³•ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">@JvmOverloads fun f(a: String, b: Int=0, c:String=&quot;abc&quot;)&#123;</span><br><span class="line">&#125;</span><br><span class="line">åç¼–è¯‘åï¼š</span><br><span class="line">void f(String a)</span><br><span class="line">void f(String a, int b)</span><br><span class="line">void f(String a, int b, String c)</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥@JvmOverloadsä¸ä»…ä»…ç”¨äºæ„é€ æ–¹æ³•ã€‚</p>
<h3 id="constructorä¸­å‚æ•°æŒ‡å®šval-varå’Œæ²¡æœ‰åˆ¶å®šçš„åŒºåˆ«"><a href="#constructorä¸­å‚æ•°æŒ‡å®šval-varå’Œæ²¡æœ‰åˆ¶å®šçš„åŒºåˆ«" class="headerlink" title="constructorä¸­å‚æ•°æŒ‡å®šval,varå’Œæ²¡æœ‰åˆ¶å®šçš„åŒºåˆ«"></a>constructorä¸­å‚æ•°æŒ‡å®šval,varå’Œæ²¡æœ‰åˆ¶å®šçš„åŒºåˆ«</h3><h4 id="ä¸æŒ‡å®š"><a href="#ä¸æŒ‡å®š" class="headerlink" title="ä¸æŒ‡å®š"></a>ä¸æŒ‡å®š</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">class OuterConstructor constructor(mHookConfig: HookConfig) </span><br><span class="line">åç¼–è¯‘å</span><br><span class="line">public AvatarServiceImplKT(@NotNull HookConfig mHookConfig) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="val"><a href="#val" class="headerlink" title="val"></a>val</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class OuterConstructor constructor(val mHookConfig: HookConfig) </span><br><span class="line">åç¼–è¯‘å</span><br><span class="line">private final HookConfig mHookConfig;</span><br><span class="line">public AvatarServiceImplKT(@NotNull HookConfig mHookConfig) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h4 id="var"><a href="#var" class="headerlink" title="var"></a>var</h4><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">class OuterConstructor constructor(var mHookConfig: HookConfig) </span><br><span class="line">åç¼–è¯‘å</span><br><span class="line">private HookConfig mHookConfig;</span><br><span class="line">public AvatarServiceImplKT(@NotNull HookConfig mHookConfig) &#123;&#125;</span><br></pre></td></tr></table></figure>

<h2 id="varargå¯å˜å‚æ•°"><a href="#varargå¯å˜å‚æ•°" class="headerlink" title="varargå¯å˜å‚æ•°"></a>varargå¯å˜å‚æ•°</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">fun print(vararg msgs: String) &#123;</span><br><span class="line">    for (msg in msgs) &#123;</span><br><span class="line">    	println(msg)</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">fun LogPrinters()&#123;</span><br><span class="line">	print(&quot;11&quot;,&quot;22&quot;,&quot;33&quot;,&quot;44&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯å¦‚æœæ˜¯ä¸‹é¢è¿™æ ·è°ƒç”¨æ˜¯ä¸å¯ä»¥çš„ï¼Œä¼šæŠ¥å‚æ•°åŒ¹é…å¼‚å¸¸ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val array = arrayOf(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;, &quot;d&quot;)</span><br><span class="line">print(array)</span><br></pre></td></tr></table></figure>

<p>å¦‚æœæƒ³è°ƒç”¨ï¼Œéœ€è¦ä½¿ç”¨*æ“ä½œç¬¦ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">print(*array)</span><br></pre></td></tr></table></figure>

<p>æ‰€ä»¥æˆ‘ä»¬è°ƒç”¨å¸¦æœ‰å¯å˜å‚æ•°çš„æ–¹æ³•æ—¶ï¼Œåªèƒ½ä¼ é€’ç¦»æ•£çš„å‚æ•°å€¼ï¼Œç›´æ¥ä¼ é€’æ•°ç»„ä¼šæŠ¥è¯­æ³•é”™è¯¯ã€‚ä½†æ˜¯å½“æˆ‘ä»¬æ‰‹å¤´ä¸Šå°±æ˜¯ä¸€ä¸ªæ•°ç»„ï¼Œè¦æƒ³ä¼ é€’ï¼Œå°±éœ€è¦å€ŸåŠ©è¿ç®—ç¬¦*(spread operator)ï¼šç›¸å½“äºå°†æ•°ç»„åˆ†æ•£æˆä¸€ä¸ªä¸ªçš„ä¸ªä½“å†ä¼ å…¥è¿›å»ã€‚</p>
<h2 id="var-get-set-xxx-æ–¹æ³•"><a href="#var-get-set-xxx-æ–¹æ³•" class="headerlink" title="var get() set(xxx)æ–¹æ³•"></a>var get() set(xxx)æ–¹æ³•</h2><p>1.</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">override var name: String=&quot;ninhao&quot;</span><br><span class="line">	get() = field</span><br><span class="line">	set(value) &#123;</span><br><span class="line">		field=value</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">XLog.e(&quot;------name1:&quot;,name)</span><br><span class="line">name = &quot;henhao&quot;</span><br><span class="line">XLog.e(&quot;------name2:&quot;,name)</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ninhao</span><br><span class="line">henhao</span><br></pre></td></tr></table></figure>

<p>æ³¨æ„ï¼švar name: String=â€ninhaoâ€ï¼Œå¿…é¡»åˆå§‹åŒ–ã€‚<br>2.å¯ä»¥é€šè¿‡fun get() å’Œfun set(XXX)å®ç°ã€‚</p>
<p>3.<br>é”™è¯¯å†™æ³•ï¼šæ­»å¾ªç¯</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">var name: String</span><br><span class="line">	get() = name</span><br><span class="line">	set(value) &#123;</span><br><span class="line">	name=&quot;afff&quot;</span><br><span class="line">&#125;</span><br><span class="line">åç¼–è¯‘å</span><br><span class="line"></span><br><span class="line">@NotNull</span><br><span class="line">public String getName() &#123;</span><br><span class="line">    return getName();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">public void setName(@NotNull String value) &#123;</span><br><span class="line">    Intrinsics.checkParameterIsNotNull(value, UserInfo.COLUMN_value);</span><br><span class="line">    setName(&quot;afff&quot;);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><a href="https://www.runoob.com/kotlin/kotlin-class-object.html" target="_blank" rel="noopener">è¯¦ç»†æ³¨è§£é“¾æ¥</a></p>
<h2 id="split"><a href="#split" class="headerlink" title="split"></a>split</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">var sb = StringBuilder()</span><br><span class="line">sb.append(&quot;111,&quot;).append(&quot;222,&quot;).append(&quot;333,&quot;).append(&quot;,&quot;).append(&quot;aaa,&quot;).append(&quot;bbb,&quot;).append(&quot;ccc,&quot;).append(&quot;&quot;)</span><br><span class="line">val strs = sb.toString()</span><br><span class="line">val splits = strs.split(&quot;,&quot;.toRegex()).dropWhile &#123; !it.isEmpty() &#125;.toTypedArray()</span><br><span class="line">for(str in splits)&#123;</span><br><span class="line">	XLog.e(&quot;-------split:&quot;,str)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>1.<strong>dropWhile</strong> è¿”å›ä»ç¬¬ä¸€é¡¹èµ·ï¼Œå»æ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œç›´åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ä¸€é¡¹ä¸ºæ­¢ï¼›<br>it.isEmpty():</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[-------split:][main]</span><br><span class="line">[-------split:][main]aaa</span><br><span class="line">[-------split:][main]bbb</span><br><span class="line">[-------split:][main]ccc</span><br><span class="line">[-------split:][main]</span><br></pre></td></tr></table></figure>

<p>!it.isEmpty():</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[-------split:][main]111</span><br><span class="line">[-------split:][main]222</span><br><span class="line">[-------split:][main]333</span><br><span class="line">[-------split:][main]</span><br><span class="line">[-------split:][main]aaa</span><br><span class="line">[-------split:][main]bbb</span><br><span class="line">[-------split:][main]ccc</span><br><span class="line">[-------split:][main]</span><br></pre></td></tr></table></figure>

<p>2.<strong>dropLastWhile</strong> è¿”å›ä»æœ€åä¸€é¡¹èµ·ï¼Œå»æ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼Œç›´åˆ°ä¸æ»¡è¶³æ¡ä»¶çš„ä¸€é¡¹ä¸ºæ­¢ï¼›<br>it.isEmpty():</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[-------split:][main]111</span><br><span class="line">[-------split:][main]222</span><br><span class="line">[-------split:][main]333</span><br><span class="line">[-------split:][main]</span><br><span class="line">[-------split:][main]aaa</span><br><span class="line">[-------split:][main]bbb</span><br><span class="line">[-------split:][main]ccc</span><br></pre></td></tr></table></figure>

<p>!it.isEmpty():</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">[-------split:][main]111</span><br><span class="line">[-------split:][main]222</span><br><span class="line">[-------split:][main]333</span><br><span class="line">[-------split:][main]</span><br><span class="line">[-------split:][main]aaa</span><br><span class="line">[-------split:][main]bbb</span><br><span class="line">[-------split:][main]ccc</span><br><span class="line">[-------split:][main]</span><br></pre></td></tr></table></figure>

<p>3.<strong>drop</strong> è¿”å›å»æ‰å‰nä¸ªå…ƒç´ åçš„åˆ—è¡¨ï¼›<br>drop(4)</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">[-------split:][main]aaa</span><br><span class="line">[-------split:][main]bbb</span><br><span class="line">[-------split:][main]ccc</span><br><span class="line">[-------split:][main]</span><br></pre></td></tr></table></figure>

<p>4.<strong>filter &amp; slice &amp; take</strong></p>
<p>filterâ€“è¿‡æ»¤æ‰æ‰€æœ‰ä¸æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼›<br>filterNotâ€“è¿‡æ»¤æ‰æ‰€æœ‰æ»¡è¶³æ¡ä»¶çš„å…ƒç´ ï¼›<br>filterNotNullâ€“è¿‡æ»¤æ‰æ‰€æœ‰å€¼ä¸ºnullçš„å…ƒç´ ï¼›</p>
<p>sliceâ€“è¿‡æ»¤æ‰éæŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼Œå³ä¿ç•™ä¸‹æ ‡å¯¹åº”çš„å…ƒç´ è¿‡æ»¤Listä¸­æŒ‡å®šä¸‹æ ‡çš„å…ƒç´ ï¼ˆæ¯”å¦‚è¿™é‡Œåªä¿ç•™ä¸‹æ ‡ä¸º1ï¼Œ3ï¼Œ4çš„å…ƒç´ ï¼‰ï¼Œå½“è¿‡æ»¤listä¸­æœ‰å…ƒç´ å€¼å¤§äºç›®æ ‡Listå¤§å°æ—¶ä¼šå‡ºç°å¼‚å¸¸ï¼›</p>
<p>takeâ€“è¿”å›ä»ç¬¬ä¸€ä¸ªå¼€å§‹çš„nä¸ªå…ƒç´ ï¼›<br>takeLastâ€“è¿”å›ä»æœ€åä¸€ä¸ªå¼€å§‹çš„nä¸ªå…ƒç´ ï¼›<br>takeWhileâ€“è¿”å›ä¸æ»¡è¶³æ¡ä»¶çš„ä¸‹æ ‡å‰é¢çš„æ‰€æœ‰å…ƒç´ çš„é›†åˆï¼›</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">filter &#123; !it.isEmpty() &#125;</span><br><span class="line"></span><br><span class="line">[-------split:][main]111</span><br><span class="line">[-------split:][main]222</span><br><span class="line">[-------split:][main]333</span><br><span class="line">[-------split:][main]aaa</span><br><span class="line">[-------split:][main]bbb</span><br><span class="line">[-------split:][main]ccc</span><br></pre></td></tr></table></figure>

<p><a href="https://www.cnblogs.com/tgyf/p/6892551.html?utm_source=itdadao&utm_medium=referral" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥ç‚¹å‡»</a></p>
<h2 id="æ˜¾å¼è½¬æ¢-amp-å¼ºåˆ¶è½¬æ¢"><a href="#æ˜¾å¼è½¬æ¢-amp-å¼ºåˆ¶è½¬æ¢" class="headerlink" title="æ˜¾å¼è½¬æ¢&amp;å¼ºåˆ¶è½¬æ¢"></a>æ˜¾å¼è½¬æ¢&amp;å¼ºåˆ¶è½¬æ¢</h2><p>æ¯ä¸ªæ•°å­—ç±»å‹æ”¯æŒå¦‚ä¸‹çš„è½¬æ¢:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">&gt; toByte(): Byte</span><br><span class="line">&gt; toShort(): Short</span><br><span class="line">&gt; toInt(): Int</span><br><span class="line">&gt; toLong(): Long</span><br><span class="line">&gt; toFloat(): Float</span><br><span class="line">&gt; toDouble(): Double</span><br><span class="line">&gt; toChar(): Char</span><br></pre></td></tr></table></figure>

<p>å¼ºåˆ¶è½¬æ¢<br>xxx as ç±»ï¼šå¼ºåˆ¶è½¬æ¢ï¼Œå¯èƒ½å´©æºƒ</p>
<p>xxx as? ç±»ï¼šå®‰å…¨çš„å¼ºåˆ¶è½¬æ¢ï¼Œè½¬æ¢å¤±è´¥è¿”å›null</p>
<p><strong>æ³¨æ„ï¼šæ•°å­—ç±»å‹çš„è½¬æ¢ä¹Ÿå¯ä»¥ä½¿ç”¨as ï¼Œç¼–è¯‘æ—¶ä¸æŠ¥é”™ï¼Œä½†è¿è¡Œæ—¶ä¼šæŠ¥é”™ã€‚</strong></p>
<h2 id="Lambda-argument-should-be-moved-out-of-parentheses"><a href="#Lambda-argument-should-be-moved-out-of-parentheses" class="headerlink" title="Lambda argument should be moved out of parentheses"></a>Lambda argument should be moved out of parentheses</h2><p>è§£å†³æ–¹å¼ï¼šoption+enterï¼›</p>
<h2 id="return-æ ‡ç­¾"><a href="#return-æ ‡ç­¾" class="headerlink" title="return@æ ‡ç­¾"></a>return@æ ‡ç­¾</h2><p>è·³è½¬åˆ°æŒ‡å®šçš„ä½ç½®ï¼Œæ ‡ç­¾çš„å†™æ³•å¾ˆç®€å•ï¼Œåªéœ€è¦åå­—ä¹‹ååŠ @ç¬¦å·ï¼Œè¦ç”¨çš„æ—¶å€™@åå­—å°±å¥½ï¼Œä¸€èˆ¬åœ¨lambdaè¡¨è¾¾å¼ä¸­å¯èƒ½ä¼šç”¨åˆ°ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">fun print(vararg msgs: String) &#123;</span><br><span class="line">        Async.io &#123;</span><br><span class="line">            for (msg in msgs) &#123;</span><br><span class="line">                XLog.e(&quot;-------print:&quot;,msg)</span><br><span class="line">            &#125;</span><br><span class="line">            return@io</span><br><span class="line">            XLog.e(&quot;-------print:&quot;,&quot;8&quot;)</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        XLog.e(&quot;-------print:&quot;,&quot;9&quot;)</span><br><span class="line">    &#125;</span><br></pre></td></tr></table></figure>

<p>è¾“å‡º</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">[-------print:][main]9</span><br><span class="line">[-------print:][IOExecutor#1]a</span><br><span class="line">[-------print:][IOExecutor#1]b</span><br><span class="line">[-------print:][IOExecutor#1]c</span><br><span class="line">[-------print:][IOExecutor#1]d</span><br></pre></td></tr></table></figure>

<h2 id="forå¾ªç¯ä½¿ç”¨æ–¹æ³•"><a href="#forå¾ªç¯ä½¿ç”¨æ–¹æ³•" class="headerlink" title="forå¾ªç¯ä½¿ç”¨æ–¹æ³•"></a>forå¾ªç¯ä½¿ç”¨æ–¹æ³•</h2><p>åœ¨Kotlinä¸­æƒ³éå†1-100çš„æ•°å€¼å¯ä»¥è¿™æ ·å†™ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (index in 1..10)&#123;</span><br><span class="line">	print(index)//ä¼šè¾“å‡º1..10</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™æ ·å†™æ˜¯æ­£åºéå†ï¼Œå¦‚æœæƒ³å€’åºéå†å°±è¯¥ä½¿ç”¨æ ‡å‡†åº“ä¸­å®šä¹‰çš„downTo()å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (index in 10 downTo 1)&#123;</span><br><span class="line">	print(index)//ä¼šè¾“å‡º10..1</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>æƒ³ä¸ä½¿ç”¨1ä½œä¸ºéå†çš„æ­¥é•¿ï¼Œå¯ä»¥ä½¿ç”¨step()å‡½æ•°ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (index in 1..100 step 2)&#123;</span><br><span class="line">	print(index)//ä¼šè¾“å‡º1..3..5......</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¦åˆ›å»ºä¸€ä¸ªä¸åŒ…å«æœ«å°¾å…ƒç´ çš„åŒºé—´ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">for (index in 1 until 10)&#123;</span><br><span class="line">	println(index)//è¾“å‡º1..9</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éå†ä¸€ä¸ªæ•°ç»„/åˆ—è¡¨ï¼Œæƒ³åŒæ—¶å–å‡ºä¸‹æ ‡å’Œå…ƒç´ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val array = arrayOf(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span><br><span class="line">for ((index,e) in array.withIndex())&#123;</span><br><span class="line">	println(&quot;ä¸‹æ ‡=$index----å…ƒç´ =$e&quot;)</span><br><span class="line">&#125;</span><br><span class="line">[-----index:][main]ä¸‹æ ‡=0----å…ƒç´ =a</span><br><span class="line">[-----index:][main]ä¸‹æ ‡=1----å…ƒç´ =b</span><br><span class="line">[-----index:][main]ä¸‹æ ‡=2----å…ƒç´ =c</span><br></pre></td></tr></table></figure>

<p>éå†ä¸€ä¸ªæ•°ç»„/åˆ—è¡¨ï¼Œåªå–å‡ºä¸‹æ ‡:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val array = arrayOf(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span><br><span class="line">for (index in array.indices)&#123;</span><br><span class="line">	println(&quot;index=$index&quot;)//è¾“å‡º0ï¼Œ1ï¼Œ2</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>éå†å–å…ƒç´ ï¼š</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">val array = arrayOf(&quot;a&quot;, &quot;b&quot;, &quot;c&quot;)</span><br><span class="line">for (element in array)&#123;</span><br><span class="line">	println(&quot;element=$element&quot;)//è¾“å‡ºa,b,c</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="class"><a href="#class" class="headerlink" title=".class"></a>.class</h2><p>Service::class.javaçš„è¯­æ³•å±•ç°äº†å¦‚ä½•è·å–java.lang.Classå¯¹åº”çš„Kotlinç±»ï¼Œè¿™å’ŒJavaä¸­çš„Service.Classæ˜¯å®Œå…¨ç­‰åŒçš„.</p>
<h2 id="javaé€šé…ç¬¦-amp-kotlinå£°æ˜å¤„å‹å˜"><a href="#javaé€šé…ç¬¦-amp-kotlinå£°æ˜å¤„å‹å˜" class="headerlink" title="javaé€šé…ç¬¦&amp;kotlinå£°æ˜å¤„å‹å˜"></a>javaé€šé…ç¬¦&amp;kotlinå£°æ˜å¤„å‹å˜</h2><h3 id="java"><a href="#java" class="headerlink" title="java"></a><strong>java</strong></h3> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">public static &lt;T&gt; void copy(List&lt;? super T&gt; dest, List&lt;? extends T&gt; src) &#123;</span><br><span class="line">      // æ ¡éªŒç•¥</span><br><span class="line">      ListIterator&lt;? super T&gt; di = dest.listIterator();</span><br><span class="line">      ListIterator&lt;? extends T&gt; si = src.listIterator();</span><br><span class="line">      while (si.hasNext()) &#123;</span><br><span class="line">          /**</span><br><span class="line">           * ç¼–è¯‘æ—¶å¼‚å¸¸</span><br><span class="line">           * Incompatible types.ä¸å…¼å®¹ç±»å‹ï¼›</span><br><span class="line">           * Required:T;</span><br><span class="line">           * Found:Capture&lt;? super T&gt;</span><br><span class="line">           */</span><br><span class="line">          T elementD =di.next();</span><br><span class="line"></span><br><span class="line">          T element = si.next(); //src extent ç”Ÿäº§è€… ä½œä¸ºæ–¹æ³•è¿”å›å€¼ç±»å‹æ˜¯å®‰å…¨çš„</span><br><span class="line">          di.set(element); // dest super æ¶ˆè´¹è€… ä½œä¸ºæ–¹æ³•å‚æ•°ç±»å‹æ˜¯å®‰å…¨çš„</span><br><span class="line"></span><br><span class="line">          /**</span><br><span class="line">           * ç¼–è¯‘æ—¶å¼‚å¸¸</span><br><span class="line">           * set(&lt;? extends T&gt;) in ListIterator cannot be applied.</span><br><span class="line">           * to (T)</span><br><span class="line">           */</span><br><span class="line">          si.set(elementD);</span><br><span class="line">      &#125;</span><br><span class="line">  &#125;</span><br></pre></td></tr></table></figure>

<h3 id="kotlin"><a href="#kotlin" class="headerlink" title="kotlin:"></a><strong>kotlin:</strong></h3> <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">abstract class Supplier&lt;out T&gt; &#123;</span><br><span class="line">       abstract fun get(): T</span><br><span class="line">       /**</span><br><span class="line">        * ç¼–è¯‘æœŸé”™è¯¯ï¼š</span><br><span class="line">        * Type parameter T is declared as &apos;out&apos; but occurs in &apos;in&apos; position in type T</span><br><span class="line">        */</span><br><span class="line">       abstract fun set(t: T)</span><br><span class="line">   &#125;</span><br><span class="line"></span><br><span class="line">   abstract class Customer&lt;in T&gt; &#123;</span><br><span class="line">       abstract fun set(t: T)</span><br><span class="line">       /**</span><br><span class="line">        * ç¼–è¯‘æœŸé”™è¯¯ï¼š</span><br><span class="line">        * Type parameter T is declared as &apos;in&apos; but occurs in &apos;out&apos; position in type T</span><br><span class="line">        */</span><br><span class="line">       abstract fun get(): T</span><br><span class="line">   &#125;</span><br></pre></td></tr></table></figure>

<h3 id="1-List-lt-extends-T-gt-åå˜ï¼š-out"><a href="#1-List-lt-extends-T-gt-åå˜ï¼š-out" class="headerlink" title="1.List&lt;? extends T&gt;åå˜ï¼š== out"></a>1.List&lt;? extends T&gt;åå˜ï¼š== out</h3><p> åœ¨si.set(elementD)ä¸­ï¼Œ elementDçš„ç±»å‹æ˜¯Tï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥setï¼ˆT tï¼‰ï¼Œä»¥åŠä¸€åˆ‡å‚æ•°ä¸­å«æœ‰ T çš„æ–¹æ³•ï¼ˆç§°ä¸ºæ¶ˆè´¹è€…æ–¹æ³•ï¼‰ï¼ŒTç±»å‹æˆ–è€…ä»Tç»§æ‰¿çš„ç±»å‹éƒ½å¯ä»¥è¢«setï¼Œä½†æ˜¯å› ä¸ºå¯ä»¥setä¸åŒçš„ç±»å‹ï¼Œæ‰€ä»¥è¿™äº›æ–¹æ³•å¯èƒ½ä¼šç ´åç±»å‹å®‰å…¨ï¼Œæ‰€ä»¥ç¼–è¯‘å™¨é™åˆ¶è¿™äº›æ–¹æ³•çš„è°ƒç”¨ã€‚</p>
<p> ä¸¾kotlinä¾‹è¯´æ˜ï¼š<br> æœ‰ä¸€æ–¹æ³•</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun generate(args : Array&lt;Any&gt;)&#123;</span><br><span class="line">//todo</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p> æˆ‘ä»¬è°ƒç”¨å®ƒï¼š</p>
 <figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">val args : Array&lt;String&gt; = arrayOf()</span><br><span class="line">generate(args)</span><br></pre></td></tr></table></figure>

<p> è¿™ä¸ªæ—¶å€™ä¼šæç¤ºå¼‚å¸¸ï¼ˆç±»å‹ä¸åŒ¹é…ï¼‰ï¼štype mismitchï¼Œä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬åªéœ€è¦ä¿®æ”¹ä¸€ä¸‹è°ƒç”¨æ–¹æ³•ï¼Œä½¿ç”¨å‹å˜outå³å¯ã€‚</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">fun generate(args : Array&lt;out Any&gt;)&#123;</span><br><span class="line"> //todo</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>



<h3 id="List-lt-super-T-gt-é€†å˜ï¼š-in"><a href="#List-lt-super-T-gt-é€†å˜ï¼š-in" class="headerlink" title="List&lt;? super T&gt;é€†å˜ï¼š== in"></a>List&lt;? super T&gt;é€†å˜ï¼š== in</h3><p> åŒåå˜æ­£å¥½ç›¸åï¼Œåœ¨T elementD =di.next();ä¸­ï¼Œå› ä¸ºdiçš„ç±»å‹æ˜¯&lt;? super T&gt;ï¼Œæ‰€ä»¥æˆ‘ä»¬é€šè¿‡di.next()è·å–çš„ç±»å‹å¯èƒ½T,ä¹Ÿå¯èƒ½æ˜¯ä»Tç»§æ‰¿çš„ç±»å‹ï¼Œä»è€Œæˆ‘ä»¬ä¸èƒ½ç¡®å®šnextçš„ç±»å‹ã€‚æ³¨æ„ï¼Œè¿™æ¬¡æ‹’ç»çš„ç†ç”±è·Ÿåå˜ä¸­æ˜¯ä¸ä¸€æ ·çš„ã€‚getæ–¹æ³•å¹¶ä¸ä¼šç ´åæ³›å‹ç±»çš„ç±»å‹å®‰å…¨ï¼Œä¸»è¦åŸå› åœ¨äºæˆ‘ä»¬ä¸èƒ½ç¡®å®šgetçš„è¿”å›ç±»å‹ã€‚<br> <a href="https://www.jianshu.com/p/0c2948f7e656" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥1</a><br> <a href="https://www.jianshu.com/p/ecacb7af79eb?from=timeline&isappinstalled=0" target="_blank" rel="noopener">å‚è€ƒé“¾æ¥2</a></p>
<h2 id="æ“ä½œç¬¦"><a href="#æ“ä½œç¬¦" class="headerlink" title="?: ?. !!æ“ä½œç¬¦"></a>?: ?. !!æ“ä½œç¬¦</h2><h3 id="If-not-null"><a href="#If-not-null" class="headerlink" title="?. == If not null"></a>?. == If not null</h3><p>?.å°±æ˜¯å½“å‰é¢çš„å˜é‡!= nuil æ—¶æ­£å¸¸è°ƒç”¨ï¼Œå¦‚æœä¸ºnullå°±ä¸ºnull;å¹¶ä¸”?.å¯ä»¥è¿ç»­ä½¿ç”¨ã€‚ä¾‹å¦‚user?.userName?.length</p>
<h3 id="npe"><a href="#npe" class="headerlink" title="!!! == npe"></a>!!! == npe</h3><p>!!,åŠ åœ¨å˜é‡ååï¼Œå°±æ˜¯å½“å˜é‡ä¸ºnullæ—¶ï¼ŒæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸;</p>
<h3 id="if-null"><a href="#if-null" class="headerlink" title="?: == if null"></a>?: == if null</h3><p>?: ä»…ä»…åœ¨å·¦è¾¹çš„è¡¨è¾¾å¼ç»“æœä¸ºnullæ—¶æ‰ä¼šè®¡ç®— ?: åé¢çš„è¡¨è¾¾å¼</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">val map = XXXXX ?: return</span><br><span class="line">ç­‰åŒäº</span><br><span class="line">val map = XXXXX</span><br><span class="line">if(map == null)&#123;</span><br><span class="line">	return</span><br><span class="line">&#125;</span><br><span class="line">ä½†æ˜¯ifä¼šæœ‰://Replace &apos;if&apos; with elvis operator</span><br></pre></td></tr></table></figure>

<h2 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString()"></a>toString()</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">/**</span><br><span class="line"> * Returns a string representation of the object. Can be called with a null receiver, in which case</span><br><span class="line"> * it returns the string &quot;null&quot;.</span><br><span class="line"> */</span><br><span class="line">public fun Any?.toString(): String</span><br></pre></td></tr></table></figure>

<p><strong>ç–‘é—®ç‚¹ï¼š</strong><br>null.toString()<br>åç¼–è¯‘<br>String.valueOf(null)</p>
<h2 id="Serializable"><a href="#Serializable" class="headerlink" title="Serializable"></a>Serializable</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">class XXXXKT:Serializable&#123;&#125;</span><br></pre></td></tr></table></figure>

<p>Cannot access â€˜Serializableâ€™:it is internal in â€˜kotlin.ioâ€™</p>
<p>è§£å†³ï¼šimport java.io.Serializable</p>
<h2 id="Suppress-â€œUNCHECKED-CASTâ€"><a href="#Suppress-â€œUNCHECKED-CASTâ€" class="headerlink" title="@Suppress(â€œUNCHECKED_CASTâ€)"></a>@Suppress(â€œUNCHECKED_CASTâ€)</h2><p>å½“ä½¿ç”¨ as Array<string>å¼ºè½¬æ—¶å¯èƒ½ä¼šå‡ºç°Unchecked cast: Any! to Array<any> è­¦å‘Šã€‚è§£å†³æ–¹æ³•å°±æ˜¯åœ¨å¼ºè½¬ä»£ç å‰åŠ @Suppress(â€œUNCHECKED_CASTâ€)ã€‚<br>å¤‡æ³¨ï¼š@SuppressWarnings(â€œuncheckedâ€)ä½¿ç”¨æ—¶æœºå‘¢ï¼Ÿ</any></string></p>
<h2 id="æ¥å£"><a href="#æ¥å£" class="headerlink" title="æ¥å£"></a>æ¥å£</h2><p><a href="https://www.jianshu.com/p/e6bbc00b18f6" target="_blank" rel="noopener">è¯¦ç»†ä½¿ç”¨ç‚¹å‡»</a></p>
<h2 id="å‚è€ƒèµ„æ–™"><a href="#å‚è€ƒèµ„æ–™" class="headerlink" title="å‚è€ƒèµ„æ–™"></a>å‚è€ƒèµ„æ–™</h2><p><a href="https://www.runoob.com/kotlin/kotlin-class-object.html" target="_blank" rel="noopener">Runoob</a></p>
<p><a href="https://www.kotlincn.net/docs/reference/basic-syntax.html" target="_blank" rel="noopener">kotlincn</a></p>
<p><a href="https://handsomeliuyang.github.io/2019/05/07/Kotlin%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" target="_blank" rel="noopener">Kotlinå­¦ä¹ ç¬”è®°</a></p>
]]></content>
      
        <categories>
            
            <category> Kotlin </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Android </tag>
            
            <tag> Kotlin </tag>
            
        </tags>
        
    </entry>
    
    <entry>
      <title><![CDATA[Hexo é…ç½®]]></title>
      <url>/2019/07/02/hello-world/</url>
      <content type="html"><![CDATA[<p>é€šè¿‡git+hexoæ­å»ºä¸ªäººåšå®¢</p>
<a id="more"></a>
<p>More info: <a href="https://www.cnblogs.com/liuxianan/p/build-blog-website-by-hexo-github.html#%E4%BD%BF%E7%94%A8hexo%E5%86%99%E5%8D%9A%E5%AE%A2" target="_blank" rel="noopener">Deployment</a></p>
<h2 id="ç›¸å…³æŒ‡ä»¤"><a href="#ç›¸å…³æŒ‡ä»¤" class="headerlink" title="ç›¸å…³æŒ‡ä»¤"></a>ç›¸å…³æŒ‡ä»¤</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">npm install -g hexo</span><br><span class="line">hexo init</span><br><span class="line">hexo g</span><br><span class="line">hexo s</span><br><span class="line">hexo d</span><br><span class="line">npm install hexo-deployer-git --save</span><br><span class="line">hexo d</span><br><span class="line">npm install hexo --save</span><br><span class="line">hexo new &apos;kotlinä½¿ç”¨ç¬”è®°&apos;</span><br><span class="line">å‡ºç°å¼‚å¸¸ï¼šä½¿ç”¨ä¸‹é¢å‘½ä»¤ï¼Œå®‰è£…æ‰€æœ‰æ’ä»¶ã€‚</span><br><span class="line">npm ls --depth 0</span><br></pre></td></tr></table></figure>

<h2 id="æ ‡ç­¾æŠ¬å¤´"><a href="#æ ‡ç­¾æŠ¬å¤´" class="headerlink" title="æ ‡ç­¾æŠ¬å¤´"></a>æ ‡ç­¾æŠ¬å¤´</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: æ ‡ç­¾</span><br><span class="line">date: 2019-07-02 20:25:40</span><br><span class="line">type: tags</span><br><span class="line">layout: tags</span><br><span class="line">reward: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="åˆ†ç±»æŠ¬å¤´"><a href="#åˆ†ç±»æŠ¬å¤´" class="headerlink" title="åˆ†ç±»æŠ¬å¤´"></a>åˆ†ç±»æŠ¬å¤´</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">---</span><br><span class="line">title: åˆ†ç±»</span><br><span class="line">date: 2019-04-24 15:30:30</span><br><span class="line">type: categories</span><br><span class="line">layout: categories</span><br><span class="line">reward: false</span><br><span class="line">---</span><br></pre></td></tr></table></figure>

<h2 id="mellow"><a href="#mellow" class="headerlink" title="mellow"></a>mellow</h2><p><a href="https://github.com/codefine/hexo-theme-mellow/wiki" target="_blank" rel="noopener">mellow</a></p>
]]></content>
      
        <categories>
            
            <category> Hexo </category>
            
        </categories>
        
        
        <tags>
            
            <tag> Hexo </tag>
            
        </tags>
        
    </entry>
    
  
  
</search>
